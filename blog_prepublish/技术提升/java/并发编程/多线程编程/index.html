<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>å¤šçº¿ç¨‹ç¼–ç¨‹ | luolin1024</title><meta name=keywords content="Java/JavaåŸºç¡€"><meta name=description content="æ¦‚å¿µæ¢³ç† å¹¶è¡Œ å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´åœ¨CPUä¸Šè¿è¡Œã€‚ å¹¶å‘è¡¨ç¤ºä¸€ä¼šåšè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¼šåšå¦ä¸€ä¸ªäº‹æƒ…ï¼Œå­˜åœ¨ç€è°ƒåº¦ã€‚å•æ ¸ CPU ä¸å¯èƒ½å­˜åœ¨å¹¶è¡Œï¼ˆå¾®è§‚ä¸Šï¼‰ã€‚ ä¸´ç•ŒåŒºä¸´"><meta name=author content="luolin"><link rel=canonical href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B/><script defer src=https://blogcounter.luolin.us.kg/script.js data-website-id=c8850e2c-16aa-465e-aa6f-5392c9397317></script>
<script src=/js/umami-stats.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script>
<link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://luolin1024.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://luolin1024.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://luolin1024.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://luolin1024.github.io/apple-touch-icon.png><link rel=mask-icon href=https://luolin1024.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><html><head><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css><style>body{font-family:lxgw wenkai lite,sans-serif;font-family:lxgw wenkai screen,sans-serif}</style></head></html><meta property="og:title" content="å¤šçº¿ç¨‹ç¼–ç¨‹"><meta property="og:description" content="æ¦‚å¿µæ¢³ç† å¹¶è¡Œ å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´åœ¨CPUä¸Šè¿è¡Œã€‚ å¹¶å‘è¡¨ç¤ºä¸€ä¼šåšè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¼šåšå¦ä¸€ä¸ªäº‹æƒ…ï¼Œå­˜åœ¨ç€è°ƒåº¦ã€‚å•æ ¸ CPU ä¸å¯èƒ½å­˜åœ¨å¹¶è¡Œï¼ˆå¾®è§‚ä¸Šï¼‰ã€‚ ä¸´ç•ŒåŒºä¸´"><meta property="og:type" content="article"><meta property="og:url" content="https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B/"><meta property="article:section" content="blog_prepublish"><meta property="article:published_time" content="2023-02-11T00:32:19+08:00"><meta property="article:modified_time" content="2024-03-21T00:59:24+08:00"><meta property="og:site_name" content="luolinçš„åšå®¢"><meta name=twitter:card content="summary"><meta name=twitter:title content="å¤šçº¿ç¨‹ç¼–ç¨‹"><meta name=twitter:description content="æ¦‚å¿µæ¢³ç† å¹¶è¡Œ å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´åœ¨CPUä¸Šè¿è¡Œã€‚ å¹¶å‘è¡¨ç¤ºä¸€ä¼šåšè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¼šåšå¦ä¸€ä¸ªäº‹æƒ…ï¼Œå­˜åœ¨ç€è°ƒåº¦ã€‚å•æ ¸ CPU ä¸å¯èƒ½å­˜åœ¨å¹¶è¡Œï¼ˆå¾®è§‚ä¸Šï¼‰ã€‚ ä¸´ç•ŒåŒºä¸´"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog_prepublishes","item":"https://luolin1024.github.io/blog_prepublish/"},{"@type":"ListItem","position":2,"name":"å¤šçº¿ç¨‹ç¼–ç¨‹","item":"https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"å¤šçº¿ç¨‹ç¼–ç¨‹","name":"å¤šçº¿ç¨‹ç¼–ç¨‹","description":"æ¦‚å¿µæ¢³ç† å¹¶è¡Œ å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´åœ¨CPUä¸Šè¿è¡Œã€‚ å¹¶å‘è¡¨ç¤ºä¸€ä¼šåšè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¼šåšå¦ä¸€ä¸ªäº‹æƒ…ï¼Œå­˜åœ¨ç€è°ƒåº¦ã€‚å•æ ¸ CPU ä¸å¯èƒ½å­˜åœ¨å¹¶è¡Œï¼ˆå¾®è§‚ä¸Šï¼‰ã€‚ ä¸´ç•ŒåŒºä¸´","keywords":["Java/JavaåŸºç¡€"],"articleBody":"æ¦‚å¿µæ¢³ç† å¹¶è¡Œ\nå¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´åœ¨CPUä¸Šè¿è¡Œã€‚\nå¹¶å‘è¡¨ç¤ºä¸€ä¼šåšè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¼šåšå¦ä¸€ä¸ªäº‹æƒ…ï¼Œå­˜åœ¨ç€è°ƒåº¦ã€‚å•æ ¸ CPU ä¸å¯èƒ½å­˜åœ¨å¹¶è¡Œï¼ˆå¾®è§‚ä¸Šï¼‰ã€‚\nä¸´ç•ŒåŒºä¸´ç•ŒåŒºç”¨æ¥è¡¨ç¤ºä¸€ç§å…¬å…±èµ„æºæˆ–è€…è¯´æ˜¯å…±äº«æ•°æ®ï¼Œå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚ä½†æ˜¯æ¯ä¸€æ¬¡ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å®ƒï¼Œä¸€æ—¦ä¸´ç•ŒåŒºèµ„æºè¢«å ç”¨ï¼Œå…¶ä»–çº¿ç¨‹è¦æƒ³ä½¿ç”¨è¿™ä¸ªèµ„æºï¼Œå°±å¿…é¡»ç­‰å¾…ã€‚\né˜»å¡ä¸éé˜»å¡\né˜»å¡å’Œéé˜»å¡é€šå¸¸ç”¨æ¥å½¢å®¹å¤šçº¿ç¨‹é—´çš„ç›¸äº’å½±å“ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹å ç”¨äº†ä¸´ç•ŒåŒºèµ„æºï¼Œé‚£ä¹ˆå…¶å®ƒæ‰€æœ‰éœ€è¦è¿™ä¸ªèµ„æºçš„çº¿ç¨‹å°±å¿…é¡»åœ¨è¿™ä¸ªä¸´ç•ŒåŒºä¸­è¿›è¡Œç­‰å¾…ï¼Œç­‰å¾…ä¼šå¯¼è‡´çº¿ç¨‹æŒ‚èµ·ã€‚è¿™ç§æƒ…å†µå°±æ˜¯é˜»å¡ã€‚\næ­¤æ—¶ï¼Œå¦‚æœå ç”¨èµ„æºçš„çº¿ç¨‹ä¸€ç›´ä¸æ„¿æ„é‡Šæ”¾èµ„æºï¼Œé‚£ä¹ˆå…¶å®ƒæ‰€æœ‰é˜»å¡åœ¨è¿™ä¸ªä¸´ç•ŒåŒºä¸Šçš„çº¿ç¨‹éƒ½ä¸èƒ½å·¥ä½œã€‚é˜»å¡æ˜¯æŒ‡çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢è¢«æŒ‚èµ·ã€‚é˜»å¡ä¸€èˆ¬æ€§èƒ½ä¸å¥½ï¼Œéœ€å¤§çº¦8ä¸‡ä¸ªæ—¶é’Ÿå‘¨æœŸæ¥åšè°ƒåº¦ã€‚\néé˜»å¡åˆ™å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒºã€‚\næ­»é”æ­»é”æ˜¯è¿›ç¨‹æ­»é”çš„ç®€ç§°ï¼Œæ˜¯æŒ‡å¤šä¸ªè¿›ç¨‹å¾ªç¯ç­‰å¾…ä»–æ–¹å æœ‰çš„èµ„æºè€Œæ— é™çš„åƒµæŒä¸‹å»çš„å±€é¢ã€‚\næ´»é”\nå‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹1ã€2ï¼Œå®ƒä»¬éƒ½éœ€è¦èµ„æº A/Bï¼Œå‡è®¾1å·çº¿ç¨‹å æœ‰äº† A èµ„æºï¼Œ2å·çº¿ç¨‹å æœ‰äº† B èµ„æºï¼›ç”±äºä¸¤ä¸ªçº¿ç¨‹éƒ½éœ€è¦åŒæ—¶æ‹¥æœ‰è¿™ä¸¤ä¸ªèµ„æºæ‰å¯ä»¥å·¥ä½œï¼Œä¸ºäº†é¿å…æ­»é”ï¼Œ1å·çº¿ç¨‹é‡Šæ”¾äº† A èµ„æºå æœ‰é”ï¼Œ2å·çº¿ç¨‹é‡Šæ”¾äº† B èµ„æºå æœ‰é”ï¼›æ­¤æ—¶ AB ç©ºé—²ï¼Œä¸¤ä¸ªçº¿ç¨‹åˆåŒæ—¶æŠ¢é”ï¼Œå†æ¬¡å‡ºç°ä¸Šè¿°æƒ…å†µï¼Œæ­¤æ—¶å‘ç”Ÿäº†æ´»é”ã€‚\né¥¥é¥¿é¥¥é¥¿æ˜¯æŒ‡æŸä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œã€‚\nç”Ÿå‘½å‘¨æœŸ åˆ›å»ºçŠ¶æ€å½“ç”¨ new æ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹å¯¹è±¡æ—¶ï¼Œè¯¥çº¿ç¨‹å¤„äºåˆ›å»ºçŠ¶æ€ã€‚å¤„äºåˆ›å»ºçŠ¶æ€çš„çº¿ç¨‹åªæ˜¯ä¸€ä¸ªç©ºçš„çº¿ç¨‹å¯¹è±¡ï¼Œç³»ç»Ÿä¸ä¸ºå®ƒåˆ†é…èµ„æºã€‚\nå°±ç»ªçŠ¶æ€æ‰§è¡Œçº¿ç¨‹çš„ start() æ–¹æ³•ä½¿çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ã€‚\nè¿è¡ŒçŠ¶æ€è°ƒåº¦ä¸ºçº¿ç¨‹åˆ†é…å¿…é¡»çš„ç³»ç»Ÿèµ„æºï¼Œå®‰æ’å…¶è¿è¡Œï¼Œå¹¶è°ƒç”¨çº¿ç¨‹ä½“â€”â€”run()æ–¹æ³•ï¼Œè¿™æ ·å°±ä½¿å¾—è¯¥çº¿ç¨‹å¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼ˆRunnableï¼‰ã€‚\nä¼‘çœ çŠ¶æ€\nè°ƒç”¨äº† sleep() æ–¹æ³•ï¼› é˜»å¡çŠ¶æ€å½“å‘ç”Ÿä¸‹åˆ—äº‹ä»¶æ—¶ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ä¼šè½¬å…¥åˆ°é˜»å¡çŠ¶æ€ï¼š\nå½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è·å–ä¸€ä¸ªå†…éƒ¨çš„å¯¹è±¡é”ï¼ˆéjava.util.concurrentåº“ä¸­çš„é”ï¼‰ï¼Œè€Œè¯¥é”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹é€šçŸ¥è°ƒåº¦å™¨ä¸€ä¸ªæ¡ä»¶æ—¶ï¼Œè¯¥çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚ä¾‹å¦‚è°ƒç”¨ï¼šObject.wait()ã€Thread.join()ä»¥åŠç­‰å¾…Lockæˆ–Conditionã€‚ çº¿ç¨‹è¾“å…¥/è¾“å‡ºé˜»å¡ï¼› çº¿ç¨‹è°ƒç”¨ wait() æ–¹æ³•ç­‰å¾…ç‰¹å®šæ¡ä»¶çš„æ»¡è¶³ï¼› å¦‚æœçº¿ç¨‹åœ¨ç­‰å¾…æŸä¸€æ¡ä»¶ï¼Œå¦ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šè¿‡ notify() æˆ– notifyAll() æ–¹æ³•é€šçŸ¥ç­‰å¾…çº¿ç¨‹æ¡ä»¶çš„æ”¹å˜ï¼› å¦‚æœçº¿ç¨‹æ˜¯å› ä¸ºè¾“å…¥è¾“å‡ºé˜»å¡ï¼Œéœ€è¦ç­‰å¾…è¾“å…¥è¾“å‡ºå®Œæˆã€‚ çº¿ç¨‹çš„åˆ›å»º javaåœ¨jdk5ä¹‹å‰åªæä¾›ç»§æ‰¿Threadå’Œå®ç°Runnableæ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹ï¼Œåœ¨jdk5ä¹‹ååˆ™æ–°å¢äº†ä¸¤ä¸ªæ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹ã€‚\nç»§æ‰¿Threadæ–¹å¼ /** * é€šè¿‡ç»§æ‰¿äºThreadç±» * é‡å†™run()æ–¹æ³•ï¼Œä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚ */ class Thread1 extends Thread{ public long times; public Thread1(long times){ this.times = times; } @Override public void run(){ while (times \u003e= 0) { System.out.println(Thread.currentThread().getName()+\"** *** times:\"+times--); } } } // mainä¸­è°ƒç”¨ï¼š public static void main(String[] args) { Thread1 thread1 = new Thread1(5); thread1.start(); // ä¸èƒ½ç›´æ¥é€šè¿‡è°ƒç”¨run()çš„æ–¹å¼ç›´æ¥å¯åŠ¨çº¿ç¨‹,æ­¤æ—¶ä»å¤„äºä¸»çº¿ç¨‹(main)ä¸­ã€‚ // thread1.run(); // å¤šæ¬¡é€šè¿‡start()å¯åŠ¨çº¿ç¨‹ä¼šæŠ¥IllegalThreadStateException // thread1.start(); int times = 5; while (times \u003e= 0) { System.out.println(Thread.currentThread().getName()+\"** *** times:\"+times--); } } æ‰“å°ç»“æœï¼š\nmain** *** times:5 Thread-0** *** times:5 Thread-0** *** times:4 Thread-0** *** times:3 main** *** times:4 Thread-0** *** times:2 main** *** times:3 main** *** times:2 main** *** times:1 main** *** times:0 Thread-0** *** times:1 Thread-0** *** times:0 å®ç°Runnableæ¥å£æ–¹å¼ /** * å®ç°Runnableæ¥å£æ–¹å¼ï¼Œ * é‡å†™run()æ–¹æ³•ï¼Œä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚ * è°ƒç”¨çš„æ—¶å€™éœ€è¦new Thread(ä¼ å…¥å®ç°äº†Runnableæ¥å£çš„å®ä½“ç±»å¯¹è±¡)ï¼Œæ¯”å¦‚ï¼šnew Thread(p).start(); */ class Thread3 implements Runnable{ public long times; public Thread3(long times){ this.times = times; } @Override public void run() { while (times \u003e= 0) { System.out.println(Thread.currentThread().getName()+\"** *** times:\"+times--); } } } // mainä¸­è°ƒç”¨ï¼š public static void main(String[] args) { Thread3 thread3 = new Thread3(5); new Thread(thread3).start(); int times = 5; while (times \u003e= 0) { System.out.println(Thread.currentThread().getName()+\"** *** times:\"+times--); } } æ‰“å°ç»“æœï¼š\nmain** *** times:5 Thread-0** *** times:5 main** *** times:4 Thread-0** *** times:4 main** *** times:3 main** *** times:2 main** *** times:1 main** *** times:0 Thread-0** *** times:3 Thread-0** *** times:2 Thread-0** *** times:1 Thread-0** *** times:0 å®ç°Callableæ¥å£æ–¹å¼ Callableæ¥å£æºç ï¼š\n/** * A task that returns a result and may throw an exception. * Implementors define a single method with no arguments called * {@code call}. * * The {@code Callable} interface is similar to {@link * java.lang.Runnable}, in that both are designed for classes whose * instances are potentially executed by another thread. A * {@code Runnable}, however, does not return a result and cannot * throw a checked exception. * * The {@link Executors} class contains utility methods to * convert from other common forms to {@code Callable} classes. * * @see Executor * @since 1.5 * @author Doug Lea * @param the result type of method {@code call} */ @FunctionalInterface public interface Callable\u003cV\u003e { /** * Computes a result, or throws an exception if unable to do so. * * @return computed result * @throws Exception if unable to compute a result */ V call() throws Exception; } /** * å®ç°Callableæ¥å£æ–¹å¼ï¼Œ * é‡å†™call()æ–¹æ³•ï¼Œå°†çº¿ç¨‹ä¸­éœ€è¦æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚ */ // 1.åˆ›å»ºä¸€ä¸ªå®ç°Callableçš„ç±» class Thread4 implements Callable\u003cInteger\u003e{ // 2.å®ç°call()ï¼Œå°†çº¿ç¨‹ä¸­éœ€è¦æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚ @Override public Integer call() throws Exception { int sum = 0; for(int i = 0; i \u003c= 5; i++) { if(i % 2 == 0){ System.out.println(Thread.currentThread().getName()+\"** *** i:\"+i); sum+=i; } } return sum; } } // mainä¸­è°ƒç”¨ï¼š public static void main(String[] args) { // 3.åˆ›å»ºCallableæ¥å£å®ç°ç±»çš„å¯¹è±¡ Thread4 thread4 = new Thread4(); // 4.å°†æ­¤Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°FutureTaskæ„é€ å™¨ä¸­ï¼Œåˆ›å»ºFutureTaskçš„å¯¹è±¡ FutureTask futureTask = new FutureTask(thread4); // 5.å°†FutureTaskçš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadå¯¹è±¡å¹¶è°ƒç”¨start() new Thread(futureTask).start(); int times = 5; while (times \u003e= 0) { System.out.println(Thread.currentThread().getName()+\"** *** times:\"+times--); } try { // 6.è·å–Callableä¸­callæ–¹æ³•çš„è¿”å›å€¼ // get()è¿”å›å€¼å³ä¸ºFutureTaskæ„é€ å™¨å‚æ•°Callableå®ç°ç±»é‡å†™çš„call()çš„è¿”å›å€¼ã€‚ Object o = futureTask.get(); System.out.println(o); } catch (InterruptedException e) { e.printStackTrace(); } catch (ExecutionException e) { e.printStackTrace(); } } æ‰“å°ç»“æœï¼š\nmain** *** times:5 Thread-0** *** i:0 main** *** times:4 main** *** times:3 main** *** times:2 main** *** times:1 main** *** times:0 Thread-0** *** i:2 Thread-0** *** i:4 6 ä½¿ç”¨çº¿ç¨‹æ±  mainä¸­è°ƒç”¨ï¼ŒThread3å’ŒThread4åŒä¸Š\npublic static void main(String[] args) { ExecutorService executorService = Executors.newFixedThreadPool(10); // åªé€‚åˆRunnableæ–¹å¼, executorService.execute(new Thread3(5)); // é€‚åˆCallableæ–¹å¼å’ŒRunnableæ–¹å¼,è¿”å›Futureå¯¹è±¡ Future\u003cInteger\u003e submit = executorService.submit(new Thread4()); try { System.out.println(submit.get()); } catch (InterruptedException e) { e.printStackTrace(); } catch (ExecutionException e) { e.printStackTrace(); }finally { executorService.shutdown(); } } æ‰“å°ç»“æœï¼š\npool-1-thread-1** *** times:5 pool-1-thread-1** *** times:4 pool-1-thread-1** *** times:3 pool-1-thread-1** *** times:2 pool-1-thread-1** *** times:1 pool-1-thread-1** *** times:0 pool-1-thread-2** *** i:0 pool-1-thread-2** *** i:2 pool-1-thread-2** *** i:4 6 å››ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒ é€šè¿‡ç»§æ‰¿Threadå’Œå®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œåªè¦æ³¨æ„å°†éœ€è¦è¿›è¡Œé€»è¾‘å¤„ç†çš„ä»£ç æ–¹æ³•é‡å†™çš„run()å°±å¥½ã€‚é€šè¿‡å®ç°Callableæ¥å£å’Œä½¿ç”¨çº¿ç¨‹æ± æ¥åˆ›å»ºçº¿ç¨‹æ˜¯jdk5ä¹‹åçš„æ–°æ–¹å¼ã€‚\nå®ç°Callableæ¥å£\nä¸ä½¿ç”¨Runnableç›¸æ¯”ï¼ŒCallableåŠŸèƒ½æ›´å¼ºå¤§äº›\nå¯ä»¥æœ‰è¿”å›å€¼ï¼ŒFutureTaskçš„å¯¹è±¡çš„get()å¯ä»¥è·å–é‡å†™çš„call()çš„è¿”å›å€¼ æ–¹æ³•å¯ä»¥æŠ›å‡ºå¼‚å¸¸ æ”¯æŒæ³›å‹çš„è¿”å›å€¼ éœ€è¦å€ŸåŠ©FutureTaskç±»ï¼Œæ¯”å¦‚è·å–è¿”å›ç»“æœ ä½¿ç”¨çº¿ç¨‹æ± èƒŒæ™¯ï¼š ç»å¸¸åˆ›å»ºå’Œé”€æ¯ã€ä½¿ç”¨é‡ç‰¹åˆ«å¤§çš„èµ„æºï¼Œæ¯”å¦‚å¹¶å‘æƒ…å†µä¸‹çš„çº¿ç¨‹ï¼Œå¯¹æ€§èƒ½å½±å“å¾ˆå¤§æ€è·¯ï¼šæå‰åˆ›å»ºå¥½å¤šä¸ªçº¿ç¨‹ï¼Œæ”¾å…¥çº¿ç¨‹æ± ä¸­ï¼Œä½¿ç”¨æ—¶ç›´æ¥è·å–ï¼Œä½¿ç”¨å®Œæ”¾å›æ± ä¸­ã€‚å¯ä»¥é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯ï¼Œå®ç°é‡å¤åˆ©ç”¨ã€‚ç±»ä¼¼ç”Ÿæ´»ä¸­çš„å…¬å…±äº¤é€šå·¥å…·ã€‚å¥½å¤„ï¼š\næé«˜å“åº”é€Ÿåº¦ï¼ˆå‡å°‘äº†åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´ï¼‰ é™ä½èµ„æºæ¶ˆè€—ï¼ˆé‡å¤åˆ©ç”¨çº¿ç¨‹æ± ä¸­çº¿ç¨‹ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºï¼‰ ä¾¿äºçº¿ç¨‹ç®¡ç† Javaä¸­åˆ›å»ºçº¿ç¨‹æ± å¾ˆç®€å•ï¼Œåªéœ€è¦è°ƒç”¨Executorsä¸­ç›¸åº”çš„ä¾¿æ·æ–¹æ³•å³å¯ï¼Œæ¯”å¦‚Executors.newFixedThreadPool(int nThreads)ï¼Œä½†æ˜¯ä¾¿æ·ä¸ä»…éšè—äº†å¤æ‚æ€§ï¼Œä¹Ÿä¸ºæˆ‘ä»¬åŸ‹ä¸‹äº†æ½œåœ¨çš„éšæ‚£ï¼ˆOOMï¼Œçº¿ç¨‹è€—å°½ï¼‰ã€‚\n// Javaçº¿ç¨‹æ± çš„å®Œæ•´æ„é€ å‡½æ•° public ThreadPoolExecutor( int corePoolSize, // çº¿ç¨‹æ± é•¿æœŸç»´æŒçš„çº¿ç¨‹æ•°ï¼Œå³ä½¿çº¿ç¨‹å¤„äºIdleçŠ¶æ€ï¼Œä¹Ÿä¸ä¼šå›æ”¶ã€‚ int maximumPoolSize, // çº¿ç¨‹æ•°çš„ä¸Šé™ long keepAliveTime, TimeUnit unit, // è¶…è¿‡corePoolSizeçš„çº¿ç¨‹çš„idleæ—¶é•¿ï¼Œ // è¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œå¤šä½™çš„çº¿ç¨‹ä¼šè¢«å›æ”¶ã€‚ BlockingQueue\u003cRunnable\u003e workQueue, // ä»»åŠ¡çš„æ’é˜Ÿé˜Ÿåˆ— ThreadFactory threadFactory, // æ–°çº¿ç¨‹çš„äº§ç”Ÿæ–¹å¼ RejectedExecutionHandler handler) // æ‹’ç»ç­–ç•¥ è¯¦ç»†å¯ä»¥æŸ¥çœ‹ThreadPoolExecutorç±»æºç ã€‚ä¹Ÿå¯ä»¥å‚è€ƒhttps://www.cnblogs.com/CarpenterLee/p/9558026.html\nçº¿ç¨‹å®‰å…¨é—®é¢˜ å‡è®¾æœ‰3ä¸ªçª—å£åœ¨åŒæ—¶å–50å¼ ç«è½¦ç¥¨ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç æ¥å®ç°ï¼š\nclass Window extends Thread{ private static int tickets = 50; // ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡ public static int sum = 0; @Override public void run() { while (tickets \u003e 0){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName()+\":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\"+tickets--); sum++; } } } public static void main(String[] args) { Window window1 = new Window(); Window window2 = new Window(); Window window3 = new Window(); window1.setName(\"çª—å£1\"); window2.setName(\"çª—å£2\"); window3.setName(\"çª—å£3\"); window1.start(); window2.start(); window3.start(); try { sleep(10000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Window.sum); } æœ€åå‡ æ¡æ‰“å°ç»“æœï¼š\nçª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š3 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š0 72 ç»“æœå‘ç°3ä¸ªçª—å£æ€»å…±å–äº†72æ¬¡ï¼Œè€Œä¸”å…¶ä¸­æœ‰å¤šå¼ ç¥¨å·æœ‰é—®é¢˜ï¼ˆé‡ç¥¨å’Œè´Ÿæ•°ã€0å·ç¥¨ï¼‰çš„ç¥¨ï¼ŒåŸå› æ˜¯å¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶æ‰§è¡Œä¸‹é¢ä»£ç ï¼š\nSystem.out.println(Thread.currentThread().getName()+\":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\"+tickets--); è€Œä¸”è¿™äº›çº¿ç¨‹æŒæœ‰çš„ticketsç›¸åŒï¼Œæ‰€æœ‰å°±ä¼šå‡ºç°é‡ç¥¨ï¼Œè¿™å°±æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚\nåŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜ class Window extends Thread { private static int tickets = 50; // ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡ public static int sum = 0; @Override public void run() { while (true) { synchronized (Window.class) { if(tickets \u003e 0){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + \":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\" + tickets--); sum++; }else { break; } } } } } public static void main(String[] args) { Window window1 = new Window(); Window window2 = new Window(); Window window3 = new Window(); window1.setName(\"çª—å£1\"); window2.setName(\"çª—å£2\"); window3.setName(\"çª—å£3\"); window1.start(); window2.start(); window3.start(); try { sleep(10000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Window.sum); } æ‰“å°ç»“æœï¼š\nçª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š50 çª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š49 ... çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š4 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š3 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 50 è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜ class Window2 implements Runnable { private int tickets = 50; public static int sum = 0; @Override public void run() { while (true) { synchronized (this) { if (tickets \u003e 0) { try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + \":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\" + tickets--); sum++; } else { break; } } } } } public static void main(String[] args) { Window2 window = new Window2(); Thread window1 = new Thread(window); Thread window2 = new Thread(window); Thread window3 = new Thread(window); window1.setName(\"çª—å£1\"); window2.setName(\"çª—å£2\"); window3.setName(\"çª—å£3\"); window1.start(); window2.start(); window3.start(); try { sleep(6000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Window2.sum); } æ‰“å°ç»“æœï¼š\nçª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š50 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š49 ... çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š3 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 50 åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜ class Window extends Thread { private static int tickets = 50; // ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡ public static int sum = 0; @Override public void run() { while (true) { if(!compute()){ break; } } } private static synchronized boolean compute(){ if(tickets \u003e 0){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + \":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\" + tickets--); sum++; return true; } return false; } } æ‰“å°ç»“æœï¼š\nçª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š50 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š49 ... çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š3 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 50 è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜ class Window2 implements Runnable { private int tickets = 50; public static int sum = 0; @Override public void run() { while (true) { if(!compute()){ break; } } } private synchronized boolean compute(){ if(tickets \u003e 0){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + \":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\" + tickets--); sum++; return true; } return false; } } æ‰“å°ç»“æœï¼š\nçª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š50 çª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š49 ... çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š3 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 50 Lockè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ jdk5ä¹‹åï¼Œ\nè§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜ class Window2 implements Runnable { private int tickets = 50; public static int sum = 0; private ReentrantLock lock = new ReentrantLock(true); @Override public void run() { while (true) { try { lock.lock(); if(tickets \u003e 0){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + \":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\" + tickets--); sum++; }else { break; } }finally { lock.unlock(); } } } } æ‰“å°ç»“æœï¼š\nçª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š50 çª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š49 çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š48 ... çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 50 è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜ class Window extends Thread { private static int tickets = 50; // ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡ public static int sum = 0; private static ReentrantLock lock = new ReentrantLock(true); @Override public void run() { while (true) { try{ lock.lock(); if(tickets \u003e 0){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + \":å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š\" + tickets--); sum++; } else { break; } }finally { lock.unlock(); } } } } æ‰“å°ç»“æœï¼š\nçª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š50 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š49 ... çª—å£3:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š3 çª—å£1:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š2 çª—å£2:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š1 50 çº¿ç¨‹é€šä¿¡ ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼æ˜¯ä¸€ä¸ªååˆ†ç»å…¸çš„å¤šçº¿ç¨‹å¹¶å‘åä½œçš„æ¨¡å¼ï¼Œæ‰€è°“ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼Œå®é™…ä¸Šä¸»è¦æ˜¯åŒ…å«äº†ä¸¤ç±»çº¿ç¨‹ï¼Œä¸€ç§æ˜¯ç”Ÿäº§è€…çº¿ç¨‹ç”¨äºç”Ÿäº§æ•°æ®ï¼Œå¦ä¸€ç§æ˜¯æ¶ˆè´¹è€…çº¿ç¨‹ç”¨äºæ¶ˆè´¹æ•°æ®ï¼Œä¸ºäº†è§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å…³ç³»ï¼Œé€šå¸¸ä¼šé‡‡ç”¨å…±äº«çš„æ•°æ®åŒºåŸŸï¼Œå°±åƒæ˜¯ä¸€ä¸ªä»“åº“ï¼Œç”Ÿäº§è€…ç”Ÿäº§æ•°æ®ä¹‹åç›´æ¥æ”¾ç½®åœ¨å…±äº«æ•°æ®åŒºä¸­ï¼Œå¹¶ä¸éœ€è¦å…³å¿ƒæ¶ˆè´¹è€…çš„è¡Œä¸ºï¼›è€Œæ¶ˆè´¹è€…åªéœ€è¦ä»å…±äº«æ•°æ®åŒºä¸­å»è·å–æ•°æ®ï¼Œå°±ä¸å†éœ€è¦å…³å¿ƒç”Ÿäº§è€…çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªå…±äº«æ•°æ®åŒºåŸŸä¸­åº”è¯¥å…·å¤‡è¿™æ ·çš„çº¿ç¨‹é—´å¹¶å‘åä½œçš„åŠŸèƒ½ï¼š\nå¦‚æœå…±äº«æ•°æ®åŒºå·²æ»¡çš„è¯ï¼Œé˜»å¡ç”Ÿäº§è€…ç»§ç»­ç”Ÿäº§æ•°æ®æ”¾ç½®å…¥å†…ï¼› å¦‚æœå…±äº«æ•°æ®åŒºä¸ºç©ºçš„è¯ï¼Œé˜»å¡æ¶ˆè´¹è€…ç»§ç»­æ¶ˆè´¹æ•°æ®ï¼› å®ç°æ¡ˆä¾‹ï¼š\nclass Clerk{ private int sum = 0; public synchronized void pruduce(){ if(sum \u003c 20){ sum++; System.out.println(Thread.currentThread().getName()+\"** ****ç”Ÿäº§ç¬¬\"+sum+\"ä¸ªæ•°æ®\"); notify(); }else { try { wait(); } catch (InterruptedException e) { e.printStackTrace(); } } } public synchronized void comsumer(){ if(sum \u003e 0){ System.out.println(Thread.currentThread().getName()+\"** ****æ¶ˆè´¹ç¬¬\"+sum+\"ä¸ªæ•°æ®\"); sum--; notify(); }else { try { wait(); } catch (InterruptedException e) { e.printStackTrace(); } } } } class Productor implements Runnable{ Clerk clerk; public Productor(Clerk clerk){ this.clerk = clerk; } @Override public void run() { while (true){ try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } clerk.pruduce(); } } } class Comsumer implements Runnable{ Clerk clerk; public Comsumer(Clerk clerk){ this.clerk = clerk; } @Override public void run() { while (true){ try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } clerk.comsumer(); } } } public class ComsumerTest { public static void main(String[] args) { Clerk clerk = new Clerk(); Productor productor = new Productor(clerk); Comsumer comsumer = new Comsumer(clerk); Thread threadProductor = new Thread(productor); Thread threadComsumer = new Thread(comsumer); threadProductor.setName(\"Productor\"); threadComsumer.setName(\"Comsumer\"); threadProductor.start(); threadComsumer.start(); } } æ­»é”ä»¥åŠæ­»é”é¿å… æ­»é”çš„å®šä¹‰ æ‰€è°“æ­»é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹å› ç«äº‰èµ„æºè€Œé€ æˆçš„ä¸€ç§åƒµå±€ï¼ˆäº’ç›¸ç­‰å¾…ï¼‰ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œè¿™äº›è¿›ç¨‹éƒ½å°†æ— æ³•å‘å‰æ¨è¿›ã€‚ä¾‹å¦‚ï¼ŒæŸè®¡ç®—æœºç³»ç»Ÿä¸­åªæœ‰ä¸€å°æ‰“å°æœºå’Œä¸€å°è¾“å…¥ è®¾å¤‡ï¼Œè¿›ç¨‹P1æ­£å ç”¨è¾“å…¥è®¾å¤‡ï¼ŒåŒæ—¶åˆæå‡ºä½¿ç”¨æ‰“å°æœºçš„è¯·æ±‚ï¼Œä½†æ­¤æ—¶æ‰“å°æœºæ­£è¢«è¿›ç¨‹P2 æ‰€å ç”¨ï¼Œè€ŒP2åœ¨æœªé‡Šæ”¾æ‰“å°æœºä¹‹å‰ï¼Œåˆæå‡ºè¯·æ±‚ä½¿ç”¨æ­£è¢«P1å ç”¨ç€çš„è¾“å…¥è®¾å¤‡ã€‚è¿™æ ·ä¸¤ä¸ªè¿›ç¨‹ç›¸äº’æ— ä¼‘æ­¢åœ°ç­‰å¾…ä¸‹å»ï¼Œå‡æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶ä¸¤ä¸ªè¿›ç¨‹é™·å…¥æ­»é”çŠ¶æ€ã€‚\næ­»é”äº§ç”ŸåŸå›  ç³»ç»Ÿèµ„æºçš„ç«äº‰\né€šå¸¸ç³»ç»Ÿä¸­æ‹¥æœ‰çš„ä¸å¯å‰¥å¤ºèµ„æºï¼Œå…¶æ•°é‡ä¸è¶³ä»¥æ»¡è¶³å¤šä¸ªè¿›ç¨‹è¿è¡Œçš„éœ€è¦ï¼Œä½¿å¾—è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šå› äº‰å¤ºèµ„æºè€Œé™·å…¥åƒµå±€ï¼Œå¦‚ç£å¸¦æœºã€æ‰“å°æœºç­‰ã€‚åªæœ‰å¯¹ä¸å¯å‰¥å¤ºèµ„æºçš„ç«äº‰æ‰å¯èƒ½äº§ç”Ÿæ­»é”ï¼Œå¯¹å¯å‰¥å¤ºèµ„æºçš„ç«äº‰æ˜¯ä¸ä¼šå¼•èµ·æ­»é”çš„ã€‚\nè¿›ç¨‹æ¨è¿›é¡ºåºéæ³•\nè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¯·æ±‚å’Œé‡Šæ”¾èµ„æºçš„é¡ºåºä¸å½“ï¼Œä¹ŸåŒæ ·ä¼šå¯¼è‡´æ­»é”ã€‚ä¾‹å¦‚ï¼Œå¹¶å‘è¿›ç¨‹ P1ã€P2åˆ†åˆ«ä¿æŒäº†èµ„æºR1ã€R2ï¼Œè€Œè¿›ç¨‹P1ç”³è¯·èµ„æºR2ï¼Œè¿›ç¨‹P2ç”³è¯·èµ„æºR1æ—¶ï¼Œä¸¤è€…éƒ½ä¼šå› ä¸ºæ‰€éœ€èµ„æºè¢«å ç”¨è€Œé˜»å¡ã€‚\nJavaä¸­æ­»é”æœ€ç®€å•çš„æƒ…å†µæ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹T1æŒæœ‰é”L1å¹¶ä¸”ç”³è¯·è·å¾—é”L2ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹T2æŒæœ‰é”L2å¹¶ä¸”ç”³è¯·è·å¾—é”L1ï¼Œå› ä¸ºé»˜è®¤çš„é”ç”³è¯·æ“ä½œéƒ½æ˜¯é˜»å¡çš„ï¼Œæ‰€ä»¥çº¿ç¨‹T1å’ŒT2æ°¸è¿œè¢«é˜»å¡äº†ã€‚å¯¼è‡´äº†æ­»é”ã€‚è¿™æ˜¯æœ€å®¹æ˜“ç†è§£ä¹Ÿæ˜¯æœ€ç®€å•çš„æ­»é”çš„å½¢å¼ã€‚ä½†æ˜¯å®é™…ç¯å¢ƒä¸­çš„æ­»é”å¾€å¾€æ¯”è¿™ä¸ªå¤æ‚çš„å¤šã€‚å¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹å½¢æˆäº†ä¸€ä¸ªæ­»é”çš„ç¯è·¯ï¼Œæ¯”å¦‚ï¼šçº¿ç¨‹T1æŒæœ‰é”L1å¹¶ä¸”ç”³è¯·è·å¾—é”L2ï¼Œè€Œçº¿ç¨‹T2æŒæœ‰é”L2å¹¶ä¸”ç”³è¯·è·å¾—é”L3ï¼Œè€Œçº¿ç¨‹T3æŒæœ‰é”L3å¹¶ä¸”ç”³è¯·è·å¾—é”L1ï¼Œè¿™æ ·å¯¼è‡´äº†ä¸€ä¸ªé”ä¾èµ–çš„ç¯è·¯ï¼šT1ä¾èµ–T2çš„é”L2ï¼ŒT2ä¾èµ–T3çš„é”L3ï¼Œè€ŒT3ä¾èµ–T1çš„é”L1ã€‚ä»è€Œå¯¼è‡´äº†æ­»é”ã€‚\næ­»é”äº§ç”Ÿæ¡ä»¶ äº’æ–¥æ¡ä»¶è¿›ç¨‹è¦æ±‚å¯¹æ‰€åˆ†é…çš„èµ„æºï¼ˆå¦‚æ‰“å°æœºï¼‰è¿›è¡Œæ’ä»–æ€§æ§åˆ¶ï¼Œå³åœ¨ä¸€æ®µæ—¶é—´å†…æŸèµ„æºä»…ä¸ºä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰ã€‚æ­¤æ—¶è‹¥æœ‰å…¶ä»–è¿›ç¨‹è¯·æ±‚è¯¥èµ„æºï¼Œåˆ™è¯·æ±‚è¿›ç¨‹åªèƒ½ç­‰å¾…ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯ä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚ç‹¬æœ¨æ¡¥æ¯æ¬¡åªèƒ½é€šè¿‡ä¸€ä¸ªäººã€‚\nä¸å‰¥å¤ºæ¡ä»¶è¿›ç¨‹æ‰€è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œæ¯•ä¹‹å‰ï¼Œä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹å¼ºè¡Œå¤ºèµ°ï¼Œå³åªèƒ½ç”±è·å¾—è¯¥èµ„æºçš„è¿›ç¨‹è‡ªå·±æ¥é‡Šæ”¾ï¼ˆåªèƒ½æ˜¯ä¸»åŠ¨é‡Šæ”¾)ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚ä¹™ä¸é€€å‡ºæ¡¥é¢ï¼Œç”²ä¹Ÿä¸é€€å‡ºæ¡¥é¢ã€‚\nè¯·æ±‚å’Œä¿æŒæ¡ä»¶è¿›ç¨‹å·²ç»ä¿æŒäº†è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œä½†åˆæå‡ºäº†æ–°çš„èµ„æºè¯·æ±‚ï¼Œè€Œè¯¥èµ„æºå·²è¢«å…¶ä»–è¿›ç¨‹å æœ‰ï¼Œæ­¤æ—¶è¯·æ±‚è¿›ç¨‹è¢«é˜»å¡ï¼Œä½†å¯¹è‡ªå·±å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯è¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚ç”²ä¸èƒ½å¼ºåˆ¶ä¹™é€€å‡ºæ¡¥é¢ï¼Œä¹™ä¹Ÿä¸èƒ½å¼ºåˆ¶ç”²é€€å‡ºæ¡¥é¢ã€‚\nå¾ªç¯ç­‰å¾…æ¡ä»¶å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå­˜åœ¨ä¸€ç§è¿›ç¨‹èµ„æºçš„å¾ªç¯ç­‰å¾…é“¾ï¼Œé“¾ä¸­æ¯ä¸€ä¸ªè¿›ç¨‹å·²è·å¾—çš„èµ„æºåŒæ—¶è¢«é“¾ä¸­ä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰€è¯·æ±‚ã€‚å³å­˜åœ¨ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„è¿›ç¨‹é›†åˆ{Pl, P2, â€¦, pn}ï¼Œå…¶ä¸­Piç­‰ å¾…çš„èµ„æºè¢«P(i+1)å æœ‰ï¼ˆi=0, 1, â€¦, n-1)ï¼ŒPnç­‰å¾…çš„èµ„æºè¢«P0å æœ‰ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚å¦‚æœä¹™ä¸é€€å‡ºæ¡¥é¢ï¼Œç”²ä¸èƒ½é€šè¿‡ï¼Œç”²ä¸é€€å‡ºæ¡¥é¢ï¼Œä¹™ä¸èƒ½é€šè¿‡ã€‚\næ­»é”äº§ç”Ÿå®ä¾‹ class Dead implements Runnable{ StringBuffer s1 = new StringBuffer(); StringBuffer s2 = new StringBuffer(); @Override public void run() { synchronized(s1){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } s1.append(\"ab\"); synchronized(s2){ s2.append(\"cd\"); } } synchronized (s2){ try { sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } s2.append(\"ab\"); synchronized(s1){ s1.append(\"cd\"); } } System.out.println(s1+\"\\n\"+s2); } } public static void main(String[] args) { Dead dead = new Dead(); new Thread(dead).start(); new Thread(dead).start(); } å¦‚ä½•é¿å…æ­»é” åœ¨æœ‰äº›æƒ…å†µä¸‹æ­»é”æ˜¯å¯ä»¥é¿å…çš„ã€‚ä¸‹é¢ä»‹ç»ä¸‰ç§ç”¨äºé¿å…æ­»é”çš„æŠ€æœ¯ï¼š\nåŠ é”é¡ºåºï¼ˆçº¿ç¨‹æŒ‰ç…§ä¸€å®šçš„é¡ºåºåŠ é”ï¼‰ åŠ é”æ—¶é™ï¼ˆçº¿ç¨‹å°è¯•è·å–é”çš„æ—¶å€™åŠ ä¸Šä¸€å®šçš„æ—¶é™ï¼Œè¶…è¿‡æ—¶é™åˆ™æ”¾å¼ƒå¯¹è¯¥é”çš„è¯·æ±‚ï¼Œå¹¶é‡Šæ”¾è‡ªå·±å æœ‰çš„é”ï¼‰ æ­»é”æ£€æµ‹ 1ã€åŠ é”é¡ºåºå½“å¤šä¸ªçº¿ç¨‹éœ€è¦ç›¸åŒçš„ä¸€äº›é”ï¼Œä½†æ˜¯æŒ‰ç…§ä¸åŒçš„é¡ºåºåŠ é”ï¼Œæ­»é”å°±å¾ˆå®¹æ˜“å‘ç”Ÿã€‚å¦‚æœèƒ½ç¡®ä¿æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å¾—é”ï¼Œé‚£ä¹ˆæ­»é”å°±ä¸ä¼šå‘ç”Ÿã€‚ä¸Šé¢çš„é‚£ä¸ªä¾‹å­å°±æ˜¯åŠ é”é¡ºåºä¸å½“å¯¼è‡´çš„ã€‚é¿å…åµŒå¥—å°é”ï¼šè¿™æ˜¯æ­»é”æœ€ä¸»è¦çš„åŸå› çš„ï¼Œå¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ªèµ„æºäº†å°±è¦é¿å…å°é”å¦ä¸€ä¸ªèµ„æºã€‚å¦‚æœä½ è¿è¡Œæ—¶åªæœ‰ä¸€ä¸ªå¯¹è±¡å°é”ï¼Œé‚£æ˜¯å‡ ä¹ä¸å¯èƒ½å‡ºç°ä¸€ä¸ªæ­»é”å±€é¢çš„ã€‚\n2ã€åŠ é”æ—¶é™å¦å¤–ä¸€ä¸ªå¯ä»¥é¿å…æ­»é”çš„æ–¹æ³•æ˜¯åœ¨å°è¯•è·å–é”çš„æ—¶å€™åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€åœ¨å°è¯•è·å–é”çš„è¿‡ç¨‹ä¸­è‹¥è¶…è¿‡äº†è¿™ä¸ªæ—¶é™è¯¥çº¿ç¨‹åˆ™æ”¾å¼ƒå¯¹è¯¥é”è¯·æ±‚ã€‚è‹¥ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰åœ¨ç»™å®šçš„æ—¶é™å†…æˆåŠŸè·å¾—æ‰€æœ‰éœ€è¦çš„é”ï¼Œåˆ™ä¼šè¿›è¡Œå›é€€å¹¶é‡Šæ”¾æ‰€æœ‰å·²ç»è·å¾—çš„é”ï¼Œç„¶åç­‰å¾…ä¸€æ®µéšæœºçš„æ—¶é—´å†é‡è¯•ã€‚è¿™æ®µéšæœºçš„ç­‰å¾…æ—¶é—´è®©å…¶å®ƒçº¿ç¨‹æœ‰æœºä¼šå°è¯•è·å–ç›¸åŒçš„è¿™äº›é”ï¼Œå¹¶ä¸”è®©è¯¥åº”ç”¨åœ¨æ²¡æœ‰è·å¾—é”çš„æ—¶å€™å¯ä»¥ç»§ç»­è¿è¡Œ(åŠ é”è¶…æ—¶åå¯ä»¥å…ˆç»§ç»­è¿è¡Œå¹²ç‚¹å…¶å®ƒäº‹æƒ…ï¼Œå†å›å¤´æ¥é‡å¤ä¹‹å‰åŠ é”çš„é€»è¾‘)ã€‚\n3ã€æ­»é”æ£€æµ‹æ­»é”æ£€æµ‹æ˜¯ä¸€ä¸ªæ›´å¥½çš„æ­»é”é¢„é˜²æœºåˆ¶ï¼Œå®ƒä¸»è¦æ˜¯é’ˆå¯¹é‚£äº›ä¸å¯èƒ½å®ç°æŒ‰åºåŠ é”å¹¶ä¸”é”è¶…æ—¶ä¹Ÿä¸å¯è¡Œçš„åœºæ™¯ã€‚ä¸»è¦å¯ä»¥å‚è€ƒé“¶è¡Œå®¶ç®—æ³•çš„æ€æƒ³ã€‚\n","wordCount":"7398","inLanguage":"en","datePublished":"2023-02-11T00:32:19+08:00","dateModified":"2024-03-21T00:59:24+08:00","author":{"@type":"Person","name":"luolin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B/"},"publisher":{"@type":"Organization","name":"luolin1024","logo":{"@type":"ImageObject","url":"https://luolin1024.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://luolin1024.github.io accesskey=h title="luolinçš„åšå®¢ (Alt + H)">luolinçš„åšå®¢</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://luolin1024.github.io/posts title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://luolin1024.github.io/archives/ title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://luolin1024.github.io/search/ title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://luolin1024.github.io/tags title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://luolin1024.github.io/about title=ğŸ™‹ğŸ»â€â™‚ï¸å…³äº><span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span></a></li><li><a href=https://luolin1024.github.io/links title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://luolin1024.github.io>Home</a>&nbsp;Â»&nbsp;<a href=https://luolin1024.github.io/blog_prepublish/>Blog_prepublishes</a></div><h1 class="post-title entry-hint-parent">å¤šçº¿ç¨‹ç¼–ç¨‹</h1><div class=post-meta><span title='2023-02-11 00:32:19 +0800 +0800'>2023-02-11</span>&nbsp;Â·&nbsp;15 min&nbsp;Â·&nbsp;7398 words&nbsp;Â·&nbsp;luolin
æœ¬æ–‡æ€»é˜…è¯»é‡ <span id=umami_value_page_pv></span> æ¬¡
æœ¬æ–‡æ€»è®¿å®¢é‡ <span id=umami_value_page_uv></span> äºº</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e6%a6%82%e5%bf%b5%e6%a2%b3%e7%90%86 aria-label=æ¦‚å¿µæ¢³ç†>æ¦‚å¿µæ¢³ç†</a></li><li><a href=#%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f aria-label=ç”Ÿå‘½å‘¨æœŸ>ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href=#%e7%ba%bf%e7%a8%8b%e7%9a%84%e5%88%9b%e5%bb%ba aria-label=çº¿ç¨‹çš„åˆ›å»º>çº¿ç¨‹çš„åˆ›å»º</a><ul><li><a href=#%e7%bb%a7%e6%89%bfthread%e6%96%b9%e5%bc%8f aria-label=ç»§æ‰¿Threadæ–¹å¼>ç»§æ‰¿Threadæ–¹å¼</a></li><li><a href=#%e5%ae%9e%e7%8e%b0runnable%e6%8e%a5%e5%8f%a3%e6%96%b9%e5%bc%8f aria-label=å®ç°Runnableæ¥å£æ–¹å¼>å®ç°Runnableæ¥å£æ–¹å¼</a></li><li><a href=#%e5%ae%9e%e7%8e%b0callable%e6%8e%a5%e5%8f%a3%e6%96%b9%e5%bc%8f aria-label=å®ç°Callableæ¥å£æ–¹å¼>å®ç°Callableæ¥å£æ–¹å¼</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e7%ba%bf%e7%a8%8b%e6%b1%a0 aria-label=ä½¿ç”¨çº¿ç¨‹æ± >ä½¿ç”¨çº¿ç¨‹æ± </a></li><li><a href=#%e5%9b%9b%e7%a7%8d%e5%88%9b%e5%bb%ba%e6%96%b9%e5%bc%8f%e6%af%94%e8%be%83 aria-label=å››ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒ>å››ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒ</a></li></ul></li><li><a href=#%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 aria-label=çº¿ç¨‹å®‰å…¨é—®é¢˜>çº¿ç¨‹å®‰å…¨é—®é¢˜</a><ul><li><a href=#%e5%90%8c%e6%ad%a5%e4%bb%a3%e7%a0%81%e5%9d%97%e8%a7%a3%e5%86%b3%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 aria-label=åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</a><ul><li><a href=#%e8%a7%a3%e5%86%b3%e9%80%9a%e8%bf%87%e7%bb%a7%e6%89%bfthread%e7%b1%bb%e5%88%9b%e5%bb%ba%e7%9a%84%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%a8%8b%e5%ba%8f%e5%bc%95%e8%b5%b7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 aria-label=è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e9%80%9a%e8%bf%87%e5%ae%9e%e7%8e%b0runnable%e6%8e%a5%e5%8f%a3%e5%88%9b%e5%bb%ba%e7%9a%84%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%a8%8b%e5%ba%8f%e5%bc%95%e8%b5%b7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 aria-label=è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜</a></li></ul></li><li><a href=#%e5%90%8c%e6%ad%a5%e6%96%b9%e6%b3%95%e8%a7%a3%e5%86%b3%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 aria-label=åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</a><ul><li><a href=#%e8%a7%a3%e5%86%b3%e9%80%9a%e8%bf%87%e7%bb%a7%e6%89%bfthread%e7%b1%bb%e5%88%9b%e5%bb%ba%e7%9a%84%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%a8%8b%e5%ba%8f%e5%bc%95%e8%b5%b7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98-1 aria-label=è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e9%80%9a%e8%bf%87%e5%ae%9e%e7%8e%b0runnable%e6%8e%a5%e5%8f%a3%e5%88%9b%e5%bb%ba%e7%9a%84%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%a8%8b%e5%ba%8f%e5%bc%95%e8%b5%b7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98-1 aria-label=è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜</a></li></ul></li><li><a href=#lock%e8%a7%a3%e5%86%b3%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98 aria-label=Lockè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>Lockè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</a><ul><li><a href=#%e8%a7%a3%e5%86%b3%e9%80%9a%e8%bf%87%e7%bb%a7%e6%89%bfthread%e7%b1%bb%e5%88%9b%e5%bb%ba%e7%9a%84%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%a8%8b%e5%ba%8f%e5%bc%95%e8%b5%b7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98-2 aria-label=è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e9%80%9a%e8%bf%87%e5%ae%9e%e7%8e%b0runnable%e6%8e%a5%e5%8f%a3%e5%88%9b%e5%bb%ba%e7%9a%84%e5%a4%9a%e7%ba%bf%e7%a8%8b%e7%a8%8b%e5%ba%8f%e5%bc%95%e8%b5%b7%e7%9a%84%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98-2 aria-label=è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜</a></li></ul></li></ul></li><li><a href=#%e7%ba%bf%e7%a8%8b%e9%80%9a%e4%bf%a1 aria-label=çº¿ç¨‹é€šä¿¡>çº¿ç¨‹é€šä¿¡</a><ul><li><a href=#%e7%94%9f%e4%ba%a7%e8%80%85%e6%b6%88%e8%b4%b9%e8%80%85%e9%97%ae%e9%a2%98 aria-label=ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜>ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</a></li></ul></li><li><a href=#%e6%ad%bb%e9%94%81%e4%bb%a5%e5%8f%8a%e6%ad%bb%e9%94%81%e9%81%bf%e5%85%8d aria-label=æ­»é”ä»¥åŠæ­»é”é¿å…>æ­»é”ä»¥åŠæ­»é”é¿å…</a><ul><li><a href=#%e6%ad%bb%e9%94%81%e7%9a%84%e5%ae%9a%e4%b9%89 aria-label=æ­»é”çš„å®šä¹‰>æ­»é”çš„å®šä¹‰</a></li><li><a href=#%e6%ad%bb%e9%94%81%e4%ba%a7%e7%94%9f%e5%8e%9f%e5%9b%a0 aria-label=æ­»é”äº§ç”ŸåŸå› >æ­»é”äº§ç”ŸåŸå› </a></li><li><a href=#%e6%ad%bb%e9%94%81%e4%ba%a7%e7%94%9f%e6%9d%a1%e4%bb%b6 aria-label=æ­»é”äº§ç”Ÿæ¡ä»¶>æ­»é”äº§ç”Ÿæ¡ä»¶</a></li><li><a href=#%e6%ad%bb%e9%94%81%e4%ba%a7%e7%94%9f%e5%ae%9e%e4%be%8b aria-label=æ­»é”äº§ç”Ÿå®ä¾‹>æ­»é”äº§ç”Ÿå®ä¾‹</a></li><li><a href=#%e5%a6%82%e4%bd%95%e9%81%bf%e5%85%8d%e6%ad%bb%e9%94%81 aria-label=å¦‚ä½•é¿å…æ­»é”>å¦‚ä½•é¿å…æ­»é”</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=æ¦‚å¿µæ¢³ç†>æ¦‚å¿µæ¢³ç†<a hidden class=anchor aria-hidden=true href=#æ¦‚å¿µæ¢³ç†>#</a></h2><p><strong>å¹¶è¡Œ</strong></p><p>å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶é—´åœ¨CPUä¸Šè¿è¡Œã€‚</p><p><strong>å¹¶å‘</strong>è¡¨ç¤ºä¸€ä¼šåšè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¼šåšå¦ä¸€ä¸ªäº‹æƒ…ï¼Œå­˜åœ¨ç€è°ƒåº¦ã€‚å•æ ¸ CPU ä¸å¯èƒ½å­˜åœ¨å¹¶è¡Œï¼ˆå¾®è§‚ä¸Šï¼‰ã€‚</p><p><strong>ä¸´ç•ŒåŒº</strong>ä¸´ç•ŒåŒºç”¨æ¥è¡¨ç¤ºä¸€ç§å…¬å…±èµ„æºæˆ–è€…è¯´æ˜¯å…±äº«æ•°æ®ï¼Œå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚ä½†æ˜¯æ¯ä¸€æ¬¡ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å®ƒï¼Œä¸€æ—¦ä¸´ç•ŒåŒºèµ„æºè¢«å ç”¨ï¼Œå…¶ä»–çº¿ç¨‹è¦æƒ³ä½¿ç”¨è¿™ä¸ªèµ„æºï¼Œå°±å¿…é¡»ç­‰å¾…ã€‚</p><p><strong>é˜»å¡ä¸éé˜»å¡</strong></p><p>é˜»å¡å’Œéé˜»å¡é€šå¸¸ç”¨æ¥å½¢å®¹å¤šçº¿ç¨‹é—´çš„ç›¸äº’å½±å“ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹å ç”¨äº†ä¸´ç•ŒåŒºèµ„æºï¼Œé‚£ä¹ˆå…¶å®ƒæ‰€æœ‰éœ€è¦è¿™ä¸ªèµ„æºçš„çº¿ç¨‹å°±å¿…é¡»åœ¨è¿™ä¸ªä¸´ç•ŒåŒºä¸­è¿›è¡Œç­‰å¾…ï¼Œç­‰å¾…ä¼šå¯¼è‡´çº¿ç¨‹æŒ‚èµ·ã€‚è¿™ç§æƒ…å†µå°±æ˜¯é˜»å¡ã€‚</p><p>æ­¤æ—¶ï¼Œå¦‚æœå ç”¨èµ„æºçš„çº¿ç¨‹ä¸€ç›´ä¸æ„¿æ„é‡Šæ”¾èµ„æºï¼Œé‚£ä¹ˆå…¶å®ƒæ‰€æœ‰é˜»å¡åœ¨è¿™ä¸ªä¸´ç•ŒåŒºä¸Šçš„çº¿ç¨‹éƒ½ä¸èƒ½å·¥ä½œã€‚é˜»å¡æ˜¯æŒ‡çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢è¢«æŒ‚èµ·ã€‚é˜»å¡ä¸€èˆ¬æ€§èƒ½ä¸å¥½ï¼Œéœ€å¤§çº¦8ä¸‡ä¸ªæ—¶é’Ÿå‘¨æœŸæ¥åšè°ƒåº¦ã€‚</p><p>éé˜»å¡åˆ™å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒºã€‚</p><p><strong>æ­»é”</strong>æ­»é”æ˜¯è¿›ç¨‹æ­»é”çš„ç®€ç§°ï¼Œæ˜¯æŒ‡å¤šä¸ªè¿›ç¨‹å¾ªç¯ç­‰å¾…ä»–æ–¹å æœ‰çš„èµ„æºè€Œæ— é™çš„åƒµæŒä¸‹å»çš„å±€é¢ã€‚</p><p><strong>æ´»é”</strong></p><p>å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹1ã€2ï¼Œå®ƒä»¬éƒ½éœ€è¦èµ„æº A/Bï¼Œå‡è®¾1å·çº¿ç¨‹å æœ‰äº† A èµ„æºï¼Œ2å·çº¿ç¨‹å æœ‰äº† B èµ„æºï¼›ç”±äºä¸¤ä¸ªçº¿ç¨‹éƒ½éœ€è¦åŒæ—¶æ‹¥æœ‰è¿™ä¸¤ä¸ªèµ„æºæ‰å¯ä»¥å·¥ä½œï¼Œä¸ºäº†é¿å…æ­»é”ï¼Œ1å·çº¿ç¨‹é‡Šæ”¾äº† A èµ„æºå æœ‰é”ï¼Œ2å·çº¿ç¨‹é‡Šæ”¾äº† B èµ„æºå æœ‰é”ï¼›æ­¤æ—¶ AB ç©ºé—²ï¼Œä¸¤ä¸ªçº¿ç¨‹åˆåŒæ—¶æŠ¢é”ï¼Œå†æ¬¡å‡ºç°ä¸Šè¿°æƒ…å†µï¼Œæ­¤æ—¶å‘ç”Ÿäº†æ´»é”ã€‚</p><p><strong>é¥¥é¥¿</strong>é¥¥é¥¿æ˜¯æŒ‡æŸä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å› ä¸ºç§ç§åŸå› æ— æ³•è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•æ‰§è¡Œã€‚</p><h2 id=ç”Ÿå‘½å‘¨æœŸ>ç”Ÿå‘½å‘¨æœŸ<a hidden class=anchor aria-hidden=true href=#ç”Ÿå‘½å‘¨æœŸ>#</a></h2><p><strong>åˆ›å»ºçŠ¶æ€</strong>å½“ç”¨ new æ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹å¯¹è±¡æ—¶ï¼Œè¯¥çº¿ç¨‹å¤„äºåˆ›å»ºçŠ¶æ€ã€‚å¤„äºåˆ›å»ºçŠ¶æ€çš„çº¿ç¨‹åªæ˜¯ä¸€ä¸ªç©ºçš„çº¿ç¨‹å¯¹è±¡ï¼Œç³»ç»Ÿä¸ä¸ºå®ƒåˆ†é…èµ„æºã€‚</p><p><strong>å°±ç»ªçŠ¶æ€</strong>æ‰§è¡Œçº¿ç¨‹çš„ start() æ–¹æ³•ä½¿çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ã€‚</p><p><strong>è¿è¡ŒçŠ¶æ€</strong>è°ƒåº¦ä¸ºçº¿ç¨‹åˆ†é…å¿…é¡»çš„ç³»ç»Ÿèµ„æºï¼Œå®‰æ’å…¶è¿è¡Œï¼Œå¹¶è°ƒç”¨çº¿ç¨‹ä½“â€”â€”run()æ–¹æ³•ï¼Œè¿™æ ·å°±ä½¿å¾—è¯¥çº¿ç¨‹å¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼ˆRunnableï¼‰ã€‚</p><p><strong>ä¼‘çœ çŠ¶æ€</strong></p><ul><li>è°ƒç”¨äº† sleep() æ–¹æ³•ï¼›</li></ul><p><strong>é˜»å¡çŠ¶æ€</strong>å½“å‘ç”Ÿä¸‹åˆ—äº‹ä»¶æ—¶ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ä¼šè½¬å…¥åˆ°é˜»å¡çŠ¶æ€ï¼š</p><ul><li>å½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è·å–ä¸€ä¸ªå†…éƒ¨çš„å¯¹è±¡é”ï¼ˆéjava.util.concurrentåº“ä¸­çš„é”ï¼‰ï¼Œè€Œè¯¥é”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</li><li>å½“ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹é€šçŸ¥è°ƒåº¦å™¨ä¸€ä¸ªæ¡ä»¶æ—¶ï¼Œè¯¥çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚ä¾‹å¦‚è°ƒç”¨ï¼šObject.wait()ã€Thread.join()ä»¥åŠç­‰å¾…Lockæˆ–Conditionã€‚</li><li>çº¿ç¨‹è¾“å…¥/è¾“å‡ºé˜»å¡ï¼›</li><li>çº¿ç¨‹è°ƒç”¨ wait() æ–¹æ³•ç­‰å¾…ç‰¹å®šæ¡ä»¶çš„æ»¡è¶³ï¼›</li><li>å¦‚æœçº¿ç¨‹åœ¨ç­‰å¾…æŸä¸€æ¡ä»¶ï¼Œå¦ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šè¿‡ notify() æˆ– notifyAll() æ–¹æ³•é€šçŸ¥ç­‰å¾…çº¿ç¨‹æ¡ä»¶çš„æ”¹å˜ï¼›</li><li>å¦‚æœçº¿ç¨‹æ˜¯å› ä¸ºè¾“å…¥è¾“å‡ºé˜»å¡ï¼Œéœ€è¦ç­‰å¾…è¾“å…¥è¾“å‡ºå®Œæˆã€‚</li></ul><h2 id=çº¿ç¨‹çš„åˆ›å»º>çº¿ç¨‹çš„åˆ›å»º<a hidden class=anchor aria-hidden=true href=#çº¿ç¨‹çš„åˆ›å»º>#</a></h2><p>javaåœ¨jdk5ä¹‹å‰åªæä¾›ç»§æ‰¿Threadå’Œå®ç°Runnableæ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹ï¼Œåœ¨jdk5ä¹‹ååˆ™æ–°å¢äº†ä¸¤ä¸ªæ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹ã€‚</p><h3 id=ç»§æ‰¿threadæ–¹å¼>ç»§æ‰¿Threadæ–¹å¼<a hidden class=anchor aria-hidden=true href=#ç»§æ‰¿threadæ–¹å¼>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * é€šè¿‡ç»§æ‰¿äºThreadç±»
</span></span></span><span class=line><span class=cl><span class=cm> * é‡å†™run()æ–¹æ³•ï¼Œä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Thread1</span> <span class=kd>extends</span> <span class=n>Thread</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>long</span> <span class=n>times</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Thread1</span><span class=o>(</span><span class=kt>long</span> <span class=n>times</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>times</span> <span class=o>=</span> <span class=n>times</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>times</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** *** times:&#34;</span><span class=o>+</span><span class=n>times</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// mainä¸­è°ƒç”¨ï¼š
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Thread1</span> <span class=n>thread1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread1</span><span class=o>(</span><span class=mi>5</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>thread1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//        ä¸èƒ½ç›´æ¥é€šè¿‡è°ƒç”¨run()çš„æ–¹å¼ç›´æ¥å¯åŠ¨çº¿ç¨‹,æ­¤æ—¶ä»å¤„äºä¸»çº¿ç¨‹(main)ä¸­ã€‚
</span></span></span><span class=line><span class=cl><span class=c1>//        thread1.run();
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>//         å¤šæ¬¡é€šè¿‡start()å¯åŠ¨çº¿ç¨‹ä¼šæŠ¥IllegalThreadStateException
</span></span></span><span class=line><span class=cl><span class=c1>//         thread1.start();
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>times</span> <span class=o>=</span> <span class=mi>5</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>times</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** *** times:&#34;</span><span class=o>+</span><span class=n>times</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>0</span>
</span></span></code></pre></div><h3 id=å®ç°runnableæ¥å£æ–¹å¼>å®ç°Runnableæ¥å£æ–¹å¼<a hidden class=anchor aria-hidden=true href=#å®ç°runnableæ¥å£æ–¹å¼>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * å®ç°Runnableæ¥å£æ–¹å¼ï¼Œ
</span></span></span><span class=line><span class=cl><span class=cm> * é‡å†™run()æ–¹æ³•ï¼Œä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚
</span></span></span><span class=line><span class=cl><span class=cm> * è°ƒç”¨çš„æ—¶å€™éœ€è¦new Thread(ä¼ å…¥å®ç°äº†Runnableæ¥å£çš„å®ä½“ç±»å¯¹è±¡)ï¼Œæ¯”å¦‚ï¼šnew Thread(p).start();
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Thread3</span> <span class=kd>implements</span> <span class=n>Runnable</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>long</span> <span class=n>times</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Thread3</span><span class=o>(</span><span class=kt>long</span> <span class=n>times</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>times</span> <span class=o>=</span> <span class=n>times</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>times</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** *** times:&#34;</span><span class=o>+</span><span class=n>times</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// mainä¸­è°ƒç”¨ï¼š
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread3</span> <span class=n>thread3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread3</span><span class=o>(</span><span class=mi>5</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>thread3</span><span class=o>).</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>times</span> <span class=o>=</span> <span class=mi>5</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>times</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** *** times:&#34;</span><span class=o>+</span><span class=n>times</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>0</span>
</span></span></code></pre></div><h3 id=å®ç°callableæ¥å£æ–¹å¼>å®ç°Callableæ¥å£æ–¹å¼<a hidden class=anchor aria-hidden=true href=#å®ç°callableæ¥å£æ–¹å¼>#</a></h3><p>Callableæ¥å£æºç ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * A task that returns a result and may throw an exception.
</span></span></span><span class=line><span class=cl><span class=cm> * Implementors define a single method with no arguments called
</span></span></span><span class=line><span class=cl><span class=cm> * {@code call}.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * &lt;p&gt;The {@code Callable} interface is similar to {@link
</span></span></span><span class=line><span class=cl><span class=cm> * java.lang.Runnable}, in that both are designed for classes whose
</span></span></span><span class=line><span class=cl><span class=cm> * instances are potentially executed by another thread.  A
</span></span></span><span class=line><span class=cl><span class=cm> * {@code Runnable}, however, does not return a result and cannot
</span></span></span><span class=line><span class=cl><span class=cm> * throw a checked exception.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * &lt;p&gt;The {@link Executors} class contains utility methods to
</span></span></span><span class=line><span class=cl><span class=cm> * convert from other common forms to {@code Callable} classes.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * @see Executor
</span></span></span><span class=line><span class=cl><span class=cm> * @since 1.5
</span></span></span><span class=line><span class=cl><span class=cm> * @author Doug Lea
</span></span></span><span class=line><span class=cl><span class=cm> * @param &lt;V&gt; the result type of method {@code call}
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=nd>@FunctionalInterface</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Callable</span><span class=o>&lt;</span><span class=n>V</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * Computes a result, or throws an exception if unable to do so.
</span></span></span><span class=line><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=cl><span class=cm>     * @return computed result
</span></span></span><span class=line><span class=cl><span class=cm>     * @throws Exception if unable to compute a result
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=n>V</span> <span class=nf>call</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * å®ç°Callableæ¥å£æ–¹å¼ï¼Œ
</span></span></span><span class=line><span class=cl><span class=cm> * é‡å†™call()æ–¹æ³•ï¼Œå°†çº¿ç¨‹ä¸­éœ€è¦æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=c1>// 1.åˆ›å»ºä¸€ä¸ªå®ç°Callableçš„ç±»
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>Thread4</span> <span class=kd>implements</span> <span class=n>Callable</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 2.å®ç°call()ï¼Œå°†çº¿ç¨‹ä¸­éœ€è¦æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘ä»£ç æ”¾åœ¨run()ä¸­ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Integer</span> <span class=nf>call</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mi>5</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>i</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** *** i:&#34;</span><span class=o>+</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>sum</span><span class=o>+=</span><span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>sum</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// mainä¸­è°ƒç”¨ï¼š
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 3.åˆ›å»ºCallableæ¥å£å®ç°ç±»çš„å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Thread4</span> <span class=n>thread4</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread4</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 4.å°†æ­¤Callableæ¥å£å®ç°ç±»çš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°FutureTaskæ„é€ å™¨ä¸­ï¼Œåˆ›å»ºFutureTaskçš„å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>FutureTask</span> <span class=n>futureTask</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FutureTask</span><span class=o>(</span><span class=n>thread4</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 5.å°†FutureTaskçš„å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’åˆ°Threadç±»çš„æ„é€ å™¨ä¸­ï¼Œåˆ›å»ºThreadå¯¹è±¡å¹¶è°ƒç”¨start()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>futureTask</span><span class=o>).</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>times</span> <span class=o>=</span> <span class=mi>5</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>times</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** *** times:&#34;</span><span class=o>+</span><span class=n>times</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 6.è·å–Callableä¸­callæ–¹æ³•çš„è¿”å›å€¼
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// get()è¿”å›å€¼å³ä¸ºFutureTaskæ„é€ å™¨å‚æ•°Callableå®ç°ç±»é‡å†™çš„call()çš„è¿”å›å€¼ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Object</span> <span class=n>o</span> <span class=o>=</span> <span class=n>futureTask</span><span class=o>.</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>o</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>ExecutionException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>i</span><span class=o>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>i</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>-</span><span class=mi>0</span><span class=o>**</span> <span class=o>***</span> <span class=n>i</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>
</span></span></code></pre></div><h3 id=ä½¿ç”¨çº¿ç¨‹æ± >ä½¿ç”¨çº¿ç¨‹æ± <a hidden class=anchor aria-hidden=true href=#ä½¿ç”¨çº¿ç¨‹æ± >#</a></h3><p>mainä¸­è°ƒç”¨ï¼ŒThread3å’ŒThread4åŒä¸Š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ExecutorService</span> <span class=n>executorService</span> <span class=o>=</span> <span class=n>Executors</span><span class=o>.</span><span class=na>newFixedThreadPool</span><span class=o>(</span><span class=mi>10</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åªé€‚åˆRunnableæ–¹å¼,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>executorService</span><span class=o>.</span><span class=na>execute</span><span class=o>(</span><span class=k>new</span> <span class=n>Thread3</span><span class=o>(</span><span class=mi>5</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// é€‚åˆCallableæ–¹å¼å’ŒRunnableæ–¹å¼,è¿”å›Futureå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Future</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>submit</span> <span class=o>=</span> <span class=n>executorService</span><span class=o>.</span><span class=na>submit</span><span class=o>(</span><span class=k>new</span> <span class=n>Thread4</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>submit</span><span class=o>.</span><span class=na>get</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>ExecutionException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span><span class=k>finally</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>executorService</span><span class=o>.</span><span class=na>shutdown</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>1</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>1</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>1</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>1</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>1</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>1</span><span class=o>**</span> <span class=o>***</span> <span class=n>times</span><span class=o>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>2</span><span class=o>**</span> <span class=o>***</span> <span class=n>i</span><span class=o>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>2</span><span class=o>**</span> <span class=o>***</span> <span class=n>i</span><span class=o>:</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>pool</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=n>thread</span><span class=o>-</span><span class=mi>2</span><span class=o>**</span> <span class=o>***</span> <span class=n>i</span><span class=o>:</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>
</span></span></code></pre></div><h3 id=å››ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒ>å››ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒ<a hidden class=anchor aria-hidden=true href=#å››ç§åˆ›å»ºæ–¹å¼æ¯”è¾ƒ>#</a></h3><p>é€šè¿‡ç»§æ‰¿Threadå’Œå®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œåªè¦æ³¨æ„å°†éœ€è¦è¿›è¡Œé€»è¾‘å¤„ç†çš„ä»£ç æ–¹æ³•é‡å†™çš„<code>run()</code>å°±å¥½ã€‚é€šè¿‡å®ç°Callableæ¥å£å’Œä½¿ç”¨çº¿ç¨‹æ± æ¥åˆ›å»ºçº¿ç¨‹æ˜¯jdk5ä¹‹åçš„æ–°æ–¹å¼ã€‚</p><p><strong>å®ç°Callableæ¥å£</strong></p><p>ä¸ä½¿ç”¨Runnableç›¸æ¯”ï¼ŒCallableåŠŸèƒ½æ›´å¼ºå¤§äº›</p><ul><li>å¯ä»¥æœ‰è¿”å›å€¼ï¼ŒFutureTaskçš„å¯¹è±¡çš„get()å¯ä»¥è·å–é‡å†™çš„<code>call()</code>çš„è¿”å›å€¼</li><li>æ–¹æ³•å¯ä»¥æŠ›å‡ºå¼‚å¸¸</li><li>æ”¯æŒæ³›å‹çš„è¿”å›å€¼</li><li>éœ€è¦å€ŸåŠ©FutureTaskç±»ï¼Œæ¯”å¦‚è·å–è¿”å›ç»“æœ</li></ul><p><strong>ä½¿ç”¨çº¿ç¨‹æ± </strong>èƒŒæ™¯ï¼š ç»å¸¸åˆ›å»ºå’Œé”€æ¯ã€ä½¿ç”¨é‡ç‰¹åˆ«å¤§çš„èµ„æºï¼Œæ¯”å¦‚å¹¶å‘æƒ…å†µä¸‹çš„çº¿ç¨‹ï¼Œå¯¹æ€§èƒ½å½±å“å¾ˆå¤§æ€è·¯ï¼šæå‰åˆ›å»ºå¥½å¤šä¸ªçº¿ç¨‹ï¼Œæ”¾å…¥çº¿ç¨‹æ± ä¸­ï¼Œä½¿ç”¨æ—¶ç›´æ¥è·å–ï¼Œä½¿ç”¨å®Œæ”¾å›æ± ä¸­ã€‚å¯ä»¥é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯ï¼Œå®ç°é‡å¤åˆ©ç”¨ã€‚ç±»ä¼¼ç”Ÿæ´»ä¸­çš„å…¬å…±äº¤é€šå·¥å…·ã€‚å¥½å¤„ï¼š</p><ul><li>æé«˜å“åº”é€Ÿåº¦ï¼ˆå‡å°‘äº†åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶é—´ï¼‰</li><li>é™ä½èµ„æºæ¶ˆè€—ï¼ˆé‡å¤åˆ©ç”¨çº¿ç¨‹æ± ä¸­çº¿ç¨‹ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºï¼‰</li><li>ä¾¿äºçº¿ç¨‹ç®¡ç†</li></ul><p>Javaä¸­åˆ›å»ºçº¿ç¨‹æ± å¾ˆç®€å•ï¼Œåªéœ€è¦è°ƒç”¨Executorsä¸­ç›¸åº”çš„ä¾¿æ·æ–¹æ³•å³å¯ï¼Œæ¯”å¦‚Executors.newFixedThreadPool(int nThreads)ï¼Œä½†æ˜¯ä¾¿æ·ä¸ä»…éšè—äº†å¤æ‚æ€§ï¼Œä¹Ÿä¸ºæˆ‘ä»¬åŸ‹ä¸‹äº†æ½œåœ¨çš„éšæ‚£ï¼ˆOOMï¼Œçº¿ç¨‹è€—å°½ï¼‰ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Javaçº¿ç¨‹æ± çš„å®Œæ•´æ„é€ å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=nf>ThreadPoolExecutor</span><span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>corePoolSize</span><span class=o>,</span> <span class=c1>// çº¿ç¨‹æ± é•¿æœŸç»´æŒçš„çº¿ç¨‹æ•°ï¼Œå³ä½¿çº¿ç¨‹å¤„äºIdleçŠ¶æ€ï¼Œä¹Ÿä¸ä¼šå›æ”¶ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>maximumPoolSize</span><span class=o>,</span> <span class=c1>// çº¿ç¨‹æ•°çš„ä¸Šé™
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>long</span> <span class=n>keepAliveTime</span><span class=o>,</span> <span class=n>TimeUnit</span> <span class=n>unit</span><span class=o>,</span> <span class=c1>// è¶…è¿‡corePoolSizeçš„çº¿ç¨‹çš„idleæ—¶é•¿ï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1></span>                                     <span class=c1>// è¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œå¤šä½™çš„çº¿ç¨‹ä¼šè¢«å›æ”¶ã€‚
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>BlockingQueue</span><span class=o>&lt;</span><span class=n>Runnable</span><span class=o>&gt;</span> <span class=n>workQueue</span><span class=o>,</span> <span class=c1>// ä»»åŠ¡çš„æ’é˜Ÿé˜Ÿåˆ—
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>ThreadFactory</span> <span class=n>threadFactory</span><span class=o>,</span> <span class=c1>// æ–°çº¿ç¨‹çš„äº§ç”Ÿæ–¹å¼
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>RejectedExecutionHandler</span> <span class=n>handler</span><span class=o>)</span> <span class=c1>// æ‹’ç»ç­–ç•¥
</span></span></span></code></pre></div><p>è¯¦ç»†å¯ä»¥æŸ¥çœ‹ThreadPoolExecutorç±»æºç ã€‚ä¹Ÿå¯ä»¥å‚è€ƒ<a href=https://www.cnblogs.com/CarpenterLee/p/9558026.html>https://www.cnblogs.com/CarpenterLee/p/9558026.html</a></p><h2 id=çº¿ç¨‹å®‰å…¨é—®é¢˜>çº¿ç¨‹å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#çº¿ç¨‹å®‰å…¨é—®é¢˜>#</a></h2><p>å‡è®¾æœ‰3ä¸ªçª—å£åœ¨åŒæ—¶å–50å¼ ç«è½¦ç¥¨ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç æ¥å®ç°ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window</span> <span class=kd>extends</span> <span class=n>Thread</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span><span class=o>+</span><span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Window</span> <span class=n>window1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Window</span> <span class=n>window2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Window</span> <span class=n>window3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>window1</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>window2</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>window3</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>window1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>window2</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>window3</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>sleep</span><span class=o>(</span><span class=mi>10000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Window</span><span class=o>.</span><span class=na>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>æœ€åå‡ æ¡æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>72</span>
</span></span></code></pre></div><p>ç»“æœå‘ç°3ä¸ªçª—å£æ€»å…±å–äº†72æ¬¡ï¼Œè€Œä¸”å…¶ä¸­æœ‰å¤šå¼ ç¥¨å·æœ‰é—®é¢˜ï¼ˆé‡ç¥¨å’Œè´Ÿæ•°ã€0å·ç¥¨ï¼‰çš„ç¥¨ï¼ŒåŸå› æ˜¯å¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶æ‰§è¡Œä¸‹é¢ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span><span class=o>+</span><span class=n>tickets</span><span class=o>--);</span>
</span></span></code></pre></div><p>è€Œä¸”è¿™äº›çº¿ç¨‹æŒæœ‰çš„ticketsç›¸åŒï¼Œæ‰€æœ‰å°±ä¼šå‡ºç°é‡ç¥¨ï¼Œè¿™å°±æ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><h3 id=åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>#</a></h3><h4 id=è§£å†³é€šè¿‡ç»§æ‰¿threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#è§£å†³é€šè¿‡ç»§æ‰¿threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window</span> <span class=kd>extends</span> <span class=n>Thread</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>synchronized</span> <span class=o>(</span><span class=n>Window</span><span class=o>.</span><span class=na>class</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>                    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span> <span class=o>+</span> <span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>                    <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Window</span> <span class=n>window1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Window</span> <span class=n>window2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Window</span> <span class=n>window3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>window1</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>window2</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>window3</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>window1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>window2</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>window3</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>sleep</span><span class=o>(</span><span class=mi>10000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Window</span><span class=o>.</span><span class=na>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>50</span>
</span></span></code></pre></div><h4 id=è§£å†³é€šè¿‡å®ç°runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#è§£å†³é€šè¿‡å®ç°runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window2</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>synchronized</span> <span class=o>(</span><span class=k>this</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span> <span class=o>+</span> <span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>                    <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>         <span class=n>Window2</span> <span class=n>window</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Window2</span><span class=o>();</span>
</span></span><span class=line><span class=cl>         <span class=n>Thread</span> <span class=n>window1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>window</span><span class=o>);</span>
</span></span><span class=line><span class=cl>         <span class=n>Thread</span> <span class=n>window2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>window</span><span class=o>);</span>
</span></span><span class=line><span class=cl>         <span class=n>Thread</span> <span class=n>window3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>window</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=n>window1</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>         <span class=n>window2</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>         <span class=n>window3</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;çª—å£3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=n>window1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>         <span class=n>window2</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>         <span class=n>window3</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>         <span class=n>sleep</span><span class=o>(</span><span class=mi>6000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>         <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>         <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>         <span class=o>}</span>
</span></span><span class=line><span class=cl>         <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Window2</span><span class=o>.</span><span class=na>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>50</span>
</span></span></code></pre></div><h3 id=åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>#</a></h3><h4 id=è§£å†³é€šè¿‡ç»§æ‰¿threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-1>è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#è§£å†³é€šè¿‡ç»§æ‰¿threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-1>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window</span> <span class=kd>extends</span> <span class=n>Thread</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(!</span><span class=n>compute</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>synchronized</span> <span class=kt>boolean</span> <span class=nf>compute</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span> <span class=o>+</span> <span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>50</span>
</span></span></code></pre></div><h4 id=è§£å†³é€šè¿‡å®ç°runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-1>è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#è§£å†³é€šè¿‡å®ç°runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-1>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window2</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(!</span><span class=n>compute</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>synchronized</span> <span class=kt>boolean</span> <span class=nf>compute</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span> <span class=o>+</span> <span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>50</span>
</span></span></code></pre></div><h3 id=lockè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>Lockè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#lockè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜>#</a></h3><p>jdk5ä¹‹åï¼Œ</p><h4 id=è§£å†³é€šè¿‡ç»§æ‰¿threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-2>è§£å†³é€šè¿‡ç»§æ‰¿Threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#è§£å†³é€šè¿‡ç»§æ‰¿threadç±»åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-2>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window2</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ReentrantLock</span> <span class=n>lock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ReentrantLock</span><span class=o>(</span><span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>lock</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>                    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span> <span class=o>+</span> <span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>                    <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span><span class=k>finally</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>48</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>50</span>
</span></span></code></pre></div><h4 id=è§£å†³é€šè¿‡å®ç°runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-2>è§£å†³é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜<a hidden class=anchor aria-hidden=true href=#è§£å†³é€šè¿‡å®ç°runnableæ¥å£åˆ›å»ºçš„å¤šçº¿ç¨‹ç¨‹åºå¼•èµ·çš„å®‰å…¨é—®é¢˜-2>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Window</span> <span class=kd>extends</span> <span class=n>Thread</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>tickets</span> <span class=o>=</span> <span class=mi>50</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç”¨æ¥è®¡ç®—run()æ€»å…±è·‘äº†å¤šå°‘æ¬¡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>ReentrantLock</span> <span class=n>lock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ReentrantLock</span><span class=o>(</span><span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>lock</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=o>(</span><span class=n>tickets</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>                    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;:å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š&#34;</span> <span class=o>+</span> <span class=n>tickets</span><span class=o>--);</span>
</span></span><span class=line><span class=cl>                    <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span><span class=k>finally</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>3</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>1</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>çª—å£</span><span class=mi>2</span><span class=o>:</span><span class=err>å–ç¥¨ï¼Œç¥¨å·ä¸ºï¼š</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>50</span>
</span></span></code></pre></div><h2 id=çº¿ç¨‹é€šä¿¡>çº¿ç¨‹é€šä¿¡<a hidden class=anchor aria-hidden=true href=#çº¿ç¨‹é€šä¿¡>#</a></h2><h3 id=ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜>ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜<a hidden class=anchor aria-hidden=true href=#ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜>#</a></h3><p>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼æ˜¯ä¸€ä¸ªååˆ†ç»å…¸çš„å¤šçº¿ç¨‹å¹¶å‘åä½œçš„æ¨¡å¼ï¼Œæ‰€è°“ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼Œå®é™…ä¸Šä¸»è¦æ˜¯åŒ…å«äº†ä¸¤ç±»çº¿ç¨‹ï¼Œä¸€ç§æ˜¯ç”Ÿäº§è€…çº¿ç¨‹ç”¨äºç”Ÿäº§æ•°æ®ï¼Œå¦ä¸€ç§æ˜¯æ¶ˆè´¹è€…çº¿ç¨‹ç”¨äºæ¶ˆè´¹æ•°æ®ï¼Œä¸ºäº†è§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å…³ç³»ï¼Œé€šå¸¸ä¼šé‡‡ç”¨å…±äº«çš„æ•°æ®åŒºåŸŸï¼Œå°±åƒæ˜¯ä¸€ä¸ªä»“åº“ï¼Œç”Ÿäº§è€…ç”Ÿäº§æ•°æ®ä¹‹åç›´æ¥æ”¾ç½®åœ¨å…±äº«æ•°æ®åŒºä¸­ï¼Œå¹¶ä¸éœ€è¦å…³å¿ƒæ¶ˆè´¹è€…çš„è¡Œä¸ºï¼›è€Œæ¶ˆè´¹è€…åªéœ€è¦ä»å…±äº«æ•°æ®åŒºä¸­å»è·å–æ•°æ®ï¼Œå°±ä¸å†éœ€è¦å…³å¿ƒç”Ÿäº§è€…çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªå…±äº«æ•°æ®åŒºåŸŸä¸­åº”è¯¥å…·å¤‡è¿™æ ·çš„çº¿ç¨‹é—´å¹¶å‘åä½œçš„åŠŸèƒ½ï¼š</p><ul><li>å¦‚æœå…±äº«æ•°æ®åŒºå·²æ»¡çš„è¯ï¼Œé˜»å¡ç”Ÿäº§è€…ç»§ç»­ç”Ÿäº§æ•°æ®æ”¾ç½®å…¥å†…ï¼›</li><li>å¦‚æœå…±äº«æ•°æ®åŒºä¸ºç©ºçš„è¯ï¼Œé˜»å¡æ¶ˆè´¹è€…ç»§ç»­æ¶ˆè´¹æ•°æ®ï¼›</li></ul><p>å®ç°æ¡ˆä¾‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Clerk</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>pruduce</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>sum</span> <span class=o>&lt;</span> <span class=mi>20</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** ****ç”Ÿäº§ç¬¬&#34;</span><span class=o>+</span><span class=n>sum</span><span class=o>+</span><span class=s>&#34;ä¸ªæ•°æ®&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>notify</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>wait</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>comsumer</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>sum</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()+</span><span class=s>&#34;** ****æ¶ˆè´¹ç¬¬&#34;</span><span class=o>+</span><span class=n>sum</span><span class=o>+</span><span class=s>&#34;ä¸ªæ•°æ®&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>sum</span><span class=o>--;</span>
</span></span><span class=line><span class=cl>            <span class=n>notify</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>wait</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Productor</span> <span class=kd>implements</span> <span class=n>Runnable</span><span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Clerk</span> <span class=n>clerk</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Productor</span><span class=o>(</span><span class=n>Clerk</span> <span class=n>clerk</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>clerk</span> <span class=o>=</span> <span class=n>clerk</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>clerk</span><span class=o>.</span><span class=na>pruduce</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Comsumer</span> <span class=kd>implements</span> <span class=n>Runnable</span><span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Clerk</span> <span class=n>clerk</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Comsumer</span><span class=o>(</span><span class=n>Clerk</span> <span class=n>clerk</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>clerk</span> <span class=o>=</span> <span class=n>clerk</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>clerk</span><span class=o>.</span><span class=na>comsumer</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ComsumerTest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Clerk</span> <span class=n>clerk</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Clerk</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Productor</span> <span class=n>productor</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Productor</span><span class=o>(</span><span class=n>clerk</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Comsumer</span> <span class=n>comsumer</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Comsumer</span><span class=o>(</span><span class=n>clerk</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Thread</span> <span class=n>threadProductor</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>productor</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Thread</span> <span class=n>threadComsumer</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>comsumer</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>threadProductor</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;Productor&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>threadComsumer</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;Comsumer&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>threadProductor</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>threadComsumer</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=æ­»é”ä»¥åŠæ­»é”é¿å…>æ­»é”ä»¥åŠæ­»é”é¿å…<a hidden class=anchor aria-hidden=true href=#æ­»é”ä»¥åŠæ­»é”é¿å…>#</a></h2><h3 id=æ­»é”çš„å®šä¹‰>æ­»é”çš„å®šä¹‰<a hidden class=anchor aria-hidden=true href=#æ­»é”çš„å®šä¹‰>#</a></h3><p>æ‰€è°“æ­»é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹å› ç«äº‰èµ„æºè€Œé€ æˆçš„ä¸€ç§åƒµå±€ï¼ˆäº’ç›¸ç­‰å¾…ï¼‰ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œè¿™äº›è¿›ç¨‹éƒ½å°†æ— æ³•å‘å‰æ¨è¿›ã€‚ä¾‹å¦‚ï¼ŒæŸè®¡ç®—æœºç³»ç»Ÿä¸­åªæœ‰ä¸€å°æ‰“å°æœºå’Œä¸€å°è¾“å…¥ è®¾å¤‡ï¼Œè¿›ç¨‹P1æ­£å ç”¨è¾“å…¥è®¾å¤‡ï¼ŒåŒæ—¶åˆæå‡ºä½¿ç”¨æ‰“å°æœºçš„è¯·æ±‚ï¼Œä½†æ­¤æ—¶æ‰“å°æœºæ­£è¢«è¿›ç¨‹P2 æ‰€å ç”¨ï¼Œè€ŒP2åœ¨æœªé‡Šæ”¾æ‰“å°æœºä¹‹å‰ï¼Œåˆæå‡ºè¯·æ±‚ä½¿ç”¨æ­£è¢«P1å ç”¨ç€çš„è¾“å…¥è®¾å¤‡ã€‚è¿™æ ·ä¸¤ä¸ªè¿›ç¨‹ç›¸äº’æ— ä¼‘æ­¢åœ°ç­‰å¾…ä¸‹å»ï¼Œå‡æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶ä¸¤ä¸ªè¿›ç¨‹é™·å…¥æ­»é”çŠ¶æ€ã€‚</p><h3 id=æ­»é”äº§ç”ŸåŸå› >æ­»é”äº§ç”ŸåŸå› <a hidden class=anchor aria-hidden=true href=#æ­»é”äº§ç”ŸåŸå› >#</a></h3><p><strong>ç³»ç»Ÿèµ„æºçš„ç«äº‰</strong></p><p>é€šå¸¸ç³»ç»Ÿä¸­æ‹¥æœ‰çš„ä¸å¯å‰¥å¤ºèµ„æºï¼Œå…¶æ•°é‡ä¸è¶³ä»¥æ»¡è¶³å¤šä¸ªè¿›ç¨‹è¿è¡Œçš„éœ€è¦ï¼Œä½¿å¾—è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šå› äº‰å¤ºèµ„æºè€Œé™·å…¥åƒµå±€ï¼Œå¦‚ç£å¸¦æœºã€æ‰“å°æœºç­‰ã€‚åªæœ‰å¯¹ä¸å¯å‰¥å¤ºèµ„æºçš„ç«äº‰æ‰å¯èƒ½äº§ç”Ÿæ­»é”ï¼Œå¯¹å¯å‰¥å¤ºèµ„æºçš„ç«äº‰æ˜¯ä¸ä¼šå¼•èµ·æ­»é”çš„ã€‚</p><p><strong>è¿›ç¨‹æ¨è¿›é¡ºåºéæ³•</strong></p><p>è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¯·æ±‚å’Œé‡Šæ”¾èµ„æºçš„é¡ºåºä¸å½“ï¼Œä¹ŸåŒæ ·ä¼šå¯¼è‡´æ­»é”ã€‚ä¾‹å¦‚ï¼Œå¹¶å‘è¿›ç¨‹ P1ã€P2åˆ†åˆ«ä¿æŒäº†èµ„æºR1ã€R2ï¼Œè€Œè¿›ç¨‹P1ç”³è¯·èµ„æºR2ï¼Œè¿›ç¨‹P2ç”³è¯·èµ„æºR1æ—¶ï¼Œä¸¤è€…éƒ½ä¼šå› ä¸ºæ‰€éœ€èµ„æºè¢«å ç”¨è€Œé˜»å¡ã€‚</p><p>Javaä¸­æ­»é”æœ€ç®€å•çš„æƒ…å†µæ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹T1æŒæœ‰é”L1å¹¶ä¸”ç”³è¯·è·å¾—é”L2ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹T2æŒæœ‰é”L2å¹¶ä¸”ç”³è¯·è·å¾—é”L1ï¼Œå› ä¸ºé»˜è®¤çš„é”ç”³è¯·æ“ä½œéƒ½æ˜¯é˜»å¡çš„ï¼Œæ‰€ä»¥çº¿ç¨‹T1å’ŒT2æ°¸è¿œè¢«é˜»å¡äº†ã€‚å¯¼è‡´äº†æ­»é”ã€‚è¿™æ˜¯æœ€å®¹æ˜“ç†è§£ä¹Ÿæ˜¯æœ€ç®€å•çš„æ­»é”çš„å½¢å¼ã€‚ä½†æ˜¯å®é™…ç¯å¢ƒä¸­çš„æ­»é”å¾€å¾€æ¯”è¿™ä¸ªå¤æ‚çš„å¤šã€‚å¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹å½¢æˆäº†ä¸€ä¸ªæ­»é”çš„ç¯è·¯ï¼Œæ¯”å¦‚ï¼šçº¿ç¨‹T1æŒæœ‰é”L1å¹¶ä¸”ç”³è¯·è·å¾—é”L2ï¼Œè€Œçº¿ç¨‹T2æŒæœ‰é”L2å¹¶ä¸”ç”³è¯·è·å¾—é”L3ï¼Œè€Œçº¿ç¨‹T3æŒæœ‰é”L3å¹¶ä¸”ç”³è¯·è·å¾—é”L1ï¼Œè¿™æ ·å¯¼è‡´äº†ä¸€ä¸ªé”ä¾èµ–çš„ç¯è·¯ï¼šT1ä¾èµ–T2çš„é”L2ï¼ŒT2ä¾èµ–T3çš„é”L3ï¼Œè€ŒT3ä¾èµ–T1çš„é”L1ã€‚ä»è€Œå¯¼è‡´äº†æ­»é”ã€‚</p><h3 id=æ­»é”äº§ç”Ÿæ¡ä»¶>æ­»é”äº§ç”Ÿæ¡ä»¶<a hidden class=anchor aria-hidden=true href=#æ­»é”äº§ç”Ÿæ¡ä»¶>#</a></h3><p><strong>äº’æ–¥æ¡ä»¶</strong>è¿›ç¨‹è¦æ±‚å¯¹æ‰€åˆ†é…çš„èµ„æºï¼ˆå¦‚æ‰“å°æœºï¼‰è¿›è¡Œæ’ä»–æ€§æ§åˆ¶ï¼Œå³åœ¨ä¸€æ®µæ—¶é—´å†…æŸèµ„æºä»…ä¸ºä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰ã€‚æ­¤æ—¶è‹¥æœ‰å…¶ä»–è¿›ç¨‹è¯·æ±‚è¯¥èµ„æºï¼Œåˆ™è¯·æ±‚è¿›ç¨‹åªèƒ½ç­‰å¾…ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯ä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚ç‹¬æœ¨æ¡¥æ¯æ¬¡åªèƒ½é€šè¿‡ä¸€ä¸ªäººã€‚</p><p><strong>ä¸å‰¥å¤ºæ¡ä»¶</strong>è¿›ç¨‹æ‰€è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œæ¯•ä¹‹å‰ï¼Œä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹å¼ºè¡Œå¤ºèµ°ï¼Œå³åªèƒ½ç”±è·å¾—è¯¥èµ„æºçš„è¿›ç¨‹è‡ªå·±æ¥é‡Šæ”¾ï¼ˆåªèƒ½æ˜¯ä¸»åŠ¨é‡Šæ”¾)ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚ä¹™ä¸é€€å‡ºæ¡¥é¢ï¼Œç”²ä¹Ÿä¸é€€å‡ºæ¡¥é¢ã€‚</p><p><strong>è¯·æ±‚å’Œä¿æŒæ¡ä»¶</strong>è¿›ç¨‹å·²ç»ä¿æŒäº†è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œä½†åˆæå‡ºäº†æ–°çš„èµ„æºè¯·æ±‚ï¼Œè€Œè¯¥èµ„æºå·²è¢«å…¶ä»–è¿›ç¨‹å æœ‰ï¼Œæ­¤æ—¶è¯·æ±‚è¿›ç¨‹è¢«é˜»å¡ï¼Œä½†å¯¹è‡ªå·±å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯è¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚ç”²ä¸èƒ½å¼ºåˆ¶ä¹™é€€å‡ºæ¡¥é¢ï¼Œä¹™ä¹Ÿä¸èƒ½å¼ºåˆ¶ç”²é€€å‡ºæ¡¥é¢ã€‚</p><p><strong>å¾ªç¯ç­‰å¾…æ¡ä»¶</strong>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå­˜åœ¨ä¸€ç§è¿›ç¨‹èµ„æºçš„å¾ªç¯ç­‰å¾…é“¾ï¼Œé“¾ä¸­æ¯ä¸€ä¸ªè¿›ç¨‹å·²è·å¾—çš„èµ„æºåŒæ—¶è¢«é“¾ä¸­ä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰€è¯·æ±‚ã€‚å³å­˜åœ¨ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„è¿›ç¨‹é›†åˆ{Pl, P2, &mldr;, pn}ï¼Œå…¶ä¸­Piç­‰ å¾…çš„èµ„æºè¢«P(i+1)å æœ‰ï¼ˆi=0, 1, &mldr;, n-1)ï¼ŒPnç­‰å¾…çš„èµ„æºè¢«P0å æœ‰ã€‚é€šä¿—ç‚¹è®²å°±æ˜¯è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚å¦‚æœä¹™ä¸é€€å‡ºæ¡¥é¢ï¼Œç”²ä¸èƒ½é€šè¿‡ï¼Œç”²ä¸é€€å‡ºæ¡¥é¢ï¼Œä¹™ä¸èƒ½é€šè¿‡ã€‚</p><h3 id=æ­»é”äº§ç”Ÿå®ä¾‹>æ­»é”äº§ç”Ÿå®ä¾‹<a hidden class=anchor aria-hidden=true href=#æ­»é”äº§ç”Ÿå®ä¾‹>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Dead</span> <span class=kd>implements</span> <span class=n>Runnable</span><span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>StringBuffer</span> <span class=n>s1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuffer</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>StringBuffer</span> <span class=n>s2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuffer</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>synchronized</span><span class=o>(</span><span class=n>s1</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>s1</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;ab&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kd>synchronized</span><span class=o>(</span><span class=n>s2</span><span class=o>){</span>
</span></span><span class=line><span class=cl>                <span class=n>s2</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;cd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>synchronized</span> <span class=o>(</span><span class=n>s2</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>sleep</span><span class=o>(</span><span class=mi>100</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>s2</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;ab&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kd>synchronized</span><span class=o>(</span><span class=n>s1</span><span class=o>){</span>
</span></span><span class=line><span class=cl>                <span class=n>s1</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;cd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s1</span><span class=o>+</span><span class=s>&#34;\n&#34;</span><span class=o>+</span><span class=n>s2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Dead</span> <span class=n>dead</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Dead</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>dead</span><span class=o>).</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>dead</span><span class=o>).</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=å¦‚ä½•é¿å…æ­»é”>å¦‚ä½•é¿å…æ­»é”<a hidden class=anchor aria-hidden=true href=#å¦‚ä½•é¿å…æ­»é”>#</a></h3><p>åœ¨æœ‰äº›æƒ…å†µä¸‹æ­»é”æ˜¯å¯ä»¥é¿å…çš„ã€‚ä¸‹é¢ä»‹ç»ä¸‰ç§ç”¨äºé¿å…æ­»é”çš„æŠ€æœ¯ï¼š</p><ul><li>åŠ é”é¡ºåºï¼ˆçº¿ç¨‹æŒ‰ç…§ä¸€å®šçš„é¡ºåºåŠ é”ï¼‰</li><li>åŠ é”æ—¶é™ï¼ˆçº¿ç¨‹å°è¯•è·å–é”çš„æ—¶å€™åŠ ä¸Šä¸€å®šçš„æ—¶é™ï¼Œè¶…è¿‡æ—¶é™åˆ™æ”¾å¼ƒå¯¹è¯¥é”çš„è¯·æ±‚ï¼Œå¹¶é‡Šæ”¾è‡ªå·±å æœ‰çš„é”ï¼‰</li><li>æ­»é”æ£€æµ‹</li></ul><p><strong>1ã€åŠ é”é¡ºåº</strong>å½“å¤šä¸ªçº¿ç¨‹éœ€è¦ç›¸åŒçš„ä¸€äº›é”ï¼Œä½†æ˜¯æŒ‰ç…§ä¸åŒçš„é¡ºåºåŠ é”ï¼Œæ­»é”å°±å¾ˆå®¹æ˜“å‘ç”Ÿã€‚å¦‚æœèƒ½ç¡®ä¿æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å¾—é”ï¼Œé‚£ä¹ˆæ­»é”å°±ä¸ä¼šå‘ç”Ÿã€‚ä¸Šé¢çš„é‚£ä¸ªä¾‹å­å°±æ˜¯åŠ é”é¡ºåºä¸å½“å¯¼è‡´çš„ã€‚é¿å…åµŒå¥—å°é”ï¼šè¿™æ˜¯æ­»é”æœ€ä¸»è¦çš„åŸå› çš„ï¼Œå¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ªèµ„æºäº†å°±è¦é¿å…å°é”å¦ä¸€ä¸ªèµ„æºã€‚å¦‚æœä½ è¿è¡Œæ—¶åªæœ‰ä¸€ä¸ªå¯¹è±¡å°é”ï¼Œé‚£æ˜¯å‡ ä¹ä¸å¯èƒ½å‡ºç°ä¸€ä¸ªæ­»é”å±€é¢çš„ã€‚</p><p><strong>2ã€åŠ é”æ—¶é™</strong>å¦å¤–ä¸€ä¸ªå¯ä»¥é¿å…æ­»é”çš„æ–¹æ³•æ˜¯åœ¨å°è¯•è·å–é”çš„æ—¶å€™åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€åœ¨å°è¯•è·å–é”çš„è¿‡ç¨‹ä¸­è‹¥è¶…è¿‡äº†è¿™ä¸ªæ—¶é™è¯¥çº¿ç¨‹åˆ™æ”¾å¼ƒå¯¹è¯¥é”è¯·æ±‚ã€‚è‹¥ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰åœ¨ç»™å®šçš„æ—¶é™å†…æˆåŠŸè·å¾—æ‰€æœ‰éœ€è¦çš„é”ï¼Œåˆ™ä¼šè¿›è¡Œå›é€€å¹¶é‡Šæ”¾æ‰€æœ‰å·²ç»è·å¾—çš„é”ï¼Œç„¶åç­‰å¾…ä¸€æ®µéšæœºçš„æ—¶é—´å†é‡è¯•ã€‚è¿™æ®µéšæœºçš„ç­‰å¾…æ—¶é—´è®©å…¶å®ƒçº¿ç¨‹æœ‰æœºä¼šå°è¯•è·å–ç›¸åŒçš„è¿™äº›é”ï¼Œå¹¶ä¸”è®©è¯¥åº”ç”¨åœ¨æ²¡æœ‰è·å¾—é”çš„æ—¶å€™å¯ä»¥ç»§ç»­è¿è¡Œ(åŠ é”è¶…æ—¶åå¯ä»¥å…ˆç»§ç»­è¿è¡Œå¹²ç‚¹å…¶å®ƒäº‹æƒ…ï¼Œå†å›å¤´æ¥é‡å¤ä¹‹å‰åŠ é”çš„é€»è¾‘)ã€‚</p><p><strong>3ã€æ­»é”æ£€æµ‹</strong>æ­»é”æ£€æµ‹æ˜¯ä¸€ä¸ªæ›´å¥½çš„æ­»é”é¢„é˜²æœºåˆ¶ï¼Œå®ƒä¸»è¦æ˜¯é’ˆå¯¹é‚£äº›ä¸å¯èƒ½å®ç°æŒ‰åºåŠ é”å¹¶ä¸”é”è¶…æ—¶ä¹Ÿä¸å¯è¡Œçš„åœºæ™¯ã€‚ä¸»è¦å¯ä»¥å‚è€ƒ<a href=https://baike.baidu.com/item/%E9%93%B6%E8%A1%8C%E5%AE%B6%E7%AE%97%E6%B3%95/1679781>é“¶è¡Œå®¶ç®—æ³•</a>çš„æ€æƒ³ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://luolin1024.github.io/tags/java/java%E5%9F%BA%E7%A1%80/>Java/JavaåŸºç¡€</a></li></ul><nav class=paginav><a class=prev href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%A9%E7%94%A8%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E4%BC%98%E5%8C%96%E4%BB%A3%E7%A0%81%E4%B8%AD%E8%BF%87%E5%A4%9A%E7%9A%84if-else%E6%80%9D%E8%B7%AF/><span class=title>Â« Prev</span><br><span>åˆ©ç”¨ç­–ç•¥æ¨¡å¼å’Œå·¥å‚æ¨¡å¼ä¼˜åŒ–ä»£ç ä¸­è¿‡å¤šçš„if-elseæ€è·¯</span></a>
<a class=next href=https://luolin1024.github.io/blog_prepublish/pre-publish/%E5%BD%B1%E5%93%8D%E5%8A%9B/><span class=title>Next Â»</span><br><span>å½±å“åŠ›</span></a></nav><div class=related-posts><h2>ç›¸å…³æ–‡ç« </h2><ul><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%BB%93%E5%90%88threadlocal%E7%9A%84%E7%94%A8%E6%B3%95%E5%AE%9E%E4%BE%8B/>Javaçº¿ç¨‹æ± ç»“åˆThreadLocalçš„ç”¨æ³•å®ä¾‹</a></li><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/object%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/>Objectæºç åˆ†æ</a></li><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/threadlocal%E5%92%8Cinheritablethreadlocal%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/>ThreadLocalå’ŒInheritableThreadLocalæºç åˆ†æ</a></li><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-%E5%8F%8D%E5%B0%84/>Java-åå°„</a></li><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-stream/>Java8 Stream</a></li></ul></div></footer><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><div id=waline></div><script type=module>
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    const locale = {
        nick: 'æ˜µç§°',
        nickError: 'è¯·å¡«å†™æ˜µç§°',
        mail: 'é‚®ç®±',
        mailError: 'è¯·å¡«å†™æ­£ç¡®çš„é‚®ä»¶åœ°å€',
        link: 'ç½‘å€',
        optional: 'å¯é€‰',
        placeholder: 'ä»…å¡«å†™æ˜µç§°å³å¯å‘è¡¨å›å¤ã€‚\nå¡«å†™é‚®ç®±å¯æ”¶åˆ°å›å¤æé†’ã€‚\nè¯„è®ºåŒºæ”¯æŒ Markdown è¯­æ³•åŠé¢„è§ˆã€‚\n',
        sofa: 'æ¥å‘è¯„è®ºå§~',
        submit: 'æäº¤',
        like: 'å–œæ¬¢',
        cancelLike: 'å–æ¶ˆå–œæ¬¢',
        reply: 'å›å¤',
        cancelReply: 'å–æ¶ˆå›å¤',
        comment: 'è¯„è®º',
        refresh: 'åˆ·æ–°',
        more: 'åŠ è½½æ›´å¤š...',
        preview: 'é¢„è§ˆ',
        emoji: 'è¡¨æƒ…',
        uploadImage: 'ä¸Šä¼ å›¾ç‰‡',
        seconds: 'ç§’å‰',
        minutes: 'åˆ†é’Ÿå‰',
        hours: 'å°æ—¶å‰',
        days: 'å¤©å‰',
        now: 'åˆšåˆš',
        uploading: 'æ­£åœ¨ä¸Šä¼ ',
        login: 'ç®¡ç†',
        logout: 'é€€å‡º',
        admin: 'åšä¸»',
        sticky: 'ç½®é¡¶',
        word: 'å­—',
        wordHint: 'è¯„è®ºå­—æ•°åº”åœ¨ $0 åˆ° $1 å­—ä¹‹é—´ï¼\nå½“å‰å­—æ•°ï¼š$2',
        anonymous: 'åŒ¿å',
        level0: 'æ½œæ°´',
        level1: 'å†’æ³¡',
        level2: 'åæ§½',
        level3: 'æ´»è·ƒ',
        level4: 'è¯ç—¨',
        level5: 'ä¼ è¯´',
        gif: 'è¡¨æƒ…åŒ…',
        gifSearchPlaceholder: 'æœç´¢è¡¨æƒ…åŒ…',
        profile: 'ä¸ªäººèµ„æ–™',
        approved: 'é€šè¿‡',
        waiting: 'å¾…å®¡æ ¸',
        spam: 'åƒåœ¾',
        unsticky: 'å–æ¶ˆç½®é¡¶',
        oldest: 'æŒ‰å€’åº',
        latest: 'æŒ‰æ­£åº',
        hottest: 'æŒ‰çƒ­åº¦',
        reactionTitle: 'ä½ è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ',
    };
    init({
        
        el: '#waline',
        serverURL: 'https://blogcomments.luolin.online',
        locale,
        emoji: false,     
        search: false,    
        reaction: false,  
        requiredMeta: ['nick'],
        pageSize: 10,
        imageUploader: false,
        copyright: true,
        pageview: true,
        like: false,
    });
</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://luolin1024.github.io>luolin1024</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div>æœ¬ç«™æ€»è®¿é—®é‡ <span id=umami_value_site_pv></span> æ¬¡
æœ¬ç«™æ€»è®¿å®¢æ•° <span id=umami_value_site_uv></span> äºº
å½“å‰åœ¨çº¿è®¿å®¢ <span id=umami_value_active_uv></span> äºº</div><a href="https://icp.gov.moe/?keyword=20248618" target=_blank>èŒICPå¤‡20248618å·</a></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>