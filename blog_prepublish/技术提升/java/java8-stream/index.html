<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Java8 Stream | luolin1024</title><meta name=keywords content="Java/Java基础"><meta name=description content="java Stream是什么 首先，我们来看下java怎么描述Stream的： A sequence of elements supporting sequential and parallel aggregate operations. 其实学习stream之前我以为stream式很难的，"><meta name=author content="luolin"><link rel=canonical href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-stream/><script defer src=https://blogcounter.luolin.us.kg/script.js data-website-id=c8850e2c-16aa-465e-aa6f-5392c9397317></script>
<script src=/js/umami-stats.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script>
<link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://luolin1024.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://luolin1024.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://luolin1024.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://luolin1024.github.io/apple-touch-icon.png><link rel=mask-icon href=https://luolin1024.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><html><head><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css><style>body{font-family:lxgw wenkai lite,sans-serif;font-family:lxgw wenkai screen,sans-serif}</style></head></html><meta property="og:title" content="Java8 Stream"><meta property="og:description" content="java Stream是什么 首先，我们来看下java怎么描述Stream的： A sequence of elements supporting sequential and parallel aggregate operations. 其实学习stream之前我以为stream式很难的，"><meta property="og:type" content="article"><meta property="og:url" content="https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-stream/"><meta property="article:section" content="blog_prepublish"><meta property="article:published_time" content="2023-02-11T00:32:19+08:00"><meta property="article:modified_time" content="2024-03-21T00:57:01+08:00"><meta property="og:site_name" content="luolin的博客"><meta name=twitter:card content="summary"><meta name=twitter:title content="Java8 Stream"><meta name=twitter:description content="java Stream是什么 首先，我们来看下java怎么描述Stream的： A sequence of elements supporting sequential and parallel aggregate operations. 其实学习stream之前我以为stream式很难的，"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog_prepublishes","item":"https://luolin1024.github.io/blog_prepublish/"},{"@type":"ListItem","position":2,"name":"Java8 Stream","item":"https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-stream/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Java8 Stream","name":"Java8 Stream","description":"java Stream是什么 首先，我们来看下java怎么描述Stream的： A sequence of elements supporting sequential and parallel aggregate operations. 其实学习stream之前我以为stream式很难的，","keywords":["Java/Java基础"],"articleBody":"java Stream是什么 首先，我们来看下java怎么描述Stream的：\nA sequence of elements supporting sequential and parallel aggregate operations.\n其实学习stream之前我以为stream式很难的，但是学完之后，发现其实还好，并不难，主要在于是否熟练。Stream是java8的新特性，它与 java.io 包里的 InputStream和 OutputStream是完全不同的概念.java8中的Stream主要是用于处理java中的数据的。而且Stream只是将原来的数据拷贝一份，然后通过中间操作处理拷贝的数据，最后通过终端操作将得到我们想要的数据。而且Stream是一种惰性加载的。（惰性加载：如果流的操作中没有执行终止操作也不会执行中间操作。）接下来我们看下Stream的总纲： 详细图：\nstream 创建 废话不多说，直接先上代码：\n// 创建Stream @Test public void test1(){ // 1.通过Collection系列集合提供得stream()或parallelStream()(并行流) // 所有的Collection集合都可以通过stream默认方法获取流 List\u003cString\u003e list = new ArrayList\u003c\u003e(16); Stream\u003cString\u003e stream1 = list.stream(); // 2.通过Arrays中的静态方法stream() 获取数组流 Employee[] employees = new Employee[10]; Stream\u003cEmployee\u003e stream2 = Arrays.stream(employees); // 3. 通过Stream中的静态方法of()，实际上还是数组流 Stream\u003cString\u003e stream3 = Stream.of(\"aa\",\"bb\",\"cc\"); // 4. 无限流 (迭代,生成) Stream\u003cInteger\u003e stream4 = Stream.iterate(0,(x)-\u003ex+2); stream4.limit(10).forEach(System.out::println); // 5. 使用generate(Supplier s)生成流，需要重写Supplier中的get()方法 Stream.generate(()-\u003eMath.random()*10).limit(5).forEach(System.out::println); // 6.创建一个空的stream Stream\u003cInteger\u003e stream5 = Stream.empty(); } 上面大体上把大多数创建流的方式列出来了，但是我记得之前在csdn上看到一篇博客，上面记载了很多创建流的方式，现在找不到那篇博客了，所以就先把这些方式列出来。\n中间操作 首先把测试过程中使用到的实体类以及对应的测试数据先整出来：\n@Data @Builder @NoArgsConstructor @AllArgsConstructor class Employee{ String name; int age; int salary; } List\u003cEmployee\u003e employees = Arrays.asList( new Employee(\"张三\", 11, 9000), new Employee(\"李四\", 33, 3000), new Employee(\"王五\", 44, 4000), new Employee(\"王五\", 44, 4000), new Employee(\"王五\", 44, 4000), new Employee(\"p8\", 44, 4000), new Employee(\"李四\", 44, 4000), new Employee(\"p8\", 55, 2000) ); filter过滤 limit 截断 @Test public void test2(){ // filter过滤 // limit 截断 employees.stream().filter(x-\u003e{ System.out.println(\"执行中间操作\"); return x.getAge() \u003e 22; }).forEach(System.out::println); } skip @Test public void test3(){ // skip(n)，跳过n个元素 employees.stream().skip(1).forEach(System.out::println); } distinct去重 @Test public void test4(){ // distinct去重:通过流所生成元素的hashCode()和equals()去除重复元素 employees.stream().distinct().forEach(System.out::println); } map @Test public void test5(){ // map 接收lambda，将元素转换成其他形式或提取信息。 // 接收一个函数作为参数，该函数会被应用到每个元素上，并将其映射成一个新的元素 List\u003cString\u003e list = Arrays.asList(\"aaa\",\"bbb\",\"ccc\",\"ddd\",\"eee\"); list.stream().map((str)-\u003estr.toUpperCase()) .forEach(System.out::println); System.out.println(\"----------------------------\"); employees.stream() .map(Employee::getName) .forEach(System.out::println); System.out.println(\"----------------------------\"); list.stream().map(StreamTest::filterCharacter).forEach((sm)-\u003e{ System.out.println(\"--------第一层----------\"); sm.forEach(System.out::println); }); } flatMap,基本与map功能相同，只是可以把一个二位map整成一个一维的，多维的可不可以弄成一维的还没有测试，后面可以试下。 @Test public void test6(){ List\u003cString\u003e list = Arrays.asList(\"aaa\",\"bbb\",\"ccc\",\"ddd\",\"eee\"); // flatMap 接收一个函数作为参数，将流中的每个值都换成另一个流，然后把所有的流连接成一个流。 list.stream().flatMap(StreamTest::filterCharacter).forEach(System.out::println); } public static Stream\u003cCharacter\u003e filterCharacter(String str){ List\u003cCharacter\u003e list = new ArrayList\u003c\u003e(); for(Character ch:str.toCharArray()){ list.add(ch); } return list.stream(); } sorted,默认排序 @Test public void test7(){ // sorted()-默认排序 List\u003cString\u003e list = Arrays.asList(\"aa\",\"dd\",\"cc\",\"a\"); list.stream().sorted().forEach(System.out::println); } sorted，重写Comparator中的compare方法 @Test public void test8(){ // sorted-自定义排序 employees.stream().sorted((e1, e2)-\u003e{ if(e1.getAge() == e2.getAge()){ return e1.getName().compareTo(e2.getName()); }else{ return Integer.compare(e1.getAge(),e2.getAge()); } }).forEach(System.out::println); } 终止操作（终端操作） allMatch() 匹配查询集合中是否都符合条件，返回true/false anyMatch() 匹配查询集合中是否存在符合条件的，返回true/false count() 统计集合中数量……………… 在使用idea可以直接看到stream中的最终操作方法，也能一眼就看明白是要干什么的操作，所以就不一一写到笔记了。\n惰性加载 stream中的惰性加载就是在没有执行最终操作的情况下，所有的中间操作也不会执行。\n@Test public void test13(){ List\u003cString\u003e list = new ArrayList\u003cString\u003e(); list.add(\"1\"); list.add(\"2\"); list.add(\"3\"); list.stream().filter(x -\u003e { System.out.println(x); return true; }); } 上面这段代码并不会产生任何的输出，原因是filter只刻画了stream，但是并没有产生新的集合，而像这种没有实际功能，只是描述stream的操作，就叫做惰性求值。而如果在filter之后加上count()（最终操作）则会执行print操作，这种操作叫做及早求值：\n@Test public void test13(){ List\u003cString\u003e list = new ArrayList\u003cString\u003e(); list.add(\"1\"); list.add(\"2\"); list.add(\"3\"); list.stream().filter(x -\u003e { System.out.print(x+\" \"); return true; }).count(); // 打印结果： 1 2 3 } 惰性加载和及早求值区别：\n对流对象Stream进行惰性求值，返回值仍然是一个Stream对象。 对流对象Stream进行及早求值，返回值不再是一个Stream对象。 Stream 并发流 测试Stream并发流主要是通过计算1到50亿的累加，如下：\nlong s = 0L; long e = 5000000000L; 普通for循环 使用最基础的for去计算累加，如下：\n@Test public void test10(){ Instant start = Instant.now(); long sum = 0L; for(long i = s; i \u003c e; i++) { sum += i; } System.out.println(sum); Instant end = Instant.now(); System.out.println(Duration.between(start,end).toMillis()); } 具体时间就不写了，有兴趣的可以自己试下，下面两个也是一样。\nfork-join框架 使用fork-join框架先要重写好RecursiveTask中的compute方法，在compute方法中进行fork()和join()操作。\npublic class ForkJoinSum extends RecursiveTask\u003cLong\u003e { private static final long serialVersionUID = 100000000L; private long start; private long end; private final long THRESHHOLD = 10000L; public ForkJoinSum(long start, long end){ this.start = start; this.end = end; } @Override protected Long compute() { if(end - start \u003c= THRESHHOLD){ long sum = 0L; for(long i = start; i \u003c end; i++) { sum += i; } return sum; } else { long mid = (end+start)/2; ForkJoinSum left = new ForkJoinSum(start, mid); left.fork(); ForkJoinSum right = new ForkJoinSum(mid+1, end); right.fork(); return left.join()+right.join(); } } } 然后再来测试：\n@Test public void test9(){ // 使用fork，join框架 Instant start = Instant.now(); ForkJoinSum forkJoinSum = new ForkJoinSum(s,e); System.out.println(forkJoinSum.compute()); Instant end = Instant.now(); System.out.println(Duration.between(start, end).toMillis()); } stream并发 使用stream并发流计算累加：\n@Test public void test11(){ // 流式并行 Instant start = Instant.now(); OptionalLong optionalLong = LongStream.rangeClosed(s,e) .parallel() .reduce(Long::sum); System.out.println(optionalLong.getAsLong()); Instant end = Instant.now(); System.out.println(Duration.between(start,end).toMillis()); } 实例 先定义一个实体类用于后续使用：\nclass Person{ private int id; private String name; private Date day; private int age; public Person() { } public Person(int id, String name, Date day, int age) { this.id = id; this.name = name; this.day = day; this.age = age; } public int getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public Date getDay() { return day; } public void setDay(Date day) { this.day = day; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } } 判断List中的多个元素是否重复 假如给定数据为一个List,我们需要根据Person中的某几个元素判断是否存在重复。此时可以利用stream中的map和distinct获取count，与原始list的size进行比较判断是否存在重复：\n@Test public void test10(){ List\u003cPerson\u003e peopleList = new ArrayList\u003c\u003e(); for (int i = 0; i \u003c 10; i++) { peopleList.add(new Person(i, \"name\"+i, new Date(), i+10)); peopleList.add(new Person(i, \"name\"+i, new Date(), i+10)); } long count = peopleList.stream().map(x -\u003e x.getName() + \"_\" + x.getAge()).distinct().count(); System.out.println(peopleList.size() == count); } // 打印结果：false 根据上面的代码可以判断出peopleList中，name和age相同的数据存在重复。\nList中的元素相加求合 假如给定数据为一个List,我们需要根据Person中的某几个元素进行相加之后累加：\n@Test public void test11(){ List\u003cPerson\u003e peopleList = new ArrayList\u003c\u003e(); for (int i = 0; i \u003c 10; i++) { peopleList.add(new Person(i, \"name\"+i, new Date(), i+10)); } Integer sum = peopleList.stream().map(x -\u003e x.getId() + x.getAge()).reduce(0, Integer::sum); System.out.println(sum); } // 打印结果：190 小结 虽然上面的几个测试我没有写结果，但是我自己之前测的时候结果是：数据量较小的时候直接使用for累加花费的时间较短，另外两个所用时间都较多，而数据量较大的时候使用并发计算则所用时间较短，但是使用for累加所用时间是成倍数上升的。而stream流计算并发和fork-join框架计算所用时间是差不多的。这里只是使用了.parallel()来生成并发流，使用集合的parallelStream()也可以生成并发流的。\n","wordCount":"2894","inLanguage":"en","datePublished":"2023-02-11T00:32:19+08:00","dateModified":"2024-03-21T00:57:01+08:00","author":{"@type":"Person","name":"luolin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-stream/"},"publisher":{"@type":"Organization","name":"luolin1024","logo":{"@type":"ImageObject","url":"https://luolin1024.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://luolin1024.github.io accesskey=h title="luolin的博客 (Alt + H)">luolin的博客</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://luolin1024.github.io/posts title=📚文章><span>📚文章</span></a></li><li><a href=https://luolin1024.github.io/archives/ title=⏱时间轴><span>⏱时间轴</span></a></li><li><a href=https://luolin1024.github.io/search/ title="🔍搜索 (Alt + /)" accesskey=/><span>🔍搜索</span></a></li><li><a href=https://luolin1024.github.io/tags title=🔖标签><span>🔖标签</span></a></li><li><a href=https://luolin1024.github.io/about title=🙋🏻‍♂️关于><span>🙋🏻‍♂️关于</span></a></li><li><a href=https://luolin1024.github.io/links title=🤝友链><span>🤝友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://luolin1024.github.io>Home</a>&nbsp;»&nbsp;<a href=https://luolin1024.github.io/blog_prepublish/>Blog_prepublishes</a></div><h1 class="post-title entry-hint-parent">Java8 Stream</h1><div class=post-meta><span title='2023-02-11 00:32:19 +0800 +0800'>2023-02-11</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;2894 words&nbsp;·&nbsp;luolin
本文总阅读量 <span id=umami_value_page_pv></span> 次
本文总访客量 <span id=umami_value_page_uv></span> 人</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#java-stream%e6%98%af%e4%bb%80%e4%b9%88 aria-label="java Stream是什么">java Stream是什么</a><ul><li><a href=#stream-%e5%88%9b%e5%bb%ba aria-label="stream 创建">stream 创建</a></li><li><a href=#%e4%b8%ad%e9%97%b4%e6%93%8d%e4%bd%9c aria-label=中间操作>中间操作</a></li><li><a href=#%e7%bb%88%e6%ad%a2%e6%93%8d%e4%bd%9c%e7%bb%88%e7%ab%af%e6%93%8d%e4%bd%9c aria-label=终止操作（终端操作）>终止操作（终端操作）</a></li><li><a href=#%e6%83%b0%e6%80%a7%e5%8a%a0%e8%bd%bd aria-label=惰性加载>惰性加载</a></li></ul></li><li><a href=#stream-%e5%b9%b6%e5%8f%91%e6%b5%81 aria-label="Stream 并发流">Stream 并发流</a><ul><li><a href=#%e6%99%ae%e9%80%9afor%e5%be%aa%e7%8e%af aria-label=普通for循环>普通for循环</a></li><li><a href=#fork-join%e6%a1%86%e6%9e%b6 aria-label=fork-join框架>fork-join框架</a></li><li><a href=#stream%e5%b9%b6%e5%8f%91 aria-label=stream并发>stream并发</a></li></ul></li><li><a href=#%e5%ae%9e%e4%be%8b aria-label=实例>实例</a><ul><li><a href=#%e5%88%a4%e6%96%adlist%e4%b8%ad%e7%9a%84%e5%a4%9a%e4%b8%aa%e5%85%83%e7%b4%a0%e6%98%af%e5%90%a6%e9%87%8d%e5%a4%8d aria-label=判断List中的多个元素是否重复>判断List中的多个元素是否重复</a></li><li><a href=#list%e4%b8%ad%e7%9a%84%e5%85%83%e7%b4%a0%e7%9b%b8%e5%8a%a0%e6%b1%82%e5%90%88 aria-label=List中的元素相加求合>List中的元素相加求合</a></li></ul></li><li><a href=#%e5%b0%8f%e7%bb%93 aria-label=小结>小结</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=java-stream是什么>java Stream是什么<a hidden class=anchor aria-hidden=true href=#java-stream是什么>#</a></h2><p>首先，我们来看下java怎么描述Stream的：</p><blockquote><p>A sequence of elements supporting sequential and parallel aggregate operations.</p></blockquote><p>其实学习stream之前我以为stream式很难的，但是学完之后，发现其实还好，并不难，主要在于是否熟练。Stream是java8的新特性，它与 java.io 包里的 InputStream和 OutputStream是完全不同的概念.java8中的Stream主要是用于处理java中的数据的。而且Stream只是将原来的数据拷贝一份，然后通过中间操作处理拷贝的数据，最后通过终端操作将得到我们想要的数据。而且Stream是一种惰性加载的。（惰性加载：如果流的操作中没有执行终止操作也不会执行中间操作。）接下来我们看下Stream的总纲：<div class=post-img-view><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311618-d01ff890-b733-4114-ba11-01f83a76907d.png><img src=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311618-d01ff890-b733-4114-ba11-01f83a76907d.png alt></a></div></p><p>详细图：</p><p><div class=post-img-view><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311668-9436ca2a-a78e-4805-9a72-7b3bd936eb47.jpeg><img src=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311668-9436ca2a-a78e-4805-9a72-7b3bd936eb47.jpeg alt></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311662-89aa8c41-db9e-444a-97d3-a246f5880b11.jpeg><img src=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311662-89aa8c41-db9e-444a-97d3-a246f5880b11.jpeg alt></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311695-d64adfa5-5802-4649-b78e-4c1e61ec2eb8.jpeg><img src=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311695-d64adfa5-5802-4649-b78e-4c1e61ec2eb8.jpeg alt></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311671-65db4169-cdf4-4202-b07b-131f2c470d13.jpeg><img src=https://cdn.jsdelivr.net/gh/luolin1024/image@main/img/1596509311671-65db4169-cdf4-4202-b07b-131f2c470d13.jpeg alt></a></div></p><h3 id=stream-创建>stream 创建<a hidden class=anchor aria-hidden=true href=#stream-创建>#</a></h3><p>废话不多说，直接先上代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 创建Stream
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test1</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 1.通过Collection系列集合提供得stream()或parallelStream()(并行流)
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// 所有的Collection集合都可以通过stream默认方法获取流
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=mi>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Stream</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stream1</span> <span class=o>=</span> <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 2.通过Arrays中的静态方法stream() 获取数组流
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Employee</span><span class=o>[]</span> <span class=n>employees</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Employee</span><span class=o>[</span><span class=mi>10</span><span class=o>];</span>
</span></span><span class=line><span class=cl>    <span class=n>Stream</span><span class=o>&lt;</span><span class=n>Employee</span><span class=o>&gt;</span> <span class=n>stream2</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>stream</span><span class=o>(</span><span class=n>employees</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 3. 通过Stream中的静态方法of()，实际上还是数组流
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Stream</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stream3</span> <span class=o>=</span> <span class=n>Stream</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;aa&#34;</span><span class=o>,</span><span class=s>&#34;bb&#34;</span><span class=o>,</span><span class=s>&#34;cc&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 4. 无限流 (迭代,生成)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Stream</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>stream4</span> <span class=o>=</span> <span class=n>Stream</span><span class=o>.</span><span class=na>iterate</span><span class=o>(</span><span class=mi>0</span><span class=o>,(</span><span class=n>x</span><span class=o>)-&gt;</span><span class=n>x</span><span class=o>+</span><span class=mi>2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>stream4</span><span class=o>.</span><span class=na>limit</span><span class=o>(</span><span class=mi>10</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 5. 使用generate(Supplier&lt;T&gt; s)生成流，需要重写Supplier中的get()方法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Stream</span><span class=o>.</span><span class=na>generate</span><span class=o>(()-&gt;</span><span class=n>Math</span><span class=o>.</span><span class=na>random</span><span class=o>()*</span><span class=mi>10</span><span class=o>).</span><span class=na>limit</span><span class=o>(</span><span class=mi>5</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 6.创建一个空的stream
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Stream</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>stream5</span>  <span class=o>=</span> <span class=n>Stream</span><span class=o>.</span><span class=na>empty</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>上面大体上把大多数创建流的方式列出来了，但是我记得之前在csdn上看到一篇博客，上面记载了很多创建流的方式，现在找不到那篇博客了，所以就先把这些方式列出来。</p><h3 id=中间操作>中间操作<a hidden class=anchor aria-hidden=true href=#中间操作>#</a></h3><p>首先把测试过程中使用到的实体类以及对应的测试数据先整出来：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span>
</span></span><span class=line><span class=cl><span class=nd>@Builder</span>
</span></span><span class=line><span class=cl><span class=nd>@NoArgsConstructor</span>
</span></span><span class=line><span class=cl><span class=nd>@AllArgsConstructor</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Employee</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>salary</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Employee</span><span class=o>&gt;</span> <span class=n>employees</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;张三&#34;</span><span class=o>,</span> <span class=mi>11</span><span class=o>,</span> <span class=mi>9000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;李四&#34;</span><span class=o>,</span> <span class=mi>33</span><span class=o>,</span> <span class=mi>3000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;王五&#34;</span><span class=o>,</span> <span class=mi>44</span><span class=o>,</span> <span class=mi>4000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;王五&#34;</span><span class=o>,</span> <span class=mi>44</span><span class=o>,</span> <span class=mi>4000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;王五&#34;</span><span class=o>,</span> <span class=mi>44</span><span class=o>,</span> <span class=mi>4000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;p8&#34;</span><span class=o>,</span> <span class=mi>44</span><span class=o>,</span> <span class=mi>4000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;李四&#34;</span><span class=o>,</span> <span class=mi>44</span><span class=o>,</span> <span class=mi>4000</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;p8&#34;</span><span class=o>,</span> <span class=mi>55</span><span class=o>,</span> <span class=mi>2000</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>);</span>
</span></span></code></pre></div><ol><li>filter过滤 limit 截断</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test2</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// filter过滤
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// limit 截断
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>employees</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>filter</span><span class=o>(</span><span class=n>x</span><span class=o>-&gt;{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;执行中间操作&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span><span class=o>.</span><span class=na>getAge</span><span class=o>()</span> <span class=o>&gt;</span> <span class=mi>22</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol start=2><li>skip</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test3</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// skip(n)，跳过n个元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>employees</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>skip</span><span class=o>(</span><span class=mi>1</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol start=3><li>distinct去重</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test4</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// distinct去重:通过流所生成元素的hashCode()和equals()去除重复元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>employees</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>distinct</span><span class=o>().</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol start=4><li>map</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test5</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// map 接收lambda，将元素转换成其他形式或提取信息。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 接收一个函数作为参数，该函数会被应用到每个元素上，并将其映射成一个新的元素
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=s>&#34;aaa&#34;</span><span class=o>,</span><span class=s>&#34;bbb&#34;</span><span class=o>,</span><span class=s>&#34;ccc&#34;</span><span class=o>,</span><span class=s>&#34;ddd&#34;</span><span class=o>,</span><span class=s>&#34;eee&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>map</span><span class=o>((</span><span class=n>str</span><span class=o>)-&gt;</span><span class=n>str</span><span class=o>.</span><span class=na>toUpperCase</span><span class=o>())</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;----------------------------&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>employees</span><span class=o>.</span><span class=na>stream</span><span class=o>()</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>Employee</span><span class=o>::</span><span class=n>getName</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;----------------------------&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>map</span><span class=o>(</span><span class=n>StreamTest</span><span class=o>::</span><span class=n>filterCharacter</span><span class=o>).</span><span class=na>forEach</span><span class=o>((</span><span class=n>sm</span><span class=o>)-&gt;{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;--------第一层----------&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sm</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol start=5><li>flatMap,基本与map功能相同，只是可以把一个二位map整成一个一维的，多维的可不可以弄成一维的还没有测试，后面可以试下。</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test6</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=s>&#34;aaa&#34;</span><span class=o>,</span><span class=s>&#34;bbb&#34;</span><span class=o>,</span><span class=s>&#34;ccc&#34;</span><span class=o>,</span><span class=s>&#34;ddd&#34;</span><span class=o>,</span><span class=s>&#34;eee&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// flatMap 接收一个函数作为参数，将流中的每个值都换成另一个流，然后把所有的流连接成一个流。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>flatMap</span><span class=o>(</span><span class=n>StreamTest</span><span class=o>::</span><span class=n>filterCharacter</span><span class=o>).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=n>Stream</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>filterCharacter</span><span class=o>(</span><span class=n>String</span> <span class=n>str</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=n>Character</span> <span class=n>ch</span><span class=o>:</span><span class=n>str</span><span class=o>.</span><span class=na>toCharArray</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>        <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>ch</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol start=6><li>sorted,默认排序</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test7</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// sorted()-默认排序
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=s>&#34;aa&#34;</span><span class=o>,</span><span class=s>&#34;dd&#34;</span><span class=o>,</span><span class=s>&#34;cc&#34;</span><span class=o>,</span><span class=s>&#34;a&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>sorted</span><span class=o>().</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol start=7><li>sorted，重写Comparator中的compare方法</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test8</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// sorted-自定义排序
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>employees</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>sorted</span><span class=o>((</span><span class=n>e1</span><span class=o>,</span> <span class=n>e2</span><span class=o>)-&gt;{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>e1</span><span class=o>.</span><span class=na>getAge</span><span class=o>()</span> <span class=o>==</span> <span class=n>e2</span><span class=o>.</span><span class=na>getAge</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>e1</span><span class=o>.</span><span class=na>getName</span><span class=o>().</span><span class=na>compareTo</span><span class=o>(</span><span class=n>e2</span><span class=o>.</span><span class=na>getName</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span><span class=k>else</span><span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Integer</span><span class=o>.</span><span class=na>compare</span><span class=o>(</span><span class=n>e1</span><span class=o>.</span><span class=na>getAge</span><span class=o>(),</span><span class=n>e2</span><span class=o>.</span><span class=na>getAge</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}).</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=终止操作终端操作>终止操作（终端操作）<a hidden class=anchor aria-hidden=true href=#终止操作终端操作>#</a></h3><ul><li>allMatch() 匹配查询集合中是否都符合条件，返回true/false</li><li>anyMatch() 匹配查询集合中是否存在符合条件的，返回true/false</li><li>count() 统计集合中数量………………</li></ul><p>在使用idea可以直接看到stream中的最终操作方法，也能一眼就看明白是要干什么的操作，所以就不一一写到笔记了。</p><h3 id=惰性加载>惰性加载<a hidden class=anchor aria-hidden=true href=#惰性加载>#</a></h3><p>stream中的惰性加载就是在没有执行最终操作的情况下，所有的中间操作也不会执行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test13</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>filter</span><span class=o>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>x</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>上面这段代码并不会产生任何的输出，原因是filter只刻画了stream，但是并没有产生新的集合，而像这种没有实际功能，只是描述stream的操作，就叫做惰性求值。而如果在filter之后加上count()（最终操作）则会执行print操作，这种操作叫做及早求值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test13</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>filter</span><span class=o>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>x</span><span class=o>+</span><span class=s>&#34; &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}).</span><span class=na>count</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 打印结果： 1 2 3 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>惰性加载和及早求值区别：</p><ul><li>对流对象Stream进行惰性求值，返回值仍然是一个Stream对象。</li><li>对流对象Stream进行及早求值，返回值不再是一个Stream对象。</li></ul><h2 id=stream-并发流>Stream 并发流<a hidden class=anchor aria-hidden=true href=#stream-并发流>#</a></h2><p>测试Stream并发流主要是通过计算1到50亿的累加，如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>long</span> <span class=n>s</span> <span class=o>=</span> <span class=mi>0</span><span class=n>L</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>long</span> <span class=n>e</span> <span class=o>=</span> <span class=mi>5000000000L</span><span class=o>;</span>
</span></span></code></pre></div><h3 id=普通for循环>普通for循环<a hidden class=anchor aria-hidden=true href=#普通for循环>#</a></h3><p>使用最基础的for去计算累加，如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test10</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>Instant</span> <span class=n>start</span> <span class=o>=</span> <span class=n>Instant</span><span class=o>.</span><span class=na>now</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=n>L</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>long</span> <span class=n>i</span> <span class=o>=</span> <span class=n>s</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>e</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sum</span> <span class=o>+=</span> <span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Instant</span> <span class=n>end</span> <span class=o>=</span> <span class=n>Instant</span><span class=o>.</span><span class=na>now</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Duration</span><span class=o>.</span><span class=na>between</span><span class=o>(</span><span class=n>start</span><span class=o>,</span><span class=n>end</span><span class=o>).</span><span class=na>toMillis</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>具体时间就不写了，有兴趣的可以自己试下，下面两个也是一样。</p><h3 id=fork-join框架>fork-join框架<a hidden class=anchor aria-hidden=true href=#fork-join框架>#</a></h3><p>使用fork-join框架先要重写好RecursiveTask中的compute方法，在compute方法中进行fork()和join()操作。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ForkJoinSum</span> <span class=kd>extends</span> <span class=n>RecursiveTask</span><span class=o>&lt;</span><span class=n>Long</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=kt>long</span> <span class=n>serialVersionUID</span> <span class=o>=</span> <span class=mi>100000000L</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>long</span> <span class=n>start</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>long</span> <span class=n>end</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=kt>long</span> <span class=n>THRESHHOLD</span> <span class=o>=</span> <span class=mi>10000L</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>ForkJoinSum</span><span class=o>(</span><span class=kt>long</span> <span class=n>start</span><span class=o>,</span> <span class=kt>long</span> <span class=n>end</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>start</span> <span class=o>=</span> <span class=n>start</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>end</span> <span class=o>=</span> <span class=n>end</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=n>Long</span> <span class=nf>compute</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=n>THRESHHOLD</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=kt>long</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=n>L</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=o>(</span><span class=kt>long</span> <span class=n>i</span> <span class=o>=</span> <span class=n>start</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>end</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>sum</span> <span class=o>+=</span> <span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>sum</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>long</span> <span class=n>mid</span> <span class=o>=</span> <span class=o>(</span><span class=n>end</span><span class=o>+</span><span class=n>start</span><span class=o>)/</span><span class=mi>2</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>ForkJoinSum</span> <span class=n>left</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ForkJoinSum</span><span class=o>(</span><span class=n>start</span><span class=o>,</span> <span class=n>mid</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>left</span><span class=o>.</span><span class=na>fork</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>ForkJoinSum</span> <span class=n>right</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ForkJoinSum</span><span class=o>(</span><span class=n>mid</span><span class=o>+</span><span class=mi>1</span><span class=o>,</span> <span class=n>end</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>right</span><span class=o>.</span><span class=na>fork</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>left</span><span class=o>.</span><span class=na>join</span><span class=o>()+</span><span class=n>right</span><span class=o>.</span><span class=na>join</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>然后再来测试：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test9</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 使用fork，join框架
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Instant</span> <span class=n>start</span> <span class=o>=</span> <span class=n>Instant</span><span class=o>.</span><span class=na>now</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>ForkJoinSum</span> <span class=n>forkJoinSum</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ForkJoinSum</span><span class=o>(</span><span class=n>s</span><span class=o>,</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>forkJoinSum</span><span class=o>.</span><span class=na>compute</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>Instant</span> <span class=n>end</span> <span class=o>=</span> <span class=n>Instant</span><span class=o>.</span><span class=na>now</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Duration</span><span class=o>.</span><span class=na>between</span><span class=o>(</span><span class=n>start</span><span class=o>,</span> <span class=n>end</span><span class=o>).</span><span class=na>toMillis</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=stream并发>stream并发<a hidden class=anchor aria-hidden=true href=#stream并发>#</a></h3><p>使用stream并发流计算累加：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test11</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 流式并行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Instant</span> <span class=n>start</span> <span class=o>=</span> <span class=n>Instant</span><span class=o>.</span><span class=na>now</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>OptionalLong</span> <span class=n>optionalLong</span> <span class=o>=</span> <span class=n>LongStream</span><span class=o>.</span><span class=na>rangeClosed</span><span class=o>(</span><span class=n>s</span><span class=o>,</span><span class=n>e</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>parallel</span><span class=o>()</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>reduce</span><span class=o>(</span><span class=n>Long</span><span class=o>::</span><span class=n>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>optionalLong</span><span class=o>.</span><span class=na>getAsLong</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=n>Instant</span> <span class=n>end</span> <span class=o>=</span> <span class=n>Instant</span><span class=o>.</span><span class=na>now</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Duration</span><span class=o>.</span><span class=na>between</span><span class=o>(</span><span class=n>start</span><span class=o>,</span><span class=n>end</span><span class=o>).</span><span class=na>toMillis</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=实例>实例<a hidden class=anchor aria-hidden=true href=#实例>#</a></h2><p>先定义一个实体类用于后续使用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Person</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Date</span> <span class=n>day</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Person</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Person</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>,</span> <span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=n>Date</span> <span class=n>day</span><span class=o>,</span> <span class=kt>int</span> <span class=n>age</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>day</span> <span class=o>=</span> <span class=n>day</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>age</span> <span class=o>=</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>getId</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setId</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getName</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Date</span> <span class=nf>getDay</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>day</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setDay</span><span class=o>(</span><span class=n>Date</span> <span class=n>day</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>day</span> <span class=o>=</span> <span class=n>day</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>getAge</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setAge</span><span class=o>(</span><span class=kt>int</span> <span class=n>age</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>age</span> <span class=o>=</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=判断list中的多个元素是否重复>判断List中的多个元素是否重复<a hidden class=anchor aria-hidden=true href=#判断list中的多个元素是否重复>#</a></h3><p>假如给定数据为一个List,我们需要根据Person中的某几个元素判断是否存在重复。此时可以利用stream中的map和distinct获取count，与原始list的size进行比较判断是否存在重复：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test10</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Person</span><span class=o>&gt;</span> <span class=n>peopleList</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>peopleList</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=s>&#34;name&#34;</span><span class=o>+</span><span class=n>i</span><span class=o>,</span> <span class=k>new</span> <span class=n>Date</span><span class=o>(),</span> <span class=n>i</span><span class=o>+</span><span class=mi>10</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>peopleList</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=s>&#34;name&#34;</span><span class=o>+</span><span class=n>i</span><span class=o>,</span> <span class=k>new</span> <span class=n>Date</span><span class=o>(),</span> <span class=n>i</span><span class=o>+</span><span class=mi>10</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=n>count</span> <span class=o>=</span> <span class=n>peopleList</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>map</span><span class=o>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=n>x</span><span class=o>.</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;_&#34;</span> <span class=o>+</span> <span class=n>x</span><span class=o>.</span><span class=na>getAge</span><span class=o>()).</span><span class=na>distinct</span><span class=o>().</span><span class=na>count</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>peopleList</span><span class=o>.</span><span class=na>size</span><span class=o>()</span> <span class=o>==</span> <span class=n>count</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 打印结果：false
</span></span></span></code></pre></div><p>根据上面的代码可以判断出peopleList中，name和age相同的数据存在重复。</p><h3 id=list中的元素相加求合>List中的元素相加求合<a hidden class=anchor aria-hidden=true href=#list中的元素相加求合>#</a></h3><p>假如给定数据为一个List,我们需要根据Person中的某几个元素进行相加之后累加：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test11</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>Person</span><span class=o>&gt;</span> <span class=n>peopleList</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>peopleList</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=s>&#34;name&#34;</span><span class=o>+</span><span class=n>i</span><span class=o>,</span> <span class=k>new</span> <span class=n>Date</span><span class=o>(),</span> <span class=n>i</span><span class=o>+</span><span class=mi>10</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>Integer</span> <span class=n>sum</span> <span class=o>=</span> <span class=n>peopleList</span><span class=o>.</span><span class=na>stream</span><span class=o>().</span><span class=na>map</span><span class=o>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=n>x</span><span class=o>.</span><span class=na>getId</span><span class=o>()</span> <span class=o>+</span> <span class=n>x</span><span class=o>.</span><span class=na>getAge</span><span class=o>()).</span><span class=na>reduce</span><span class=o>(</span><span class=mi>0</span><span class=o>,</span> <span class=n>Integer</span><span class=o>::</span><span class=n>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>sum</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 打印结果：190
</span></span></span></code></pre></div><h2 id=小结>小结<a hidden class=anchor aria-hidden=true href=#小结>#</a></h2><p>虽然上面的几个测试我没有写结果，但是我自己之前测的时候结果是：数据量较小的时候直接使用for累加花费的时间较短，另外两个所用时间都较多，而数据量较大的时候使用并发计算则所用时间较短，但是使用for累加所用时间是成倍数上升的。而stream流计算并发和fork-join框架计算所用时间是差不多的。这里只是使用了.parallel()来生成并发流，使用集合的parallelStream()也可以生成并发流的。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://luolin1024.github.io/tags/java/java%E5%9F%BA%E7%A1%80/>Java/Java基础</a></li></ul><nav class=paginav><a class=prev href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-%E5%8F%8D%E5%B0%84/><span class=title>« Prev</span><br><span>Java-反射</span></a>
<a class=next href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E5%92%8Clambda/><span class=title>Next »</span><br><span>Java8 函数式编程和Lambda</span></a></nav><div class=related-posts><h2>相关文章</h2><ul><li>· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%BB%93%E5%90%88threadlocal%E7%9A%84%E7%94%A8%E6%B3%95%E5%AE%9E%E4%BE%8B/>Java线程池结合ThreadLocal的用法实例</a></li><li>· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/object%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/>Object源码分析</a></li><li>· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/threadlocal%E5%92%8Cinheritablethreadlocal%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/>ThreadLocal和InheritableThreadLocal源码分析</a></li><li>· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-%E5%8F%8D%E5%B0%84/>Java-反射</a></li><li>· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java8-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E5%92%8Clambda/>Java8 函数式编程和Lambda</a></li></ul></div></footer><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><div id=waline></div><script type=module>
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    const locale = {
        nick: '昵称',
        nickError: '请填写昵称',
        mail: '邮箱',
        mailError: '请填写正确的邮件地址',
        link: '网址',
        optional: '可选',
        placeholder: '仅填写昵称即可发表回复。\n填写邮箱可收到回复提醒。\n评论区支持 Markdown 语法及预览。\n',
        sofa: '来发评论吧~',
        submit: '提交',
        like: '喜欢',
        cancelLike: '取消喜欢',
        reply: '回复',
        cancelReply: '取消回复',
        comment: '评论',
        refresh: '刷新',
        more: '加载更多...',
        preview: '预览',
        emoji: '表情',
        uploadImage: '上传图片',
        seconds: '秒前',
        minutes: '分钟前',
        hours: '小时前',
        days: '天前',
        now: '刚刚',
        uploading: '正在上传',
        login: '管理',
        logout: '退出',
        admin: '博主',
        sticky: '置顶',
        word: '字',
        wordHint: '评论字数应在 $0 到 $1 字之间！\n当前字数：$2',
        anonymous: '匿名',
        level0: '潜水',
        level1: '冒泡',
        level2: '吐槽',
        level3: '活跃',
        level4: '话痨',
        level5: '传说',
        gif: '表情包',
        gifSearchPlaceholder: '搜索表情包',
        profile: '个人资料',
        approved: '通过',
        waiting: '待审核',
        spam: '垃圾',
        unsticky: '取消置顶',
        oldest: '按倒序',
        latest: '按正序',
        hottest: '按热度',
        reactionTitle: '你认为这篇文章怎么样？',
    };
    init({
        
        el: '#waline',
        serverURL: 'https://blogcomments.luolin.online',
        locale,
        emoji: false,     
        search: false,    
        reaction: false,  
        requiredMeta: ['nick'],
        pageSize: 10,
        imageUploader: false,
        copyright: true,
        pageview: true,
        like: false,
    });
</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://luolin1024.github.io>luolin1024</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div>本站总访问量 <span id=umami_value_site_pv></span> 次
本站总访客数 <span id=umami_value_site_uv></span> 人
当前在线访客 <span id=umami_value_active_uv></span> 人</div><a href="https://icp.gov.moe/?keyword=20248618" target=_blank>萌ICP备20248618号</a></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>