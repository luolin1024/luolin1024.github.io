<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Java Map | luolin1024</title><meta name=keywords content="Java/æ•°æ®ç»“æ„"><meta name=description content="æœ¬æ–‡ä¸»è¦ä»‹ç»Mapæ¥å£ä»¥åŠå…¶ä¸»è¦å®ç°ç±»ï¼šHashMapã€LinkedHashMapã€TreeMapã€Hashtableã€Properties"><meta name=author content="luolin"><link rel=canonical href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-map/><script defer src=https://blogcounter.luolin.us.kg/script.js data-website-id=c8850e2c-16aa-465e-aa6f-5392c9397317></script>
<script src=/js/umami-stats.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script>
<link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://luolin1024.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://luolin1024.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://luolin1024.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://luolin1024.github.io/apple-touch-icon.png><link rel=mask-icon href=https://luolin1024.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><html><head><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css><style>body{font-family:lxgw wenkai lite,sans-serif;font-family:lxgw wenkai screen,sans-serif}</style></head></html><meta property="og:title" content="Java Map"><meta property="og:description" content="æœ¬æ–‡ä¸»è¦ä»‹ç»Mapæ¥å£ä»¥åŠå…¶ä¸»è¦å®ç°ç±»ï¼šHashMapã€LinkedHashMapã€TreeMapã€Hashtableã€Properties"><meta property="og:type" content="article"><meta property="og:url" content="https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-map/"><meta property="article:section" content="blog_prepublish"><meta property="article:published_time" content="2023-02-11T00:32:19+08:00"><meta property="article:modified_time" content="2024-03-21T00:57:09+08:00"><meta property="og:site_name" content="luolinçš„åšå®¢"><meta name=twitter:card content="summary"><meta name=twitter:title content="Java Map"><meta name=twitter:description content="æœ¬æ–‡ä¸»è¦ä»‹ç»Mapæ¥å£ä»¥åŠå…¶ä¸»è¦å®ç°ç±»ï¼šHashMapã€LinkedHashMapã€TreeMapã€Hashtableã€Properties"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog_prepublishes","item":"https://luolin1024.github.io/blog_prepublish/"},{"@type":"ListItem","position":2,"name":"Java Map","item":"https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-map/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Java Map","name":"Java Map","description":"æœ¬æ–‡ä¸»è¦ä»‹ç»Mapæ¥å£ä»¥åŠå…¶ä¸»è¦å®ç°ç±»ï¼šHashMapã€LinkedHashMapã€TreeMapã€Hashtableã€Properties","keywords":["Java/æ•°æ®ç»“æ„"],"articleBody":"æœ¬æ–‡ä¸»è¦ä»‹ç»Mapæ¥å£ä»¥åŠå…¶ä¸»è¦å®ç°ç±»ï¼šHashMapã€LinkedHashMapã€TreeMapã€Hashtableã€Propertiesï¼Œå…¶ä¸­åŒ…æ‹¬HashMapã€TreeMapçš„åº•å±‚å®ç°åŸç†ã€‚\nMapçš„éå†æ–¹å¼ æ–¹å¼ä¸€,è¿™æ˜¯æœ€å¸¸è§çš„å¹¶ä¸”åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¹Ÿæ˜¯æœ€å¯å–çš„éå†æ–¹å¼ã€‚åœ¨é”®å€¼éƒ½éœ€è¦æ—¶ä½¿ç”¨:\nMap\u003cInteger, Integer\u003e map = new HashMap\u003cInteger, Integer\u003e(); for (Map.Entry\u003cInteger, Integer\u003e entry : map.entrySet()) { System.out.println(\"Key = \" + entry.getKey() + \", Value = \" + entry.getValue()); } æ–¹å¼äºŒï¼Œåœ¨for-eachå¾ªç¯ä¸­éå†keysæˆ–values(æ®è¯´è¯¥æ–¹æ³•æ¯”entrySetéå†åœ¨æ€§èƒ½ä¸Šç¨å¥½ï¼ˆå¿«äº†10%ï¼‰ï¼Œæˆ‘è¿˜æ²¡æœ‰æµ‹è¯•è¿‡)ï¼š\nMap\u003cInteger, Integer\u003e map = new HashMap\u003cInteger, Integer\u003e(); //éå†mapä¸­çš„é”® for (Integer key : map.keySet()) { System.out.println(\"Key = \" + key); } //éå†mapä¸­çš„å€¼ for (Integer value : map.values()) { System.out.println(\"Value = \" + value); } æ–¹å¼ä¸‰ï¼Œä½¿ç”¨è¿­ä»£å™¨éå†ï¼ˆè¯¥ç§æ–¹å¼çœ‹èµ·æ¥å†—ä½™å´æœ‰å…¶ä¼˜ç‚¹æ‰€åœ¨ã€‚é¦–å…ˆï¼Œåœ¨è€ç‰ˆæœ¬javaä¸­è¿™æ˜¯æƒŸä¸€éå†mapçš„æ–¹å¼ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥åœ¨éå†æ—¶è°ƒç”¨iterator.remove()æ¥åˆ é™¤entriesï¼Œå¦ä¸¤ä¸ªæ–¹æ³•åˆ™ä¸èƒ½ã€‚ï¼‰ï¼š\n// ä¸ä½¿ç”¨æ³›å‹ Map map = new HashMap(); Iterator entries = map.entrySet().iterator(); while (entries.hasNext()) { Map.Entry entry = (Map.Entry) entries.next(); Integer key = (Integer)entry.getKey(); Integer value = (Integer)entry.getValue(); System.out.println(\"Key = \" + key + \", Value = \" + value); } // ä½¿ç”¨æ³›å‹ Map\u003cInteger, Integer\u003e map = new HashMap\u003c\u003e(); Iterator\u003cMap.Entry\u003cInteger, Integer\u003e\u003e iterator = map.entrySet().iterator(); while (iterator.hasNext()){ Map.Entry\u003cInteger, Integer\u003e next = iterator.next(); System.out.println(next); } æ–¹å¼å››ï¼Œé€šè¿‡é”®æ‰¾å€¼éå†ï¼ˆå¾ªç¯ä¸­é€šè¿‡keyæ¥æ‹¿åˆ°valueæ•ˆç‡ä½ï¼‰ï¼š\nMap\u003cInteger, Integer\u003e map = new HashMap\u003cInteger, Integer\u003e(); for (Integer key : map.keySet()) { Integer value = map.get(key); System.out.println(\"Key = \" + key + \", Value = \" + value); } JDK HashMapæºç åˆ†æ HashMapåˆå§‹åŒ–ï¼š\nstatic final int MAXIMUM_CAPACITY = 1 \u003c\u003c 30; static final float DEFAULT_LOAD_FACTOR = 0.75f; public HashMap(int initialCapacity, float loadFactor) { if (initialCapacity \u003c 0) throw new IllegalArgumentException(\"Illegal initial capacity: \" + initialCapacity); if (initialCapacity \u003e MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; if (loadFactor \u003c= 0 || Float.isNaN(loadFactor)) throw new IllegalArgumentException(\"Illegal load factor: \" + loadFactor); this.loadFactor = loadFactor; this.threshold = tableSizeFor(initialCapacity); } public HashMap(int initialCapacity) { this(initialCapacity, DEFAULT_LOAD_FACTOR); } public HashMap() { this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted } public HashMap(Map\u003c? extends K, ? extends V\u003e m) { this.loadFactor = DEFAULT_LOAD_FACTOR; putMapEntries(m, false); } static final int tableSizeFor(int cap) { int n = cap - 1; n |= n \u003e\u003e\u003e 1; n |= n \u003e\u003e\u003e 2; n |= n \u003e\u003e\u003e 4; n |= n \u003e\u003e\u003e 8; n |= n \u003e\u003e\u003e 16; return (n \u003c 0) ? 1 : (n \u003e= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1; } æ˜¾ç„¶ï¼Œåœ¨åˆå§‹åŒ–æ—¶å¦‚æœæ²¡æœ‰ä¼ å…¥Mapçš„å¤§å°ï¼Œåˆ™åªæ˜¯æ”¹äº†ä¸‹äº†ä¸€ä¸ªåŠ è½½å› å­ï¼›è€Œåœ¨ä¼ å…¥initialCapacityæ—¶åˆ™ä¼šè®¡ç®—å‡ºthresholdï¼ˆä¸´ç•Œå€¼ï¼‰ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦è¿›è¡Œæ‰©å®¹ã€‚ç„¶ååœ¨ä½¿ç”¨put()çš„æ—¶å€™æ‰ä¼šçœŸæ­£åˆ›å»ºhashTableï¼š\nstatic final int DEFAULT_INITIAL_CAPACITY = 1 \u003c\u003c 4; // aka 16 /** * Associates the specified value with the specified key in this map. * If the map previously contained a mapping for the key, the old * value is replaced. * * @param key key with which the specified value is to be associated * @param value value to be associated with the specified key * @return the previous value associated with key, or * null if there was no mapping for key. * (A null return can also indicate that the map * previously associated null with key.) */ public V put(K key, V value) { return putVal(hash(key), key, value, false, true); } /** * Implements Map.put and related methods * * @param hash hash for key * @param key the key * @param value the value to put * @param onlyIfAbsent if true, don't change existing value * @param evict if false, the table is in creation mode. * @return previous value, or null if none */ final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node\u003cK,V\u003e[] tab; Node\u003cK,V\u003e p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) \u0026 hash]) == null) tab[i] = newNode(hash, key, value, null); else { Node\u003cK,V\u003e e; K k; // æ­¤æ—¶p == tab[i = (n - 1) \u0026 hash] if (p.hash == hash \u0026\u0026 ((k = p.key) == key || (key != null \u0026\u0026 key.equals(k)))) e = p; else if (p instanceof TreeNode) // å‘çº¢é»‘æ ‘ä¸­æ’å…¥ç»“ç‚¹ e = ((TreeNode\u003cK,V\u003e)p).putTreeVal(this, tab, hash, key, value); else { for (int binCount = 0; ; ++binCount) { //æ²¡æœ‰ç»ˆæ­¢æ¡ä»¶çš„å¾ªç¯ç”¨äºæŸ¥çœ‹è¯¥ç´¢å¼•ä¸Šæ‰€æœ‰çš„nodeç»“ç‚¹ if ((e = p.next) == null) { //ä¸‹ä¸€ä¸ªä¸ºç©ºæ—¶æ–°å»ºä¸€ä¸ªç»“ç‚¹ p.next = newNode(hash, key, value, null); if (binCount \u003e= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; } if (e.hash == hash \u0026\u0026 ((k = e.key) == key || (key != null \u0026\u0026 key.equals(k)))) // æ­¤æ—¶éœ€è¦è¿›è¡Œæ›¿æ¢value break; p = e; } } if (e != null) { // existing mapping for keyï¼Œkeyçš„hashå€¼å‘ç”Ÿå†²çª V oldValue = e.value; // keyçš„hashå‘ç”Ÿå†²çªåå¿…ç„¶ä¼šè¿›è¡Œä¸€æ¬¡æ›¿æ¢ï¼ˆonlyIfAbsenté»˜è®¤ä¸ºfalseï¼‰ if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; } } ++modCount; if (++size \u003e threshold) resize(); afterNodeInsertion(evict); return null; } /** * Initializes or doubles table size. If null, allocates in * accord with initial capacity target held in field threshold. * Otherwise, because we are using power-of-two expansion, the * elements from each bin must either stay at same index, or move * with a power of two offset in the new table. * * @return the table */ final Node\u003cK,V\u003e[] resize() { Node\u003cK,V\u003e[] oldTab = table; int oldCap = (oldTab == null) ? 0 : oldTab.length; int oldThr = threshold; int newCap, newThr = 0; if (oldCap \u003e 0) { if (oldCap \u003e= MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return oldTab; } else if ((newCap = oldCap \u003c\u003c 1) \u003c MAXIMUM_CAPACITY \u0026\u0026 oldCap \u003e= DEFAULT_INITIAL_CAPACITY) newThr = oldThr \u003c\u003c 1; // double threshold } else if (oldThr \u003e 0) // initial capacity was placed in threshold newCap = oldThr; else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; //é»˜è®¤16 newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); // é»˜è®¤0.75*16 = 12 } if (newThr == 0) { float ft = (float)newCap * loadFactor; newThr = (newCap \u003c MAXIMUM_CAPACITY \u0026\u0026 ft \u003c (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } threshold = newThr; @SuppressWarnings({\"rawtypes\",\"unchecked\"}) Node\u003cK,V\u003e[] newTab = (Node\u003cK,V\u003e[])new Node[newCap]; table = newTab; if (oldTab != null) { for (int j = 0; j \u003c oldCap; ++j) { Node\u003cK,V\u003e e; if ((e = oldTab[j]) != null) { oldTab[j] = null; if (e.next == null) newTab[e.hash \u0026 (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode\u003cK,V\u003e)e).split(this, newTab, j, oldCap); else { // preserve order Node\u003cK,V\u003e loHead = null, loTail = null; Node\u003cK,V\u003e hiHead = null, hiTail = null; Node\u003cK,V\u003e next; do { next = e.next; if ((e.hash \u0026 oldCap) == 0) { if (loTail == null) loHead = e; else loTail.next = e; loTail = e; } else { if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; } } while ((e = next) != null); if (loTail != null) { loTail.next = null; newTab[j] = loHead; } if (hiTail != null) { hiTail.next = null; newTab[j + oldCap] = hiHead; } } } } } return newTab; } ä»ä¸Šé¢çš„ä»£ç ä»¥åŠéƒ¨åˆ†æˆ‘è‡ªå·±æ ‡æ³¨çš„ä¸­æ–‡æ³¨é‡Šå¯ä»¥çœ‹åˆ°ï¼šé»˜è®¤æ˜¯åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º16çš„è¡¨(Node[])new Node[newCap]ï¼›å…¶ä¸´ç•Œå€¼thresholdä¸º12ã€‚åœ¨åé¢æ¯æ¬¡è°ƒç”¨putæ“ä½œæ—¶ä¹Ÿæ˜¯è°ƒç”¨ä¸Šé¢ä¸‰ä¸ªæ–¹æ³•ã€‚å½“ç„¶ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯å¯ä»¥çœ‹å‡ºï¼Œputé¦–å…ˆè°ƒç”¨key1æ‰€åœ¨ç±»çš„hashCode()è®¡ç®—key1çš„å“ˆå¸Œå€¼ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š\nstatic final int hash(Object key) { int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h \u003e\u003e\u003e 16); } æ­¤å“ˆå¸Œå€¼ç»è¿‡i = ((tab = resize()).length - 1) \u0026 hashåè·å¾—æ’å…¥åˆ°å“ˆå¸Œæ•°ç»„ä¸­çš„indexï¼Œåœ¨putè¿‡ç¨‹ä¸­ä¼šæœ‰å¦‚ä¸‹æƒ…å†µï¼š\nå¦‚æœæ­¤ä½ç½®çš„æ•°æ®ä¸ºç©ºï¼Œæ­¤æ—¶çš„key1-value1æ·»åŠ æˆåŠŸã€‚ å¦‚æœæ­¤ä½ç½®çš„æ•°æ®ä¸ä¸ºç©ºï¼Œï¼ˆæ„å‘³è¿™æ­¤ä½ç½®æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®å­˜åœ¨ï¼‰ï¼Œæ¯”è¾ƒkey1å’Œå·²ç»å­˜åœ¨æ•°æ®çš„å“ˆå¸Œå€¼ï¼š å¦‚æœkey1çš„å“ˆå¸Œå€¼ä¸å·²ç»å­˜åœ¨çš„æ•°æ®çš„å“ˆå¸Œå€¼éƒ½ä¸ç›¸åŒï¼Œæ­¤æ—¶key1-value1æ·»åŠ åˆ°ç¬¬ä¸€ä¸ªä½ç½®ï¼Œåç»­ä¸ºåŸæ¥çš„é“¾è¡¨æ•°æ®ã€‚ å¦‚æœkey1çš„å“ˆå¸Œå€¼ä¸å·²ç»å­˜åœ¨çš„çš„æŸä¸ªæ•°æ®(key2-value2)çš„hashå€¼ç›¸åŒï¼Œç»§ç»­æ¯”è¾ƒï¼›è°ƒç”¨keyå¯¹è±¡çš„equals()æ–¹æ³•ï¼Œ å¦‚æœequals()è¿”å›falseï¼šï¼Œæ­¤æ—¶key1-value1æ·»åŠ åˆ°ç¬¬ä¸€ä¸ªä½ç½®ï¼Œåç»­ä¸ºåŸæ¥çš„é“¾è¡¨æ•°æ®ã€‚ å¦‚æœequals()è¿”å›true:æ­¤æ—¶ä½¿ç”¨value1æ›¿æ¢value2å¹¶è¿”å›value2å…·ä½“æ¯”è¾ƒä»£ç å¦‚ä¸‹ï¼š if (e.hash == hash \u0026\u0026 ((k = e.key) == key || (key != null \u0026\u0026 key.equals(k)))) å½“ç„¶ï¼Œåœ¨è¿™é‡Œè¿˜æ˜¯å¾—è¯´ä¸‹jdk1.8ç›¸è¾ƒä¸jdk1.7åœ¨åº•å±‚å®ç°æ–¹é¢è¿˜æ˜¯çš„ä¸€äº›ä¸åŒï¼š\nåˆå§‹åŒ–æ—¶jdk1.7æ—¶ç›´æ¥åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œè€Œ1.8æ²¡æœ‰ã€‚ jdk1.8åº•å±‚çš„æ•°ç»„æ—¶Node[]è€ŒéEntry[],å½“ä»–ä»¬å®é™…æ˜¯å·®ä¸å¤šçš„ã€‚ jdk1.8æ˜¯åœ¨é¦–æ¬¡è°ƒç”¨put()æ–¹æ³•çš„æ—¶å€™åˆ›å»ºæ•°ç»„ã€‚ jdk1.7çš„åº•å±‚ç»“æ„åªæœ‰æ•°ç»„+é“¾è¡¨ï¼›jdk1.8çš„åº•å±‚ç»“æ„ä¸ºæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å½“æ•°ç»„çš„æŸä¸€ä¸ªç´¢å¼•ä½ç½®ä¸Šçš„å…ƒç´ ä»¥é“¾è¡¨çš„å½¢å¼å­˜åœ¨çš„æ•°æ®ä¸ªæ•°\u003e8ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦\u003e64æ—¶ï¼Œæ­¤æ—¶æ­¤ç´¢å¼•ä½ç½®ä¸Šçš„æ‰€æœ‰æ•°æ®æ”¹ä¸ºä½¿ç”¨çº¢é»‘æ ‘å­˜å‚¨ã€‚ JDK LinkedHashMapæºç åˆ†æ LinkedHashMapåˆå§‹åŒ–ï¼š\npublic class LinkedHashMap\u003cK,V\u003e extends HashMap\u003cK,V\u003e implements Map\u003cK,V\u003e { public LinkedHashMap(int initialCapacity, float loadFactor) { super(initialCapacity, loadFactor); accessOrder = false; } public LinkedHashMap(int initialCapacity) { super(initialCapacity); accessOrder = false; } public LinkedHashMap() { super(); accessOrder = false; } public LinkedHashMap(Map\u003c? extends K, ? extends V\u003e m) { super(); accessOrder = false; putMapEntries(m, false); } public LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder) { super(initialCapacity, loadFactor); this.accessOrder = accessOrder; } } åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°LinkedHashMapå°±æ˜¯HashMapï¼Œé‚£ä¹ˆå®ƒå’ŒHashMapæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—çœ‹å®ƒçš„put()æ–¹æ³•ï¼Œç„¶ååœ¨LinkedHashMapä¸­å´æ²¡æœ‰æ‰¾åˆ°put()æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿçœ‹å®ƒçš„çˆ¶ç±»ï¼ŒæŸ¥çœ‹çˆ¶ç±»ä¸­çš„put()æ–¹æ³•ï¼š\npublic V put(K key, V value) { return putVal(hash(key), key, value, false, true); } å‘ç°è¿˜æ˜¯å¾—æ‰¾putValæ–¹æ³•ï¼Œäºæ˜¯æ¥ç€çœ‹ï¼š\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node\u003cK,V\u003e[] tab; Node\u003cK,V\u003e p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) \u0026 hash]) == null) tab[i] = newNode(hash, key, value, null); else { Node\u003cK,V\u003e e; K k; if (p.hash == hash \u0026\u0026 ((k = p.key) == key || (key != null \u0026\u0026 key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode\u003cK,V\u003e)p).putTreeVal(this, tab, hash, key, value); else { for (int binCount = 0; ; ++binCount) { if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); if (binCount \u003e= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; } if (e.hash == hash \u0026\u0026 ((k = e.key) == key || (key != null \u0026\u0026 key.equals(k)))) break; p = e; } } if (e != null) { // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; } } ++modCount; if (++size \u003e threshold) resize(); afterNodeInsertion(evict); return null; } åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¿…å®šjavaå¿…å®šä¼šæ‰§è¡Œï¼štab[i] = newNode(hash, key, value, null);è¿™å¥ä»£ç ï¼Œäºæ˜¯å»çœ‹newNode,ç‚¹è¿›å»ï¼Œå‘ç°HashMapä¸­çš„newNodeæ–¹æ³•æ˜¯è¿™æ ·å­çš„ï¼š\nNode\u003cK,V\u003e newNode(int hash, K key, V value, Node\u003cK,V\u003e next) { return new Node\u003c\u003e(hash, key, value, next); } é‚£LinkedHashMapæ€ä¹ˆå’ŒHashMapä¸€æ ·å•Šï¼Œè¿™ä¸ªæ—¶å€™å°±è¯¥æ€è€ƒï¼Œä¼šä¸ä¼šæ˜¯å­ç±»ä¸­è¿˜æœ‰ä»€ä¹ˆæ˜¯æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°çš„ï¼Œæ¥ç€çœ‹å­ç±»LinkedHashMapï¼Œå‘ç°LinkedHashMapä¸­ä¹Ÿæœ‰newNodeæ–¹æ³•ï¼ŒåŸæ¥æ˜¯é‡å†™äº†ï¼š\nNode\u003cK,V\u003e newNode(int hash, K key, V value, Node\u003cK,V\u003e e) { LinkedHashMap.Entry\u003cK,V\u003e p = new LinkedHashMap.Entry\u003cK,V\u003e(hash, key, value, e); linkNodeLast(p); return p; } å†æ¥ç€ç‚¹è¿›Entryçœ‹çœ‹æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼š\nstatic class Entry\u003cK,V\u003e extends HashMap.Node\u003cK,V\u003e { Entry\u003cK,V\u003e before, after; Entry(int hash, K key, V value, Node\u003cK,V\u003e next) { super(hash, key, value, next); } } å“¦ï¼ŒåŸæ¥å®ƒç”Ÿæˆäº†ä¸€ä¸ªå’ŒHashMapä¸€æ ·çš„ç»“ç‚¹ï¼Œè¿˜åœ¨Entry before, after;è¿™é‡Œä½¿ç”¨äº†beforeå’Œafterå»è®°å½•ç”Ÿæˆçš„ç»“ç‚¹çš„å‰åé¡ºåºã€‚\nJDK TreeMapæºç åˆ†æ A Red-Black tree based NavigableMap implementation. The map is sorted according to the Comparable natural ordering of its keys, or by a Comparator provided at map creation time, depending on which constructor is used.\nä¸Šé¢è¿™æ®µè¯æ˜¯javaå®˜æ–¹ç»™å‡ºçš„è¯´æ˜ï¼Œæ˜¾ç„¶ï¼ŒTreeMapåº•å±‚å°±æ˜¯ä½¿ç”¨çº¢é»‘æ ‘æ¥å®ç°çš„ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªå¯ä»¥æ’åºçš„Mapï¼Œå…¶ä¸­æ—¢å¯ä»¥ä½¿ç”¨è‡ªç„¶æ’åºï¼Œä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨Comparatoræ¯”è¾ƒå™¨æ¥è¿›è¡Œæ’åºã€‚è‡ªç„¶æ’åºï¼š\n@Test public void test9(){ Map\u003cInteger, Object\u003e map = new TreeMap\u003c\u003e(); map.put(11, \"dasd\"); map.put(-1, \"dasda\"); map.put(22, \"dasd\"); map.put(33, \"dasd\"); map.put(44, \"dasd\"); map.put(44, \"dad\"); Iterator\u003cMap.Entry\u003cInteger, Object\u003e\u003e iterator = map.entrySet().iterator(); while (iterator.hasNext()){ Map.Entry\u003cInteger, Object\u003e next = iterator.next(); System.out.println(next); } /** * æ‰“å°ç»“æœï¼š * -1=dasda * 11=dasd * 22=dasd * 33=dasd * 44=dad */ } Comparetoræ¯”è¾ƒå™¨æ’åºï¼š\n@Test public void test10(){ Map\u003cEmployee, Object\u003e map = new TreeMap\u003c\u003e(); for(int i = 5; i \u003e 0; i--){ map.put(new Employee(\"test\"+i, i, i), \"dasd\"); } Iterator\u003cMap.Entry\u003cEmployee, Object\u003e\u003e iterator = map.entrySet().iterator(); while (iterator.hasNext()){ Map.Entry\u003cEmployee, Object\u003e next = iterator.next(); System.out.println(next); } /** * æ‰“å°ç»“æœï¼š * Employee{name='test1', age=1, salary=1}=dasd * Employee{name='test2', age=2, salary=2}=dasd * Employee{name='test3', age=3, salary=3}=dasd * Employee{name='test4', age=4, salary=4}=dasd * Employee{name='test5', age=5, salary=5}=dasd */ } Java Propertiesä½¿ç”¨å®ä¾‹â€”â€”HashMapåº”ç”¨ Propertiesæ˜¯HashMapçš„é‡è¦åº”ç”¨ï¼Œåˆ©ç”¨äº†HashMapé€šè¿‡keyæŸ¥æ‰¾è¿…é€Ÿçš„ç‰¹ç‚¹ï¼Œå°†è¿™ä¸€ç‰¹ç‚¹ç”¨åœ¨äº†è¯»å–é…ç½®æ–‡ä»¶ä¸Šï¼Œå…·ä½“çš„ä½¿ç”¨å¦‚ä¸‹ï¼šåœ¨é¡¹ç›®çš„èµ„æºæ–‡ä»¶å¤¹ä¸‹æ–°å»ºtest.propertiesæ–‡ä»¶ï¼š\nname=1baidu æµ‹è¯•ä»£ç ï¼š\n@Test public void test1() throws Exception{ Properties properties = new Properties(); FileInputStream fileInputStream= new FileInputStream(\"test.properties\"); properties.load(fileInputStream); System.out.println(\"name=\"+properties.getProperty(\"name\")); /** * æ‰“å°ç»“æœï¼š * name=1baidu */ } [[Javaåç«¯é¢è¯•é¢˜]]\n","wordCount":"3777","inLanguage":"en","datePublished":"2023-02-11T00:32:19+08:00","dateModified":"2024-03-21T00:57:09+08:00","author":{"@type":"Person","name":"luolin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-map/"},"publisher":{"@type":"Organization","name":"luolin1024","logo":{"@type":"ImageObject","url":"https://luolin1024.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://luolin1024.github.io accesskey=h title="luolinçš„åšå®¢ (Alt + H)">luolinçš„åšå®¢</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://luolin1024.github.io/posts title=ğŸ“šæ–‡ç« ><span>ğŸ“šæ–‡ç« </span></a></li><li><a href=https://luolin1024.github.io/archives/ title=â±æ—¶é—´è½´><span>â±æ—¶é—´è½´</span></a></li><li><a href=https://luolin1024.github.io/search/ title="ğŸ”æœç´¢ (Alt + /)" accesskey=/><span>ğŸ”æœç´¢</span></a></li><li><a href=https://luolin1024.github.io/tags title=ğŸ”–æ ‡ç­¾><span>ğŸ”–æ ‡ç­¾</span></a></li><li><a href=https://luolin1024.github.io/about title=ğŸ™‹ğŸ»â€â™‚ï¸å…³äº><span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span></a></li><li><a href=https://luolin1024.github.io/links title=ğŸ¤å‹é“¾><span>ğŸ¤å‹é“¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://luolin1024.github.io>Home</a>&nbsp;Â»&nbsp;<a href=https://luolin1024.github.io/blog_prepublish/>Blog_prepublishes</a></div><h1 class="post-title entry-hint-parent">Java Map</h1><div class=post-meta><span title='2023-02-11 00:32:19 +0800 +0800'>2023-02-11</span>&nbsp;Â·&nbsp;8 min&nbsp;Â·&nbsp;3777 words&nbsp;Â·&nbsp;luolin
æœ¬æ–‡æ€»é˜…è¯»é‡ <span id=umami_value_page_pv></span> æ¬¡
æœ¬æ–‡æ€»è®¿å®¢é‡ <span id=umami_value_page_uv></span> äºº</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#map%e7%9a%84%e9%81%8d%e5%8e%86%e6%96%b9%e5%bc%8f aria-label=Mapçš„éå†æ–¹å¼>Mapçš„éå†æ–¹å¼</a></li><li><a href=#jdk-hashmap%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90 aria-label="JDK HashMapæºç åˆ†æ">JDK HashMapæºç åˆ†æ</a></li><li><a href=#jdk-linkedhashmap%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90 aria-label="JDK LinkedHashMapæºç åˆ†æ">JDK LinkedHashMapæºç åˆ†æ</a></li><li><a href=#jdk-treemap%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90 aria-label="JDK TreeMapæºç åˆ†æ">JDK TreeMapæºç åˆ†æ</a></li><li><a href=#java-properties%e4%bd%bf%e7%94%a8%e5%ae%9e%e4%be%8bhashmap%e5%ba%94%e7%94%a8 aria-label="Java Propertiesä½¿ç”¨å®ä¾‹â€”â€”HashMapåº”ç”¨">Java Propertiesä½¿ç”¨å®ä¾‹â€”â€”HashMapåº”ç”¨</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>æœ¬æ–‡ä¸»è¦ä»‹ç»Mapæ¥å£ä»¥åŠå…¶ä¸»è¦å®ç°ç±»ï¼šHashMapã€LinkedHashMapã€TreeMapã€Hashtableã€Propertiesï¼Œå…¶ä¸­åŒ…æ‹¬HashMapã€TreeMapçš„åº•å±‚å®ç°åŸç†ã€‚</p><h3 id=mapçš„éå†æ–¹å¼>Mapçš„éå†æ–¹å¼<a hidden class=anchor aria-hidden=true href=#mapçš„éå†æ–¹å¼>#</a></h3><p>æ–¹å¼ä¸€,è¿™æ˜¯æœ€å¸¸è§çš„å¹¶ä¸”åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¹Ÿæ˜¯æœ€å¯å–çš„éå†æ–¹å¼ã€‚åœ¨é”®å€¼éƒ½éœ€è¦æ—¶ä½¿ç”¨:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>entry</span> <span class=o>:</span> <span class=n>map</span><span class=o>.</span><span class=na>entrySet</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Key = &#34;</span> <span class=o>+</span> <span class=n>entry</span><span class=o>.</span><span class=na>getKey</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;, Value = &#34;</span> <span class=o>+</span> <span class=n>entry</span><span class=o>.</span><span class=na>getValue</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ–¹å¼äºŒï¼Œåœ¨for-eachå¾ªç¯ä¸­éå†keysæˆ–values(æ®è¯´è¯¥æ–¹æ³•æ¯”entrySetéå†åœ¨æ€§èƒ½ä¸Šç¨å¥½ï¼ˆå¿«äº†10%ï¼‰ï¼Œæˆ‘è¿˜æ²¡æœ‰æµ‹è¯•è¿‡)ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl><span class=c1>//éå†mapä¸­çš„é”®
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=o>(</span><span class=n>Integer</span> <span class=n>key</span> <span class=o>:</span> <span class=n>map</span><span class=o>.</span><span class=na>keySet</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Key = &#34;</span> <span class=o>+</span> <span class=n>key</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>//éå†mapä¸­çš„å€¼
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=o>(</span><span class=n>Integer</span> <span class=n>value</span> <span class=o>:</span> <span class=n>map</span><span class=o>.</span><span class=na>values</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Value = &#34;</span> <span class=o>+</span> <span class=n>value</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ–¹å¼ä¸‰ï¼Œä½¿ç”¨è¿­ä»£å™¨éå†ï¼ˆè¯¥ç§æ–¹å¼çœ‹èµ·æ¥å†—ä½™å´æœ‰å…¶ä¼˜ç‚¹æ‰€åœ¨ã€‚é¦–å…ˆï¼Œåœ¨è€ç‰ˆæœ¬javaä¸­è¿™æ˜¯æƒŸä¸€éå†mapçš„æ–¹å¼ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥åœ¨éå†æ—¶è°ƒç”¨iterator.remove()æ¥åˆ é™¤entriesï¼Œå¦ä¸¤ä¸ªæ–¹æ³•åˆ™ä¸èƒ½ã€‚ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ä¸ä½¿ç”¨æ³›å‹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Map</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>Iterator</span> <span class=n>entries</span> <span class=o>=</span> <span class=n>map</span><span class=o>.</span><span class=na>entrySet</span><span class=o>().</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=o>(</span><span class=n>entries</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Map</span><span class=o>.</span><span class=na>Entry</span> <span class=n>entry</span> <span class=o>=</span> <span class=o>(</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>)</span> <span class=n>entries</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=n>Integer</span> <span class=n>key</span> <span class=o>=</span> <span class=o>(</span><span class=n>Integer</span><span class=o>)</span><span class=n>entry</span><span class=o>.</span><span class=na>getKey</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=n>Integer</span> <span class=n>value</span> <span class=o>=</span> <span class=o>(</span><span class=n>Integer</span><span class=o>)</span><span class=n>entry</span><span class=o>.</span><span class=na>getValue</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Key = &#34;</span> <span class=o>+</span> <span class=n>key</span> <span class=o>+</span> <span class=s>&#34;, Value = &#34;</span> <span class=o>+</span> <span class=n>value</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ä½¿ç”¨æ³›å‹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;&gt;</span> <span class=n>iterator</span> <span class=o>=</span> <span class=n>map</span><span class=o>.</span><span class=na>entrySet</span><span class=o>().</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=o>(</span><span class=n>iterator</span><span class=o>.</span><span class=na>hasNext</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>next</span> <span class=o>=</span> <span class=n>iterator</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>next</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ–¹å¼å››ï¼Œé€šè¿‡é”®æ‰¾å€¼éå†ï¼ˆå¾ªç¯ä¸­é€šè¿‡keyæ¥æ‹¿åˆ°valueæ•ˆç‡ä½ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=n>Integer</span> <span class=n>key</span> <span class=o>:</span> <span class=n>map</span><span class=o>.</span><span class=na>keySet</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Integer</span> <span class=n>value</span> <span class=o>=</span> <span class=n>map</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>key</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Key = &#34;</span> <span class=o>+</span> <span class=n>key</span> <span class=o>+</span> <span class=s>&#34;, Value = &#34;</span> <span class=o>+</span> <span class=n>value</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jdk-hashmapæºç åˆ†æ>JDK HashMapæºç åˆ†æ<a hidden class=anchor aria-hidden=true href=#jdk-hashmapæºç åˆ†æ>#</a></h3><p>HashMapåˆå§‹åŒ–ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>MAXIMUM_CAPACITY</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>30</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>float</span> <span class=n>DEFAULT_LOAD_FACTOR</span> <span class=o>=</span> <span class=mf>0.75f</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=nf>HashMap</span><span class=o>(</span><span class=kt>int</span> <span class=n>initialCapacity</span><span class=o>,</span> <span class=kt>float</span> <span class=n>loadFactor</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>initialCapacity</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>IllegalArgumentException</span><span class=o>(</span><span class=s>&#34;Illegal initial capacity: &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                                           <span class=n>initialCapacity</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>initialCapacity</span> <span class=o>&gt;</span> <span class=n>MAXIMUM_CAPACITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>initialCapacity</span> <span class=o>=</span> <span class=n>MAXIMUM_CAPACITY</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>loadFactor</span> <span class=o>&lt;=</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>Float</span><span class=o>.</span><span class=na>isNaN</span><span class=o>(</span><span class=n>loadFactor</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>IllegalArgumentException</span><span class=o>(</span><span class=s>&#34;Illegal load factor: &#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                                           <span class=n>loadFactor</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>loadFactor</span> <span class=o>=</span> <span class=n>loadFactor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>threshold</span> <span class=o>=</span> <span class=n>tableSizeFor</span><span class=o>(</span><span class=n>initialCapacity</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=nf>HashMap</span><span class=o>(</span><span class=kt>int</span> <span class=n>initialCapacity</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>(</span><span class=n>initialCapacity</span><span class=o>,</span> <span class=n>DEFAULT_LOAD_FACTOR</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=nf>HashMap</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>loadFactor</span> <span class=o>=</span> <span class=n>DEFAULT_LOAD_FACTOR</span><span class=o>;</span> <span class=c1>// all other fields defaulted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=nf>HashMap</span><span class=o>(</span><span class=n>Map</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>K</span><span class=o>,</span> <span class=o>?</span> <span class=kd>extends</span> <span class=n>V</span><span class=o>&gt;</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>loadFactor</span> <span class=o>=</span> <span class=n>DEFAULT_LOAD_FACTOR</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>putMapEntries</span><span class=o>(</span><span class=n>m</span><span class=o>,</span> <span class=kc>false</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=nf>tableSizeFor</span><span class=o>(</span><span class=kt>int</span> <span class=n>cap</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>cap</span> <span class=o>-</span> <span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>|=</span> <span class=n>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>|=</span> <span class=n>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>|=</span> <span class=n>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>4</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>|=</span> <span class=n>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>|=</span> <span class=n>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>(</span><span class=n>n</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=o>(</span><span class=n>n</span> <span class=o>&gt;=</span> <span class=n>MAXIMUM_CAPACITY</span><span class=o>)</span> <span class=o>?</span> <span class=n>MAXIMUM_CAPACITY</span> <span class=o>:</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ˜¾ç„¶ï¼Œåœ¨åˆå§‹åŒ–æ—¶å¦‚æœæ²¡æœ‰ä¼ å…¥Mapçš„å¤§å°ï¼Œåˆ™åªæ˜¯æ”¹äº†ä¸‹äº†ä¸€ä¸ªåŠ è½½å› å­ï¼›è€Œåœ¨ä¼ å…¥initialCapacityæ—¶åˆ™ä¼šè®¡ç®—å‡ºthresholdï¼ˆä¸´ç•Œå€¼ï¼‰ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦è¿›è¡Œæ‰©å®¹ã€‚ç„¶ååœ¨ä½¿ç”¨put()çš„æ—¶å€™æ‰ä¼šçœŸæ­£åˆ›å»ºhashTableï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>DEFAULT_INITIAL_CAPACITY</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=o>;</span> <span class=c1>// aka 16
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Associates the specified value with the specified key in this map.
</span></span></span><span class=line><span class=cl><span class=cm> * If the map previously contained a mapping for the key, the old
</span></span></span><span class=line><span class=cl><span class=cm> * value is replaced.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * @param key key with which the specified value is to be associated
</span></span></span><span class=line><span class=cl><span class=cm> * @param value value to be associated with the specified key
</span></span></span><span class=line><span class=cl><span class=cm> * @return the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or
</span></span></span><span class=line><span class=cl><span class=cm> *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.
</span></span></span><span class=line><span class=cl><span class=cm> *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map
</span></span></span><span class=line><span class=cl><span class=cm> *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>V</span> <span class=nf>put</span><span class=o>(</span><span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>putVal</span><span class=o>(</span><span class=n>hash</span><span class=o>(</span><span class=n>key</span><span class=o>),</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Implements Map.put and related methods
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * @param hash hash for key
</span></span></span><span class=line><span class=cl><span class=cm> * @param key the key
</span></span></span><span class=line><span class=cl><span class=cm> * @param value the value to put
</span></span></span><span class=line><span class=cl><span class=cm> * @param onlyIfAbsent if true, don&#39;t change existing value
</span></span></span><span class=line><span class=cl><span class=cm> * @param evict if false, the table is in creation mode.
</span></span></span><span class=line><span class=cl><span class=cm> * @return previous value, or null if none
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=n>V</span> <span class=nf>putVal</span><span class=o>(</span><span class=kt>int</span> <span class=n>hash</span><span class=o>,</span> <span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>,</span> <span class=kt>boolean</span> <span class=n>onlyIfAbsent</span><span class=o>,</span>
</span></span><span class=line><span class=cl>               <span class=kt>boolean</span> <span class=n>evict</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;[]</span> <span class=n>tab</span><span class=o>;</span> <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>p</span><span class=o>;</span> <span class=kt>int</span> <span class=n>n</span><span class=o>,</span> <span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>((</span><span class=n>tab</span> <span class=o>=</span> <span class=n>table</span><span class=o>)</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=o>(</span><span class=n>n</span> <span class=o>=</span> <span class=n>tab</span><span class=o>.</span><span class=na>length</span><span class=o>)</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=o>(</span><span class=n>tab</span> <span class=o>=</span> <span class=n>resize</span><span class=o>()).</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>((</span><span class=n>p</span> <span class=o>=</span> <span class=n>tab</span><span class=o>[</span><span class=n>i</span> <span class=o>=</span> <span class=o>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=o>&amp;</span> <span class=n>hash</span><span class=o>])</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>tab</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>newNode</span><span class=o>(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>e</span><span class=o>;</span> <span class=n>K</span> <span class=n>k</span><span class=o>;</span>
</span></span><span class=line><span class=cl>		<span class=c1>// æ­¤æ—¶p == tab[i = (n - 1) &amp; hash]
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>hash</span> <span class=o>==</span> <span class=n>hash</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>            <span class=o>((</span><span class=n>k</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>key</span><span class=o>)</span> <span class=o>==</span> <span class=n>key</span> <span class=o>||</span> <span class=o>(</span><span class=n>key</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>key</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>k</span><span class=o>))))</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span> <span class=o>=</span> <span class=n>p</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>p</span> <span class=k>instanceof</span> <span class=n>TreeNode</span><span class=o>)</span>
</span></span><span class=line><span class=cl>			<span class=c1>// å‘çº¢é»‘æ ‘ä¸­æ’å…¥ç»“ç‚¹
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>e</span> <span class=o>=</span> <span class=o>((</span><span class=n>TreeNode</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;)</span><span class=n>p</span><span class=o>).</span><span class=na>putTreeVal</span><span class=o>(</span><span class=k>this</span><span class=o>,</span> <span class=n>tab</span><span class=o>,</span> <span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>binCount</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=o>;</span> <span class=o>++</span><span class=n>binCount</span><span class=o>)</span> <span class=o>{</span> <span class=c1>//æ²¡æœ‰ç»ˆæ­¢æ¡ä»¶çš„å¾ªç¯ç”¨äºæŸ¥çœ‹è¯¥ç´¢å¼•ä¸Šæ‰€æœ‰çš„nodeç»“ç‚¹
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=o>((</span><span class=n>e</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>next</span><span class=o>)</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span> <span class=c1>//ä¸‹ä¸€ä¸ªä¸ºç©ºæ—¶æ–°å»ºä¸€ä¸ªç»“ç‚¹
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>p</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>newNode</span><span class=o>(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=o>(</span><span class=n>binCount</span> <span class=o>&gt;=</span> <span class=n>TREEIFY_THRESHOLD</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=c1>// -1 for 1st
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=n>treeifyBin</span><span class=o>(</span><span class=n>tab</span><span class=o>,</span> <span class=n>hash</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>hash</span> <span class=o>==</span> <span class=n>hash</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                    <span class=o>((</span><span class=n>k</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>key</span><span class=o>)</span> <span class=o>==</span> <span class=n>key</span> <span class=o>||</span> <span class=o>(</span><span class=n>key</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>key</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>k</span><span class=o>))))</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// æ­¤æ—¶éœ€è¦è¿›è¡Œæ›¿æ¢value
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>e</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// existing mapping for keyï¼Œkeyçš„hashå€¼å‘ç”Ÿå†²çª
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>V</span> <span class=n>oldValue</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>value</span><span class=o>;</span>
</span></span><span class=line><span class=cl>			<span class=c1>// keyçš„hashå‘ç”Ÿå†²çªåå¿…ç„¶ä¼šè¿›è¡Œä¸€æ¬¡æ›¿æ¢ï¼ˆonlyIfAbsenté»˜è®¤ä¸ºfalseï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=o>(!</span><span class=n>onlyIfAbsent</span> <span class=o>||</span> <span class=n>oldValue</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>value</span> <span class=o>=</span> <span class=n>value</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>afterNodeAccess</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>oldValue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>++</span><span class=n>modCount</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(++</span><span class=n>size</span> <span class=o>&gt;</span> <span class=n>threshold</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>resize</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>afterNodeInsertion</span><span class=o>(</span><span class=n>evict</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Initializes or doubles table size.  If null, allocates in
</span></span></span><span class=line><span class=cl><span class=cm> * accord with initial capacity target held in field threshold.
</span></span></span><span class=line><span class=cl><span class=cm> * Otherwise, because we are using power-of-two expansion, the
</span></span></span><span class=line><span class=cl><span class=cm> * elements from each bin must either stay at same index, or move
</span></span></span><span class=line><span class=cl><span class=cm> * with a power of two offset in the new table.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * @return the table
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;[]</span> <span class=nf>resize</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;[]</span> <span class=n>oldTab</span> <span class=o>=</span> <span class=n>table</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>oldCap</span> <span class=o>=</span> <span class=o>(</span><span class=n>oldTab</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=n>oldTab</span><span class=o>.</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>oldThr</span> <span class=o>=</span> <span class=n>threshold</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>newCap</span><span class=o>,</span> <span class=n>newThr</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>oldCap</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>oldCap</span> <span class=o>&gt;=</span> <span class=n>MAXIMUM_CAPACITY</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>threshold</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=na>MAX_VALUE</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>oldTab</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=o>((</span><span class=n>newCap</span> <span class=o>=</span> <span class=n>oldCap</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=o>)</span> <span class=o>&lt;</span> <span class=n>MAXIMUM_CAPACITY</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                 <span class=n>oldCap</span> <span class=o>&gt;=</span> <span class=n>DEFAULT_INITIAL_CAPACITY</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>newThr</span> <span class=o>=</span> <span class=n>oldThr</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=o>;</span> <span class=c1>// double threshold
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>oldThr</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span> <span class=c1>// initial capacity was placed in threshold
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>newCap</span> <span class=o>=</span> <span class=n>oldThr</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=o>{</span>               <span class=c1>// zero initial threshold signifies using defaults
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>newCap</span> <span class=o>=</span> <span class=n>DEFAULT_INITIAL_CAPACITY</span><span class=o>;</span> <span class=c1>//é»˜è®¤16
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>newThr</span> <span class=o>=</span> <span class=o>(</span><span class=kt>int</span><span class=o>)(</span><span class=n>DEFAULT_LOAD_FACTOR</span> <span class=o>*</span> <span class=n>DEFAULT_INITIAL_CAPACITY</span><span class=o>);</span> <span class=c1>// é»˜è®¤0.75*16 = 12
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>newThr</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>float</span> <span class=n>ft</span> <span class=o>=</span> <span class=o>(</span><span class=kt>float</span><span class=o>)</span><span class=n>newCap</span> <span class=o>*</span> <span class=n>loadFactor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>newThr</span> <span class=o>=</span> <span class=o>(</span><span class=n>newCap</span> <span class=o>&lt;</span> <span class=n>MAXIMUM_CAPACITY</span> <span class=o>&amp;&amp;</span> <span class=n>ft</span> <span class=o>&lt;</span> <span class=o>(</span><span class=kt>float</span><span class=o>)</span><span class=n>MAXIMUM_CAPACITY</span> <span class=o>?</span>
</span></span><span class=line><span class=cl>                  <span class=o>(</span><span class=kt>int</span><span class=o>)</span><span class=n>ft</span> <span class=o>:</span> <span class=n>Integer</span><span class=o>.</span><span class=na>MAX_VALUE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>threshold</span> <span class=o>=</span> <span class=n>newThr</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@SuppressWarnings</span><span class=o>({</span><span class=s>&#34;rawtypes&#34;</span><span class=o>,</span><span class=s>&#34;unchecked&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl>        <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;[]</span> <span class=n>newTab</span> <span class=o>=</span> <span class=o>(</span><span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;[])</span><span class=k>new</span> <span class=n>Node</span><span class=o>[</span><span class=n>newCap</span><span class=o>];</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span> <span class=o>=</span> <span class=n>newTab</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>oldTab</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>oldCap</span><span class=o>;</span> <span class=o>++</span><span class=n>j</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>((</span><span class=n>e</span> <span class=o>=</span> <span class=n>oldTab</span><span class=o>[</span><span class=n>j</span><span class=o>])</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>oldTab</span><span class=o>[</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>next</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>newTab</span><span class=o>[</span><span class=n>e</span><span class=o>.</span><span class=na>hash</span> <span class=o>&amp;</span> <span class=o>(</span><span class=n>newCap</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)]</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>e</span> <span class=k>instanceof</span> <span class=n>TreeNode</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                    <span class=o>((</span><span class=n>TreeNode</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;)</span><span class=n>e</span><span class=o>).</span><span class=na>split</span><span class=o>(</span><span class=k>this</span><span class=o>,</span> <span class=n>newTab</span><span class=o>,</span> <span class=n>j</span><span class=o>,</span> <span class=n>oldCap</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=o>{</span> <span class=c1>// preserve order
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>loHead</span> <span class=o>=</span> <span class=kc>null</span><span class=o>,</span> <span class=n>loTail</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>hiHead</span> <span class=o>=</span> <span class=kc>null</span><span class=o>,</span> <span class=n>hiTail</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>next</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>do</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>next</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=o>((</span><span class=n>e</span><span class=o>.</span><span class=na>hash</span> <span class=o>&amp;</span> <span class=n>oldCap</span><span class=o>)</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>if</span> <span class=o>(</span><span class=n>loTail</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                                <span class=n>loHead</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                            <span class=k>else</span>
</span></span><span class=line><span class=cl>                                <span class=n>loTail</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                            <span class=n>loTail</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=o>}</span>
</span></span><span class=line><span class=cl>                        <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>if</span> <span class=o>(</span><span class=n>hiTail</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                                <span class=n>hiHead</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                            <span class=k>else</span>
</span></span><span class=line><span class=cl>                                <span class=n>hiTail</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                            <span class=n>hiTail</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span> <span class=k>while</span> <span class=o>((</span><span class=n>e</span> <span class=o>=</span> <span class=n>next</span><span class=o>)</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=o>(</span><span class=n>loTail</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>loTail</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>newTab</span><span class=o>[</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>loHead</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=o>(</span><span class=n>hiTail</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>hiTail</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                        <span class=n>newTab</span><span class=o>[</span><span class=n>j</span> <span class=o>+</span> <span class=n>oldCap</span><span class=o>]</span> <span class=o>=</span> <span class=n>hiHead</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>newTab</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>ä»ä¸Šé¢çš„ä»£ç ä»¥åŠéƒ¨åˆ†æˆ‘è‡ªå·±æ ‡æ³¨çš„ä¸­æ–‡æ³¨é‡Šå¯ä»¥çœ‹åˆ°ï¼šé»˜è®¤æ˜¯åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º16çš„è¡¨<code>(Node&lt;K,V>[])new Node[newCap]</code>ï¼›å…¶ä¸´ç•Œå€¼<code>threshold</code>ä¸º12ã€‚åœ¨åé¢æ¯æ¬¡è°ƒç”¨putæ“ä½œæ—¶ä¹Ÿæ˜¯è°ƒç”¨ä¸Šé¢ä¸‰ä¸ªæ–¹æ³•ã€‚å½“ç„¶ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯å¯ä»¥çœ‹å‡ºï¼Œputé¦–å…ˆè°ƒç”¨key1æ‰€åœ¨ç±»çš„hashCode()è®¡ç®—key1çš„å“ˆå¸Œå€¼ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=nf>hash</span><span class=o>(</span><span class=n>Object</span> <span class=n>key</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>h</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>(</span><span class=n>key</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=o>(</span><span class=n>h</span> <span class=o>=</span> <span class=n>key</span><span class=o>.</span><span class=na>hashCode</span><span class=o>())</span> <span class=o>^</span> <span class=o>(</span><span class=n>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>æ­¤å“ˆå¸Œå€¼ç»è¿‡<code>i = ((tab = resize()).length - 1) & hash</code>åè·å¾—æ’å…¥åˆ°å“ˆå¸Œæ•°ç»„ä¸­çš„indexï¼Œåœ¨putè¿‡ç¨‹ä¸­ä¼šæœ‰å¦‚ä¸‹æƒ…å†µï¼š</p><ol><li>å¦‚æœæ­¤ä½ç½®çš„æ•°æ®ä¸ºç©ºï¼Œæ­¤æ—¶çš„key1-value1æ·»åŠ æˆåŠŸã€‚</li><li>å¦‚æœæ­¤ä½ç½®çš„æ•°æ®ä¸ä¸ºç©ºï¼Œï¼ˆæ„å‘³è¿™æ­¤ä½ç½®æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®å­˜åœ¨ï¼‰ï¼Œæ¯”è¾ƒkey1å’Œå·²ç»å­˜åœ¨æ•°æ®çš„å“ˆå¸Œå€¼ï¼š<ol><li>å¦‚æœkey1çš„å“ˆå¸Œå€¼ä¸å·²ç»å­˜åœ¨çš„æ•°æ®çš„å“ˆå¸Œå€¼éƒ½ä¸ç›¸åŒï¼Œæ­¤æ—¶key1-value1æ·»åŠ åˆ°ç¬¬ä¸€ä¸ªä½ç½®ï¼Œåç»­ä¸ºåŸæ¥çš„é“¾è¡¨æ•°æ®ã€‚</li><li>å¦‚æœkey1çš„å“ˆå¸Œå€¼ä¸å·²ç»å­˜åœ¨çš„çš„æŸä¸ªæ•°æ®(key2-value2)çš„hashå€¼ç›¸åŒï¼Œç»§ç»­æ¯”è¾ƒï¼›è°ƒç”¨keyå¯¹è±¡çš„equals()æ–¹æ³•ï¼Œ<ol><li>å¦‚æœequals()è¿”å›falseï¼šï¼Œæ­¤æ—¶key1-value1æ·»åŠ åˆ°ç¬¬ä¸€ä¸ªä½ç½®ï¼Œåç»­ä¸ºåŸæ¥çš„é“¾è¡¨æ•°æ®ã€‚</li><li>å¦‚æœequals()è¿”å›true:æ­¤æ—¶ä½¿ç”¨value1æ›¿æ¢value2å¹¶è¿”å›value2å…·ä½“æ¯”è¾ƒä»£ç å¦‚ä¸‹ï¼š</li></ol></li></ol></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>if</span> <span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>hash</span> <span class=o>==</span> <span class=n>hash</span> <span class=o>&amp;&amp;</span> 
</span></span><span class=line><span class=cl>	<span class=o>((</span><span class=n>k</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>key</span><span class=o>)</span> <span class=o>==</span> <span class=n>key</span> <span class=o>||</span> <span class=o>(</span><span class=n>key</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>key</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>k</span><span class=o>))))</span>
</span></span></code></pre></div><p>å½“ç„¶ï¼Œåœ¨è¿™é‡Œè¿˜æ˜¯å¾—è¯´ä¸‹jdk1.8ç›¸è¾ƒä¸jdk1.7åœ¨åº•å±‚å®ç°æ–¹é¢è¿˜æ˜¯çš„ä¸€äº›ä¸åŒï¼š</p><ol><li>åˆå§‹åŒ–æ—¶jdk1.7æ—¶ç›´æ¥åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œè€Œ1.8æ²¡æœ‰ã€‚</li><li>jdk1.8åº•å±‚çš„æ•°ç»„æ—¶Node[]è€ŒéEntry[],å½“ä»–ä»¬å®é™…æ˜¯å·®ä¸å¤šçš„ã€‚</li><li>jdk1.8æ˜¯åœ¨é¦–æ¬¡è°ƒç”¨put()æ–¹æ³•çš„æ—¶å€™åˆ›å»ºæ•°ç»„ã€‚</li><li>jdk1.7çš„åº•å±‚ç»“æ„åªæœ‰æ•°ç»„+é“¾è¡¨ï¼›jdk1.8çš„åº•å±‚ç»“æ„ä¸ºæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å½“æ•°ç»„çš„æŸä¸€ä¸ªç´¢å¼•ä½ç½®ä¸Šçš„å…ƒç´ ä»¥é“¾è¡¨çš„å½¢å¼å­˜åœ¨çš„æ•°æ®ä¸ªæ•°>8ä¸”å½“å‰æ•°ç»„çš„é•¿åº¦>64æ—¶ï¼Œæ­¤æ—¶æ­¤ç´¢å¼•ä½ç½®ä¸Šçš„æ‰€æœ‰æ•°æ®æ”¹ä¸ºä½¿ç”¨çº¢é»‘æ ‘å­˜å‚¨ã€‚</li></ol><h3 id=jdk-linkedhashmapæºç åˆ†æ>JDK LinkedHashMapæºç åˆ†æ<a hidden class=anchor aria-hidden=true href=#jdk-linkedhashmapæºç åˆ†æ>#</a></h3><p>LinkedHashMapåˆå§‹åŒ–ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>LinkedHashMap</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>extends</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>implements</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=nf>LinkedHashMap</span><span class=o>(</span><span class=kt>int</span> <span class=n>initialCapacity</span><span class=o>,</span> <span class=kt>float</span> <span class=n>loadFactor</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	    <span class=kd>super</span><span class=o>(</span><span class=n>initialCapacity</span><span class=o>,</span> <span class=n>loadFactor</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	    <span class=n>accessOrder</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=nf>LinkedHashMap</span><span class=o>(</span><span class=kt>int</span> <span class=n>initialCapacity</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	    <span class=kd>super</span><span class=o>(</span><span class=n>initialCapacity</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	    <span class=n>accessOrder</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=nf>LinkedHashMap</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	    <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>	    <span class=n>accessOrder</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=nf>LinkedHashMap</span><span class=o>(</span><span class=n>Map</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>K</span><span class=o>,</span> <span class=o>?</span> <span class=kd>extends</span> <span class=n>V</span><span class=o>&gt;</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	    <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>	    <span class=n>accessOrder</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	    <span class=n>putMapEntries</span><span class=o>(</span><span class=n>m</span><span class=o>,</span> <span class=kc>false</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=nf>LinkedHashMap</span><span class=o>(</span><span class=kt>int</span> <span class=n>initialCapacity</span><span class=o>,</span>
</span></span><span class=line><span class=cl>	                         <span class=kt>float</span> <span class=n>loadFactor</span><span class=o>,</span>
</span></span><span class=line><span class=cl>	                         <span class=kt>boolean</span> <span class=n>accessOrder</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	    <span class=kd>super</span><span class=o>(</span><span class=n>initialCapacity</span><span class=o>,</span> <span class=n>loadFactor</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	    <span class=k>this</span><span class=o>.</span><span class=na>accessOrder</span> <span class=o>=</span> <span class=n>accessOrder</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°LinkedHashMapå°±æ˜¯HashMapï¼Œé‚£ä¹ˆå®ƒå’ŒHashMapæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—çœ‹å®ƒçš„put()æ–¹æ³•ï¼Œç„¶ååœ¨LinkedHashMapä¸­å´æ²¡æœ‰æ‰¾åˆ°put()æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿçœ‹å®ƒçš„çˆ¶ç±»ï¼ŒæŸ¥çœ‹çˆ¶ç±»ä¸­çš„put()æ–¹æ³•ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=n>V</span> <span class=nf>put</span><span class=o>(</span><span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>putVal</span><span class=o>(</span><span class=n>hash</span><span class=o>(</span><span class=n>key</span><span class=o>),</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>å‘ç°è¿˜æ˜¯å¾—æ‰¾putValæ–¹æ³•ï¼Œäºæ˜¯æ¥ç€çœ‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>final</span> <span class=n>V</span> <span class=nf>putVal</span><span class=o>(</span><span class=kt>int</span> <span class=n>hash</span><span class=o>,</span> <span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>,</span> <span class=kt>boolean</span> <span class=n>onlyIfAbsent</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                   <span class=kt>boolean</span> <span class=n>evict</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;[]</span> <span class=n>tab</span><span class=o>;</span> <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>p</span><span class=o>;</span> <span class=kt>int</span> <span class=n>n</span><span class=o>,</span> <span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>((</span><span class=n>tab</span> <span class=o>=</span> <span class=n>table</span><span class=o>)</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=o>(</span><span class=n>n</span> <span class=o>=</span> <span class=n>tab</span><span class=o>.</span><span class=na>length</span><span class=o>)</span> <span class=o>==</span> <span class=mi>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=o>(</span><span class=n>tab</span> <span class=o>=</span> <span class=n>resize</span><span class=o>()).</span><span class=na>length</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>((</span><span class=n>p</span> <span class=o>=</span> <span class=n>tab</span><span class=o>[</span><span class=n>i</span> <span class=o>=</span> <span class=o>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=o>&amp;</span> <span class=n>hash</span><span class=o>])</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>tab</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>newNode</span><span class=o>(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>e</span><span class=o>;</span> <span class=n>K</span> <span class=n>k</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>p</span><span class=o>.</span><span class=na>hash</span> <span class=o>==</span> <span class=n>hash</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>            <span class=o>((</span><span class=n>k</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>key</span><span class=o>)</span> <span class=o>==</span> <span class=n>key</span> <span class=o>||</span> <span class=o>(</span><span class=n>key</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>key</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>k</span><span class=o>))))</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span> <span class=o>=</span> <span class=n>p</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>p</span> <span class=k>instanceof</span> <span class=n>TreeNode</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span> <span class=o>=</span> <span class=o>((</span><span class=n>TreeNode</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;)</span><span class=n>p</span><span class=o>).</span><span class=na>putTreeVal</span><span class=o>(</span><span class=k>this</span><span class=o>,</span> <span class=n>tab</span><span class=o>,</span> <span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>binCount</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=o>;</span> <span class=o>++</span><span class=n>binCount</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>((</span><span class=n>e</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=na>next</span><span class=o>)</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>p</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>newNode</span><span class=o>(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=o>(</span><span class=n>binCount</span> <span class=o>&gt;=</span> <span class=n>TREEIFY_THRESHOLD</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=c1>// -1 for 1st
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=n>treeifyBin</span><span class=o>(</span><span class=n>tab</span><span class=o>,</span> <span class=n>hash</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>hash</span> <span class=o>==</span> <span class=n>hash</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                    <span class=o>((</span><span class=n>k</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>key</span><span class=o>)</span> <span class=o>==</span> <span class=n>key</span> <span class=o>||</span> <span class=o>(</span><span class=n>key</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>key</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>k</span><span class=o>))))</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span> <span class=o>=</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>e</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// existing mapping for key
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>V</span> <span class=n>oldValue</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>value</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(!</span><span class=n>onlyIfAbsent</span> <span class=o>||</span> <span class=n>oldValue</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>e</span><span class=o>.</span><span class=na>value</span> <span class=o>=</span> <span class=n>value</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>afterNodeAccess</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>oldValue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>++</span><span class=n>modCount</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(++</span><span class=n>size</span> <span class=o>&gt;</span> <span class=n>threshold</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>resize</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>afterNodeInsertion</span><span class=o>(</span><span class=n>evict</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¿…å®šjavaå¿…å®šä¼šæ‰§è¡Œï¼š<code>tab[i] = newNode(hash, key, value, null);</code>è¿™å¥ä»£ç ï¼Œäºæ˜¯å»çœ‹newNode,ç‚¹è¿›å»ï¼Œå‘ç°HashMapä¸­çš„newNodeæ–¹æ³•æ˜¯è¿™æ ·å­çš„ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=nf>newNode</span><span class=o>(</span><span class=kt>int</span> <span class=n>hash</span><span class=o>,</span> <span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>,</span> <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>next</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=n>Node</span><span class=o>&lt;&gt;(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=n>next</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>é‚£LinkedHashMapæ€ä¹ˆå’ŒHashMapä¸€æ ·å•Šï¼Œè¿™ä¸ªæ—¶å€™å°±è¯¥æ€è€ƒï¼Œä¼šä¸ä¼šæ˜¯å­ç±»ä¸­è¿˜æœ‰ä»€ä¹ˆæ˜¯æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°çš„ï¼Œæ¥ç€çœ‹å­ç±»LinkedHashMapï¼Œå‘ç°LinkedHashMapä¸­ä¹Ÿæœ‰newNodeæ–¹æ³•ï¼ŒåŸæ¥æ˜¯é‡å†™äº†ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=nf>newNode</span><span class=o>(</span><span class=kt>int</span> <span class=n>hash</span><span class=o>,</span> <span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>,</span> <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>LinkedHashMap</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>p</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>LinkedHashMap</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>linkNodeLast</span><span class=o>(</span><span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>p</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>å†æ¥ç€ç‚¹è¿›Entryçœ‹çœ‹æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kd>class</span> <span class=nc>Entry</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=kd>extends</span> <span class=n>HashMap</span><span class=o>.</span><span class=na>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Entry</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>before</span><span class=o>,</span> <span class=n>after</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Entry</span><span class=o>(</span><span class=kt>int</span> <span class=n>hash</span><span class=o>,</span> <span class=n>K</span> <span class=n>key</span><span class=o>,</span> <span class=n>V</span> <span class=n>value</span><span class=o>,</span> <span class=n>Node</span><span class=o>&lt;</span><span class=n>K</span><span class=o>,</span><span class=n>V</span><span class=o>&gt;</span> <span class=n>next</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>hash</span><span class=o>,</span> <span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>,</span> <span class=n>next</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>å“¦ï¼ŒåŸæ¥å®ƒç”Ÿæˆäº†ä¸€ä¸ªå’ŒHashMapä¸€æ ·çš„ç»“ç‚¹ï¼Œè¿˜åœ¨<code>Entry&lt;K,V> before, after;</code>è¿™é‡Œä½¿ç”¨äº†beforeå’Œafterå»è®°å½•ç”Ÿæˆçš„ç»“ç‚¹çš„å‰åé¡ºåºã€‚</p><h3 id=jdk-treemapæºç åˆ†æ>JDK TreeMapæºç åˆ†æ<a hidden class=anchor aria-hidden=true href=#jdk-treemapæºç åˆ†æ>#</a></h3><blockquote><p>A Red-Black tree based NavigableMap implementation. The map is sorted according to the Comparable natural ordering of its keys, or by a Comparator provided at map creation time, depending on which constructor is used.</p></blockquote><p>ä¸Šé¢è¿™æ®µè¯æ˜¯javaå®˜æ–¹ç»™å‡ºçš„è¯´æ˜ï¼Œæ˜¾ç„¶ï¼ŒTreeMapåº•å±‚å°±æ˜¯ä½¿ç”¨çº¢é»‘æ ‘æ¥å®ç°çš„ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªå¯ä»¥æ’åºçš„Mapï¼Œå…¶ä¸­æ—¢å¯ä»¥ä½¿ç”¨è‡ªç„¶æ’åºï¼Œä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨Comparatoræ¯”è¾ƒå™¨æ¥è¿›è¡Œæ’åºã€‚è‡ªç„¶æ’åºï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test9</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=mi>11</span><span class=o>,</span> <span class=s>&#34;dasd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(-</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;dasda&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=mi>22</span><span class=o>,</span> <span class=s>&#34;dasd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=mi>33</span><span class=o>,</span> <span class=s>&#34;dasd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=mi>44</span><span class=o>,</span> <span class=s>&#34;dasd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=mi>44</span><span class=o>,</span> <span class=s>&#34;dad&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;&gt;</span> <span class=n>iterator</span> <span class=o>=</span> <span class=n>map</span><span class=o>.</span><span class=na>entrySet</span><span class=o>().</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>iterator</span><span class=o>.</span><span class=na>hasNext</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>        <span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>next</span> <span class=o>=</span> <span class=n>iterator</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>next</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * æ‰“å°ç»“æœï¼š
</span></span></span><span class=line><span class=cl><span class=cm>     * -1=dasda
</span></span></span><span class=line><span class=cl><span class=cm>     * 11=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * 22=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * 33=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * 44=dad
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Comparetoræ¯”è¾ƒå™¨æ’åºï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test10</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span><span class=o>&lt;</span><span class=n>Employee</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>map</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>5</span><span class=o>;</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span><span class=o>--){</span>
</span></span><span class=line><span class=cl>        <span class=n>map</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=k>new</span> <span class=n>Employee</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>+</span><span class=n>i</span><span class=o>,</span> <span class=n>i</span><span class=o>,</span> <span class=n>i</span><span class=o>),</span> <span class=s>&#34;dasd&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Employee</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;&gt;</span> <span class=n>iterator</span> <span class=o>=</span> <span class=n>map</span><span class=o>.</span><span class=na>entrySet</span><span class=o>().</span><span class=na>iterator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>iterator</span><span class=o>.</span><span class=na>hasNext</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>        <span class=n>Map</span><span class=o>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>Employee</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>next</span> <span class=o>=</span> <span class=n>iterator</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>next</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * æ‰“å°ç»“æœï¼š
</span></span></span><span class=line><span class=cl><span class=cm>     * Employee{name=&#39;test1&#39;, age=1, salary=1}=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * Employee{name=&#39;test2&#39;, age=2, salary=2}=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * Employee{name=&#39;test3&#39;, age=3, salary=3}=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * Employee{name=&#39;test4&#39;, age=4, salary=4}=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     * Employee{name=&#39;test5&#39;, age=5, salary=5}=dasd
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=java-propertiesä½¿ç”¨å®ä¾‹hashmapåº”ç”¨>Java Propertiesä½¿ç”¨å®ä¾‹â€”â€”HashMapåº”ç”¨<a hidden class=anchor aria-hidden=true href=#java-propertiesä½¿ç”¨å®ä¾‹hashmapåº”ç”¨>#</a></h3><p>Propertiesæ˜¯HashMapçš„é‡è¦åº”ç”¨ï¼Œåˆ©ç”¨äº†HashMapé€šè¿‡keyæŸ¥æ‰¾è¿…é€Ÿçš„ç‰¹ç‚¹ï¼Œå°†è¿™ä¸€ç‰¹ç‚¹ç”¨åœ¨äº†è¯»å–é…ç½®æ–‡ä»¶ä¸Šï¼Œå…·ä½“çš„ä½¿ç”¨å¦‚ä¸‹ï¼šåœ¨é¡¹ç›®çš„èµ„æºæ–‡ä»¶å¤¹ä¸‹æ–°å»ºtest.propertiesæ–‡ä»¶ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>name=1baidu
</span></span></code></pre></div><p>æµ‹è¯•ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test1</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Properties</span> <span class=n>properties</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Properties</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>FileInputStream</span> <span class=n>fileInputStream</span><span class=o>=</span> <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;test.properties&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>properties</span><span class=o>.</span><span class=na>load</span><span class=o>(</span><span class=n>fileInputStream</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;name=&#34;</span><span class=o>+</span><span class=n>properties</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>	<span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * æ‰“å°ç»“æœï¼š
</span></span></span><span class=line><span class=cl><span class=cm>     * name=1baidu
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>[[Javaåç«¯é¢è¯•é¢˜]]</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://luolin1024.github.io/tags/java/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>Java/æ•°æ®ç»“æ„</a></li></ul><nav class=paginav><a class=prev href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-list/><span class=title>Â« Prev</span><br><span>Java List</span></a>
<a class=next href=https://luolin1024.github.io/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-set/><span class=title>Next Â»</span><br><span>Java Set</span></a></nav><div class=related-posts><h2>ç›¸å…³æ–‡ç« </h2><ul><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/hashtable/>HashTable</a></li><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-list/>Java List</a></li><li>Â· <a href=/blog_prepublish/%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/java/java-set/>Java Set</a></li></ul></div></footer><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><div id=waline></div><script type=module>
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
    const locale = {
        nick: 'æ˜µç§°',
        nickError: 'è¯·å¡«å†™æ˜µç§°',
        mail: 'é‚®ç®±',
        mailError: 'è¯·å¡«å†™æ­£ç¡®çš„é‚®ä»¶åœ°å€',
        link: 'ç½‘å€',
        optional: 'å¯é€‰',
        placeholder: 'ä»…å¡«å†™æ˜µç§°å³å¯å‘è¡¨å›å¤ã€‚\nå¡«å†™é‚®ç®±å¯æ”¶åˆ°å›å¤æé†’ã€‚\nè¯„è®ºåŒºæ”¯æŒ Markdown è¯­æ³•åŠé¢„è§ˆã€‚\n',
        sofa: 'æ¥å‘è¯„è®ºå§~',
        submit: 'æäº¤',
        like: 'å–œæ¬¢',
        cancelLike: 'å–æ¶ˆå–œæ¬¢',
        reply: 'å›å¤',
        cancelReply: 'å–æ¶ˆå›å¤',
        comment: 'è¯„è®º',
        refresh: 'åˆ·æ–°',
        more: 'åŠ è½½æ›´å¤š...',
        preview: 'é¢„è§ˆ',
        emoji: 'è¡¨æƒ…',
        uploadImage: 'ä¸Šä¼ å›¾ç‰‡',
        seconds: 'ç§’å‰',
        minutes: 'åˆ†é’Ÿå‰',
        hours: 'å°æ—¶å‰',
        days: 'å¤©å‰',
        now: 'åˆšåˆš',
        uploading: 'æ­£åœ¨ä¸Šä¼ ',
        login: 'ç®¡ç†',
        logout: 'é€€å‡º',
        admin: 'åšä¸»',
        sticky: 'ç½®é¡¶',
        word: 'å­—',
        wordHint: 'è¯„è®ºå­—æ•°åº”åœ¨ $0 åˆ° $1 å­—ä¹‹é—´ï¼\nå½“å‰å­—æ•°ï¼š$2',
        anonymous: 'åŒ¿å',
        level0: 'æ½œæ°´',
        level1: 'å†’æ³¡',
        level2: 'åæ§½',
        level3: 'æ´»è·ƒ',
        level4: 'è¯ç—¨',
        level5: 'ä¼ è¯´',
        gif: 'è¡¨æƒ…åŒ…',
        gifSearchPlaceholder: 'æœç´¢è¡¨æƒ…åŒ…',
        profile: 'ä¸ªäººèµ„æ–™',
        approved: 'é€šè¿‡',
        waiting: 'å¾…å®¡æ ¸',
        spam: 'åƒåœ¾',
        unsticky: 'å–æ¶ˆç½®é¡¶',
        oldest: 'æŒ‰å€’åº',
        latest: 'æŒ‰æ­£åº',
        hottest: 'æŒ‰çƒ­åº¦',
        reactionTitle: 'ä½ è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ',
    };
    init({
        
        el: '#waline',
        serverURL: 'https://blogcomments.luolin.online',
        locale,
        emoji: false,     
        search: false,    
        reaction: false,  
        requiredMeta: ['nick'],
        pageSize: 10,
        imageUploader: false,
        copyright: true,
        pageview: true,
        like: false,
    });
</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://luolin1024.github.io>luolin1024</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div>æœ¬ç«™æ€»è®¿é—®é‡ <span id=umami_value_site_pv></span> æ¬¡
æœ¬ç«™æ€»è®¿å®¢æ•° <span id=umami_value_site_uv></span> äºº
å½“å‰åœ¨çº¿è®¿å®¢ <span id=umami_value_active_uv></span> äºº</div><a href="https://icp.gov.moe/?keyword=20248618" target=_blank>èŒICPå¤‡20248618å·</a></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>